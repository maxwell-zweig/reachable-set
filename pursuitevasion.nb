(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32455,        777]
NotebookOptionsPosition[     29501,        734]
NotebookOutlinePosition[     29893,        750]
CellTagsIndexPosition[     29850,        747]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CW", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", "1", ",", " ", "0", ",", " ", 
       "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", "0", ",", "1", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", " ", ",", "0", ",", 
       " ", "1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", 
       RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", " ", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", "0"}], 
      "}"}]}], "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cmat", "[", 
    RowBox[{"ab_", ",", " ", "tau_", ",", " ", "tf_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"tau", " ", "-", " ", "tf"}], ")"}]}], " ", "ab"}], " ", "//",
       " ", "Transpose"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"4", ";;", "6"}], ",", " ", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xrf", "[", 
    RowBox[{
    "tf_", ",", " ", "delta_", ",", " ", "h_", ",", " ", "deltaT_", ",", " ", 
     "A_", ",", " ", "n_", ",", " ", "Rr_"}], "]"}], " ", ":=", " ", 
   RowBox[{"NIntegrate", "[", "  ", 
    RowBox[{
     RowBox[{"h", " ", 
      RowBox[{"n", "^", "2"}], " ", "Rr", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cmat", "[", 
           RowBox[{"A", ",", " ", "tau", ",", " ", "tf"}], "]"}], " ", "//", 
          " ", "Transpose"}], ")"}], ".", 
        RowBox[{"cmat", "[", 
         RowBox[{"A", ",", " ", "tau", ",", " ", "tf"}], "]"}], ".", 
        "delta"}], " ", "/", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"deltaT", ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"cmat", "[", 
              RowBox[{"A", ",", " ", "tau", ",", " ", "tf"}], "]"}], " ", "//",
              " ", "Transpose"}], ")"}], ".", 
           RowBox[{"cmat", "[", 
            RowBox[{"A", ",", " ", "tau", ",", " ", "tf"}], "]"}], ".", 
           "delta"}], " ", "//", " ", "Sqrt"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "  ", ",", 
     RowBox[{"{", 
      RowBox[{"tau", ",", " ", "0", ",", " ", "tf"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x3fanalytical", "[", 
    RowBox[{"tf_", ",", " ", "h_", ",", " ", "n_"}], "]"}], ":=", " ", 
   RowBox[{"h", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", " ", 
         RowBox[{"tf", " ", "/", " ", "Pi"}]}], "]"}]}], "+", "1", "+", " ", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{"n", " ", 
           RowBox[{"tf", " ", "/", " ", "Pi"}]}], "]"}], ",", " ", "2"}], 
        "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"n", " ", "tf"}], "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{"n", " ", 
             RowBox[{"tf", " ", "/", " ", "Pi"}]}], "]"}], ",", " ", "2"}], 
          "]"}], " ", "-", " ", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "tf"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9166853970498543`*^9, 3.916685501467895*^9}, {
   3.9166855385385838`*^9, 3.916685543094425*^9}, 3.91668907325876*^9, {
   3.919099860228982*^9, 3.919099860328992*^9}, {3.91909991950165*^9, 
   3.9190999402857637`*^9}, {3.919099987775693*^9, 
   3.919099988397613*^9}},ExpressionUUID->"ca09535f-26be-478f-9147-\
67522c3f9e64"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.916695392748589*^9, 3.916695406751219*^9}, 
   3.916750954405939*^9, 3.916751429044766*^9, {3.916754128358181*^9, 
   3.916754128561927*^9}, 
   3.919099992805997*^9},ExpressionUUID->"66774a8a-6b35-466f-a22d-\
8887c79a2811"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.916750941254271*^9, 3.9167509495579157`*^9}},
 CellLabel->
  "In[1700]:=",ExpressionUUID->"379951f7-275e-4958-abcc-f10863b92ab7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Miscallenous", " ", "visualization", " ", "and", " ", "helper", " ", 
    "code", " ", 
    RowBox[{"I", "'"}], "ve", " ", "written", " ", "along", " ", "the", " ", 
    "way"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x3fanalytical", "[", 
         RowBox[{"t1", ",", " ", "h1", ",", " ", "5"}], "]"}], " ", "==", " ",
         "0"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t1", ",", " ", "0", ",", " ", "10"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"h1", ",", " ", "0", ",", " ", "100"}], "}"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Point", "[", 
      RowBox[{"SpherePoints", "[", "200", "]"}], "]"}], "]"}], ";"}], 
   "**)"}]}]], "Input",
 CellChangeTimes->{{3.916695257396823*^9, 3.91669536861607*^9}, {
   3.916750598382092*^9, 3.916750600005499*^9}, 3.916750938064406*^9, {
   3.919100026340056*^9, 
   3.919100047001975*^9}},ExpressionUUID->"c87f4777-a0ea-473a-a8d2-\
a1aa2e8dbe63"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"columntorow", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"{", "x", "}"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.916750879705029*^9, 3.916750935081793*^9, {3.916754048124106*^9, 
   3.916754050010468*^9}, {3.916754859384246*^9, 3.916754872424397*^9}, {
   3.916761755380672*^9, 3.91676175822684*^9}, {3.918164779568878*^9, 
   3.9181647865344057`*^9}, {3.9181650981768503`*^9, 3.918165133002884*^9}, 
   3.919100025102624*^9},ExpressionUUID->"f9b8b1a5-a03a-4e3f-bc2c-\
0ad5e8151f15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", " ", "=", " ", 
   RowBox[{"CirclePoints", "[", "1000", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{"#", ",", " ", "0"}], "]"}], " ", "&"}], " ", "/@", " ", 
    "points"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", " ", "//", "  ", "N"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tfs", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", " ", "1000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tfs", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hs", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"100", ",", " ", "1000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hs", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"As", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"CW", "[", "5", "]"}], ",", " ", "1000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"As", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ns", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"5", ",", " ", "1000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ns", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rrs", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", " ", "1000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rrs", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointsT", " ", "=", " ", 
   RowBox[{"columntorow", " ", "/@", " ", "points"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsT", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rd", " ", "=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{"xrf", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "tfs", ",", " ", "points", ",", " ", "hs", ",", " ", "pointsT", ",", 
       " ", "As", ",", " ", "ns", ",", " ", "Rrs"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.91675096096303*^9, 3.9167509693474627`*^9}, {
   3.9167510031037416`*^9, 3.916751007593795*^9}, 3.9167514402669086`*^9, {
   3.91675434898433*^9, 3.916754356590529*^9}, {3.9167543898008213`*^9, 
   3.916754420259638*^9}, {3.916754477692792*^9, 3.916754521974772*^9}, {
   3.9167548769976892`*^9, 3.916754953540454*^9}, {3.916754992747139*^9, 
   3.916755030437243*^9}, {3.9167551257348223`*^9, 3.916755197151557*^9}, {
   3.9167552428320427`*^9, 3.916755249402055*^9}, {3.9167552809018917`*^9, 
   3.91675532701707*^9}, {3.9167556492422543`*^9, 3.916755660035492*^9}, {
   3.9167558377232027`*^9, 3.916755902848268*^9}, {3.916756048107457*^9, 
   3.916756062758172*^9}, 3.9167561182907763`*^9, {3.916756240365822*^9, 
   3.916756257097496*^9}, {3.916756299215829*^9, 3.916756358450932*^9}, {
   3.916756502779602*^9, 3.9167565081260777`*^9}, {3.916756567624501*^9, 
   3.9167565871028214`*^9}, {3.916756719075842*^9, 3.916756719550997*^9}, {
   3.916760446747123*^9, 3.916760448371595*^9}, {3.9167604805231037`*^9, 
   3.916760597895155*^9}, {3.916760780284155*^9, 3.916760783088372*^9}, {
   3.916761036755052*^9, 3.916761049587222*^9}, {3.916761378709744*^9, 
   3.916761395089731*^9}, {3.916761430617161*^9, 3.916761481849421*^9}, {
   3.916761589717779*^9, 3.916761594887012*^9}, 3.916761644765856*^9, {
   3.9167617596930637`*^9, 3.916761768438469*^9}, {3.91816460599051*^9, 
   3.9181646176792583`*^9}, {3.9181647897905912`*^9, 3.918164998801008*^9}, {
   3.918165075855895*^9, 3.9181650947140093`*^9}, {3.918165315124736*^9, 
   3.91816531559057*^9}, {3.918165532663045*^9, 3.9181655830533867`*^9}, {
   3.919100012084605*^9, 
   3.919100016761948*^9}},ExpressionUUID->"626cc725-46d1-4aee-a874-\
ae5510c611a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rdpoints", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"Re", ",", " ", "rd", ",", " ", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.916760789010151*^9, {3.916760863313505*^9, 3.91676086369512*^9}, {
   3.916761613400433*^9, 3.916761625272067*^9}, {3.916761667285379*^9, 
   3.916761675900876*^9}},
 CellLabel->
  "In[1721]:=",ExpressionUUID->"d1dd2a24-ccc4-45be-8954-97afb8b6b3d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Graphics3D", "[", 
   RowBox[{"Point", "[", "rdpoints", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.91675090785338*^9, 3.9167509310295362`*^9}, {
   3.916761697887456*^9, 3.916761727323523*^9}, 3.916761983086672*^9, 
   3.916840667746998*^9, 3.918165956238925*^9, {3.9190179541793633`*^9, 
   3.919017956872089*^9}},
 CellLabel->
  "In[1722]:=",ExpressionUUID->"0a49f9c4-22c2-4aeb-ba0f-48a73958584b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"first2", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
    RowBox[{"x", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.916762280481468*^9, 3.916762295011713*^9}, 
   3.919033508456291*^9},
 CellLabel->
  "In[1723]:=",ExpressionUUID->"03b0670b-9fd7-43c9-8dad-22c4aa62eee2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d2", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"first2", ",", " ", "rdpoints"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Graphics", "[", 
   RowBox[{"Point", "[", "d2", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9167619938848047`*^9, {3.916762087699568*^9, 3.916762092610937*^9}, {
   3.916762195050151*^9, 3.916762197695847*^9}, {3.9167622816139393`*^9, 
   3.916762362686441*^9}, {3.916762714857421*^9, 3.916762723449759*^9}, {
   3.916762916221381*^9, 3.91676291942379*^9}, {3.916763057460754*^9, 
   3.916763062922467*^9}, 3.9167631241969643`*^9, {3.916763178077959*^9, 
   3.916763179460392*^9}, {3.9167632540066643`*^9, 3.9167632568847218`*^9}, 
   3.918165968046267*^9},
 NumberMarks->False,
 CellLabel->
  "In[1724]:=",ExpressionUUID->"ec709d72-3239-4817-9310-3b92154b1578"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9167631709820623`*^9, 3.916763170983622*^9}},
 CellLabel->
  "In[1726]:=",ExpressionUUID->"24811456-6cd5-4722-8185-4db39f8963ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConvexHullRegion", "[", "d2", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rdboundary", " ", "=", " ", 
   RowBox[{"PolygonCoordinates", "[", 
    RowBox[{"ConvexHullRegion", "[", "d2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Region", "[", 
   RowBox[{
    RowBox[{"ConvexHullRegion", "[", "d2", "]"}], ",", 
    RowBox[{"Epilog", "->", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Point", "[", "d2", "]"}]}], "}"}]}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.916763121169003*^9, 3.916763121171887*^9}, 
   3.916763231772706*^9, {3.916763262912264*^9, 3.916763318231709*^9}, 
   3.916763513846012*^9, 3.916774141985162*^9, 3.9181659724170723`*^9, {
   3.919017904621751*^9, 3.919017933692337*^9}, {3.919017985885398*^9, 
   3.919017992125124*^9}, 3.9190374651250553`*^9},
 CellLabel->
  "In[1727]:=",ExpressionUUID->"20c84815-1103-4ac7-a826-061cbad5abc9"],

Cell[BoxData[
 RowBox[{"rdboundary", ";"}]], "Input",
 CellChangeTimes->{
  3.918306741960985*^9, {3.919030215785199*^9, 3.919030217523506*^9}},
 NumberMarks->False,
 CellLabel->
  "In[1730]:=",ExpressionUUID->"46e06975-1737-4c3e-8f9b-805f2235d612"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9167540615538187`*^9, 3.91675406155865*^9}, {
   3.9167606390721703`*^9, 3.916760655148758*^9}, 3.9167616006497993`*^9, {
   3.9167693792972803`*^9, 3.9167694024778013`*^9}, {3.916769476408971*^9, 
   3.916769544162272*^9}, {3.91676965803894*^9, 3.916769660045323*^9}, {
   3.9167697254567747`*^9, 3.916769741823038*^9}, {3.9167698121503553`*^9, 
   3.91676982734013*^9}, {3.916769879056562*^9, 3.916769914510445*^9}, {
   3.916770138938525*^9, 3.916770163077503*^9}, {3.916770415044848*^9, 
   3.916770462474702*^9}, {3.916770775559433*^9, 3.916770984317102*^9}, {
   3.916771033652944*^9, 3.916771100748288*^9}, {3.916771169652766*^9, 
   3.91677117204248*^9}, {3.9167713690762377`*^9, 3.916771369283162*^9}, {
   3.916771416122162*^9, 3.916771455972*^9}, 3.916771522878587*^9, {
   3.916771607218039*^9, 3.9167716587935143`*^9}, {3.916771742866212*^9, 
   3.916771775577847*^9}, {3.9167718882150173`*^9, 3.916771890579001*^9}, {
   3.916772069335753*^9, 3.916772087302602*^9}, {3.9167723465182858`*^9, 
   3.916772358238106*^9}, {3.9167724085680428`*^9, 3.916772454119294*^9}, {
   3.916772510472337*^9, 3.9167725133922653`*^9}, 3.916772939136868*^9, {
   3.9167737713792152`*^9, 3.9167737734958277`*^9}, {3.9190169870645447`*^9, 
   3.919017018809594*^9}, {3.919017072027769*^9, 3.919017100300271*^9}, {
   3.919017155435018*^9, 3.919017206467119*^9}, {3.91901765830189*^9, 
   3.9190176761334543`*^9}, {3.919018790816016*^9, 3.919018796314159*^9}, {
   3.919019318166931*^9, 3.919019319847397*^9}, {3.919019390591832*^9, 
   3.919019397857273*^9}, {3.919019646285694*^9, 3.919019653750349*^9}, {
   3.91901981234289*^9, 3.919019812656636*^9}, {3.919020104757017*^9, 
   3.919020106810423*^9}, {3.919020149696355*^9, 3.91902015494095*^9}, {
   3.919020429545998*^9, 3.919020432819085*^9}, {3.91902054362575*^9, 
   3.9190205454519873`*^9}, {3.919030138106587*^9, 3.919030164924117*^9}, 
   3.919030200858933*^9, {3.919030240166881*^9, 3.919030273237908*^9}, {
   3.919031674824934*^9, 3.919031676734222*^9}, 3.919031904922908*^9},
 CellLabel->
  "In[1731]:=",ExpressionUUID->"76b65036-d264-442c-9ca9-2548683a3d0b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.916771662463387*^9, 3.916772504659161*^9, {3.919016447708461*^9, 
   3.9190164607290792`*^9}},
 CellLabel->
  "In[1732]:=",ExpressionUUID->"b2efffc0-1393-4d09-a097-f1ec011f54c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "There", " ", "seems", " ", "to", " ", "be", " ", "symmetry", 
    " ", "causing", " ", "me", " ", "to", " ", "select", " ", "just", " ", 
    "one", " ", "value"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ratio", "[", 
     RowBox[{"k_", ",", " ", "a_"}], "]"}], ":=", " ", 
    RowBox[{"1", " ", "/", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", " ", "//", " ", "Inverse"}], ")"}], ".", "k"}], 
      "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"maxminrat", "[", 
      RowBox[{"a_", ",", " ", "v1s_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{"ratio", ",", " ", 
          RowBox[{"{", 
           RowBox[{"v1s", ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"a", " ", ",", " ", 
              RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], "}"}]}], 
         "]"}], " ", "//", " ", "Max"}], ",", "   ", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{"ratio", ",", " ", 
          RowBox[{"{", 
           RowBox[{"v1s", ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"a", " ", ",", " ", 
              RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], "}"}]}], 
         "]"}], " ", "//", " ", "Min"}]}], " ", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxminvec", "[", 
     RowBox[{"a_", ",", " ", "v1s_"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v1s", "[", 
       RowBox[{"[", "  ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"ratio", ",", " ", 
             RowBox[{"{", 
              RowBox[{"v1s", ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"a", " ", ",", " ", 
                 RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"ratio", ",", " ", 
              RowBox[{"{", 
               RowBox[{"v1s", ",", " ", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"a", " ", ",", " ", 
                  RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], 
               "}"}]}], "]"}], " ", "//", " ", "Max"}]}], "    ", "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "]"}], "]"}], ",", 
      " ", 
      RowBox[{"v1s", "[", 
       RowBox[{"[", "  ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"ratio", ",", " ", 
             RowBox[{"{", 
              RowBox[{"v1s", ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"a", " ", ",", " ", 
                 RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], 
              "}"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"ratio", ",", " ", 
              RowBox[{"{", 
               RowBox[{"v1s", ",", " ", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"a", " ", ",", " ", 
                  RowBox[{"v1s", " ", "//", " ", "Length"}]}], "]"}]}], 
               "}"}]}], "]"}], " ", "//", " ", "Min"}]}], "    ", "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "]"}], "]"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.916772461819165*^9, {3.916772496839946*^9, 3.916772499931046*^9}, {
   3.916772571477312*^9, 3.916772600444357*^9}, {3.916772712789137*^9, 
   3.91677273271789*^9}, {3.916772828660585*^9, 3.916772855504919*^9}, {
   3.916772909226482*^9, 3.9167729293278627`*^9}, {3.916773122895056*^9, 
   3.9167731314639053`*^9}, {3.916773162278923*^9, 3.916773229104855*^9}, {
   3.916773779750289*^9, 3.91677378128866*^9}, {3.9167739143818207`*^9, 
   3.916773931421693*^9}, {3.9190174333244*^9, 3.919017461371017*^9}, {
   3.9190302831479883`*^9, 3.919030286107342*^9}, {3.919030322420796*^9, 
   3.919030338000744*^9}, {3.919030392995542*^9, 3.9190304113413477`*^9}, {
   3.919030559870501*^9, 3.919030608287044*^9}, {3.9190307243890533`*^9, 
   3.919030821579505*^9}, {3.919030852743621*^9, 3.9190308615509663`*^9}, {
   3.91903100640889*^9, 3.919031008050304*^9}, 3.9190311714265823`*^9, {
   3.919031616969171*^9, 3.9190316227806253`*^9}, {3.919031690818609*^9, 
   3.919031698910048*^9}, {3.919031747098651*^9, 3.919031789501213*^9}, {
   3.919031908840143*^9, 3.9190319095735407`*^9}, {3.919032115948039*^9, 
   3.919032246488565*^9}, {3.919032402856159*^9, 3.91903240607086*^9}, {
   3.919032436388197*^9, 3.919032466923736*^9}, {3.919032715112228*^9, 
   3.919032745320012*^9}, {3.919037453149129*^9, 3.919037462607419*^9}},
 CellLabel->
  "In[1733]:=",ExpressionUUID->"e0624661-0903-488a-b03d-bfc213e21674"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rats", " ", "=", " ", 
   RowBox[{"maxminrat", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1000"}], "}"}]}], "}"}], ",", " ", 
     "rdboundary"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rats", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vecs", " ", "=", " ", 
    RowBox[{"maxminvec", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1000"}], "}"}]}], "}"}], ",", " ", 
      "rdboundary"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"rats", ",", " ", "vecs"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vectoangle", "[", "k_", "]"}], " ", ":=", " ", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"k", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"k", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{"Point", "[", "rdboundary", "]"}], "]"}], ",", " ", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"100", ",", " ", "1000"}], "}"}]}], "]"}], "]"}], ",", " ", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Line", "[", 
      RowBox[{"5000", " ", 
       RowBox[{"AnglePath", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "vectoangle"}], 
         "}"}], "]"}]}], "]"}], "]"}], ",", " ", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Line", "[", 
      RowBox[{"5000", 
       RowBox[{"AnglePath", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "//", " ", "vectoangle"}], 
         "}"}], "]"}]}], "]"}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.916773671707493*^9, 3.9167737168083773`*^9}, {
   3.9167738018615847`*^9, 3.9167738389692917`*^9}, {3.916773983992745*^9, 
   3.916774001513818*^9}, {3.9167741451305723`*^9, 3.91677421169585*^9}, {
   3.916774276670597*^9, 3.916774289841922*^9}, {3.916774411444356*^9, 
   3.916774460460176*^9}, {3.916774507186434*^9, 3.916774615417118*^9}, {
   3.916774929646184*^9, 3.916774931162842*^9}, {3.91677496594559*^9, 
   3.916775021930108*^9}, {3.916775052986409*^9, 3.916775133708377*^9}, {
   3.916842349601059*^9, 3.916842350344665*^9}, {3.919017130318671*^9, 
   3.919017133461081*^9}, {3.91901746255343*^9, 3.919017577633806*^9}, {
   3.919017729755135*^9, 3.919017747569672*^9}, {3.919017784489737*^9, 
   3.919017806623499*^9}, {3.919017861953732*^9, 3.91901786288328*^9}, {
   3.919018008694653*^9, 3.91901802131922*^9}, {3.919018067030529*^9, 
   3.919018068249981*^9}, {3.91901826784193*^9, 3.9190182749979277`*^9}, 
   3.919018756048019*^9, 3.9190188025496798`*^9, {3.919019195089963*^9, 
   3.9190192215728617`*^9}, {3.9190192789856997`*^9, 3.919019372844123*^9}, {
   3.919019476921022*^9, 3.919019504190134*^9}, {3.919019713988882*^9, 
   3.919019738109939*^9}, 3.919019770389941*^9, {3.9190198427485237`*^9, 
   3.91901984564998*^9}, {3.919019960340905*^9, 3.919019962342375*^9}, {
   3.9190204758403463`*^9, 3.919020480739097*^9}, {3.9190205224419527`*^9, 
   3.919020527617888*^9}, {3.919020878200287*^9, 3.919020879943232*^9}, {
   3.919020916591206*^9, 3.919020961119347*^9}, {3.919031021140643*^9, 
   3.919031049226379*^9}, {3.9190311163582582`*^9, 3.91903116675555*^9}, {
   3.9190312097164907`*^9, 3.919031211514186*^9}, {3.919031245878551*^9, 
   3.9190312594027033`*^9}, {3.919031311828431*^9, 3.919031317828459*^9}, {
   3.9190318859446297`*^9, 3.919031894540501*^9}, {3.919032258189711*^9, 
   3.919032343810031*^9}, {3.919032559195348*^9, 3.9190325597183867`*^9}, {
   3.9190327478209963`*^9, 3.919032777928419*^9}, {3.919032816000806*^9, 
   3.91903295326762*^9}, {3.9190329878863487`*^9, 3.9190330076787977`*^9}, {
   3.919033119736581*^9, 3.919033159633569*^9}, {3.919033229561511*^9, 
   3.919033229596356*^9}, {3.9190333625347967`*^9, 3.919033399243137*^9}, {
   3.919033457943266*^9, 3.9190334604183893`*^9}},
 CellLabel->
  "In[1736]:=",ExpressionUUID->"e510e912-ca2c-4d4d-885a-2ce50d8212a0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.919033741047428*^9, 3.919033741049835*^9}},
 CellLabel->
  "In[1742]:=",ExpressionUUID->"21aca374-33ee-4a2d-b194-6fafef7601bf"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.919032993885723*^9, 3.919033215652482*^9},
 CellLabel->
  "In[1743]:=",ExpressionUUID->"5b94ae24-e448-4f00-910c-867cc1e67f18"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.919025376025013*^9},
 CellLabel->
  "In[1744]:=",ExpressionUUID->"8cbadc85-5381-40ec-b4cb-d5f31a00e643"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.919019492670993*^9, 3.919019499850155*^9}},
 CellLabel->
  "In[1745]:=",ExpressionUUID->"272eeddc-a31c-4ea8-8134-1b7c7ba1c751"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91901774055434*^9, 3.919017741735445*^9}},
 CellLabel->
  "In[1746]:=",ExpressionUUID->"a1ff7ecb-697d-4358-bc2b-7120e3ae9cfb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.918166110224053*^9, 3.918306453493898*^9},
 NumberMarks->False,
 CellLabel->
  "In[1747]:=",ExpressionUUID->"8ad3f754-75db-4e0e-a088-5954c6c5d0ec"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.916840961183888*^9, 3.9168409617011747`*^9}},
 CellLabel->
  "In[1748]:=",ExpressionUUID->"d9004d75-4146-4834-a33e-2a18f04fef1e"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.91816611421179*^9, 3.918306455371998*^9},
 NumberMarks->False,
 CellLabel->
  "In[1749]:=",ExpressionUUID->"41035a65-654c-4564-8302-c7acb48feb1f"],

Cell[BoxData[
 TemplateBox[{
  "Show", "gtype", 
   "\"\\!\\(\\*RowBox[{\\\"Out\\\"}]\\) is not a type of graphics.\"", 2, 570,
    55, 30912244632240578545, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.9181656769084578`*^9, 3.918166039879133*^9, 3.9181661730629473`*^9, {
   3.918306458321466*^9, 
   3.9183064585947313`*^9}},ExpressionUUID->"163df8cc-d17b-4ae2-8a74-\
a43f22248c15"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9168409647533627`*^9, 3.9168409647563257`*^9}},
 CellLabel->
  "In[1750]:=",ExpressionUUID->"f1bca8e7-280b-400b-b737-8e09696ffa48"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9167743204043903`*^9},
 NumberMarks->False,
 CellLabel->
  "In[1751]:=",ExpressionUUID->"dde6026b-058b-47c6-b74c-0d1845a6350d"]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"054fd0c0-4327-43de-88fd-8b2c469cfbba"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4470, 126, 115, "Input",ExpressionUUID->"ca09535f-26be-478f-9147-67522c3f9e64"],
Cell[5031, 148, 273, 5, 30, "Input",ExpressionUUID->"66774a8a-6b35-466f-a22d-8887c79a2811"],
Cell[5307, 155, 178, 3, 30, "Input",ExpressionUUID->"379951f7-275e-4958-abcc-f10863b92ab7"],
Cell[5488, 160, 1160, 30, 73, "Input",ExpressionUUID->"c87f4777-a0ea-473a-a8d2-a1aa2e8dbe63"],
Cell[6651, 192, 617, 12, 94, "Input",ExpressionUUID->"f9b8b1a5-a03a-4e3f-bc2c-0ad5e8151f15"],
Cell[7271, 206, 4227, 98, 367, "Input",ExpressionUUID->"626cc725-46d1-4aee-a874-ae5510c611a7"],
Cell[11501, 306, 462, 11, 30, "Input",ExpressionUUID->"d1dd2a24-ccc4-45be-8954-97afb8b6b3d7"],
Cell[11966, 319, 444, 9, 30, "Input",ExpressionUUID->"0a49f9c4-22c2-4aeb-ba0f-48a73958584b"],
Cell[12413, 330, 434, 12, 30, "Input",ExpressionUUID->"03b0670b-9fd7-43c9-8dad-22c4aa62eee2"],
Cell[12850, 344, 865, 19, 52, "Input",ExpressionUUID->"ec709d72-3239-4817-9310-3b92154b1578"],
Cell[13718, 365, 178, 3, 30, "Input",ExpressionUUID->"24811456-6cd5-4722-8185-4db39f8963ff"],
Cell[13899, 370, 969, 24, 73, "Input",ExpressionUUID->"20c84815-1103-4ac7-a826-061cbad5abc9"],
Cell[14871, 396, 249, 6, 30, "Input",ExpressionUUID->"46e06975-1737-4c3e-8f9b-805f2235d612"],
Cell[15123, 404, 2167, 30, 30, "Input",ExpressionUUID->"76b65036-d264-442c-9ca9-2548683a3d0b"],
Cell[17293, 436, 229, 5, 30, "Input",ExpressionUUID->"b2efffc0-1393-4d09-a097-f1ec011f54c3"],
Cell[17525, 443, 5111, 119, 115, "Input",ExpressionUUID->"e0624661-0903-488a-b03d-bfc213e21674"],
Cell[22639, 564, 4551, 98, 178, "Input",ExpressionUUID->"e510e912-ca2c-4d4d-885a-2ce50d8212a0"],
Cell[27193, 664, 176, 3, 30, InheritFromParent,ExpressionUUID->"21aca374-33ee-4a2d-b194-6fafef7601bf"],
Cell[27372, 669, 174, 3, 30, InheritFromParent,ExpressionUUID->"5b94ae24-e448-4f00-910c-867cc1e67f18"],
Cell[27549, 674, 153, 3, 30, "Input",ExpressionUUID->"8cbadc85-5381-40ec-b4cb-d5f31a00e643"],
Cell[27705, 679, 176, 3, 30, "Input",ExpressionUUID->"272eeddc-a31c-4ea8-8134-1b7c7ba1c751"],
Cell[27884, 684, 175, 3, 30, "Input",ExpressionUUID->"a1ff7ecb-697d-4358-bc2b-7120e3ae9cfb"],
Cell[28062, 689, 195, 4, 30, "Input",ExpressionUUID->"8ad3f754-75db-4e0e-a088-5954c6c5d0ec"],
Cell[28260, 695, 178, 3, 30, "Input",ExpressionUUID->"d9004d75-4146-4834-a33e-2a18f04fef1e"],
Cell[CellGroupData[{
Cell[28463, 702, 194, 4, 30, "Input",ExpressionUUID->"41035a65-654c-4564-8302-c7acb48feb1f"],
Cell[28660, 708, 464, 12, 28, "Message",ExpressionUUID->"163df8cc-d17b-4ae2-8a74-a43f22248c15"]
}, Open  ]],
Cell[29139, 723, 180, 3, 30, "Input",ExpressionUUID->"f1bca8e7-280b-400b-b737-8e09696ffa48"],
Cell[29322, 728, 175, 4, 30, "Input",ExpressionUUID->"dde6026b-058b-47c6-b74c-0d1845a6350d"]
}
]
*)

