(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84064,       2117]
NotebookOptionsPosition[     79479,       2055]
NotebookOutlinePosition[     79923,       2072]
CellTagsIndexPosition[     79880,       2069]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"m", " ", "=", " ", "10000"}], ";"}]], "Input",
 CellChangeTimes->{{3.9152072998901863`*^9, 3.915207300632225*^9}, {
   3.915369374779283*^9, 3.915369376875389*^9}, 3.915384993667519*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"c9f5c03e-7b14-46db-af1f-952b22ef8bfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"72", "  ", "*", " ", "t", "  ", "*", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"154", " ", "*", " ", "n", " ", "*", " ", "t"}], " ", "+", 
           " ", 
           RowBox[{"48", " ", "*", " ", 
            RowBox[{"n", " ", "^", " ", "3"}], " ", "*", " ", 
            RowBox[{"t", " ", "^", " ", "3"}]}], " ", "-", " ", 
           RowBox[{"384", " ", "*", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], " ", "-", " ", 
           RowBox[{"27", " ", "*", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "*", " ", "n", " ", "*", " ", "t"}], "]"}]}]}],
           ")"}], " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"4", " ", "*", " ", "n"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "*", " ", "n", " ", "*", " ", 
         RowBox[{"t", " ", "^", " ", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"6", " ", "-", " ", 
           RowBox[{"6", " ", "*", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], " ", ")"}], " ", 
         "/", " ", "n"}]}], ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", "+", 
          RowBox[{"12", " ", "*", " ", 
           RowBox[{"n", "^", "2"}], "*", " ", 
           RowBox[{"t", "^", "2"}]}], "\[Minus]", 
          RowBox[{"8", "*", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{"24", "*", "n", "*", " ", "t", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "+", 
          RowBox[{"9", " ", "*", 
           RowBox[{
            RowBox[{"Sin", "[", " ", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}], "^", "2"}]}]}], " ", 
         ")"}], "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"n", " ", "^", " ", "2"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"23", " ", "*", "n", " ", "*", " ", "t"}], "+", 
          RowBox[{"6", " ", "*", 
           RowBox[{"n", "^", "3"}], " ", "*", 
           RowBox[{"t", "^", "3"}]}], "+", 
          RowBox[{"42", "*", "n", "*", "t", "*", " ", 
           RowBox[{"Cos", "[", " ", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{"56", " ", "*", " ", 
           RowBox[{"Sin", "[", " ", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"9", "/", "2"}], ")"}], " ", "*", " ", 
           RowBox[{"Sin", " ", "[", 
            RowBox[{"2", "*", "n", "*", "t"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "*", " ", "n", " ", "*", " ", 
         RowBox[{"t", " ", "^", " ", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"6", " ", "-", " ", 
           RowBox[{"6", " ", "*", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], " ", ")"}], " ", 
         "/", " ", "n"}]}], ",", " ", "t", ",", " ", "0", ",", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", "n", " ", "*", " ", "t"}], " ", "+", " ", 
          
          RowBox[{"2", " ", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], ")"}], " ", "/", 
        " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "3"}], " ", "*", " ", 
         RowBox[{
          RowBox[{"t", "^", "2"}], " ", "/", " ", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", " ", "-", " ", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"n", " ", "^", " ", "2"}]}]}], ",", " ", "0"}], " ", 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"2", " ", "*", " ", "n", " ", "*", " ", "t"}], " ", "+", 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "*", " ", "n", " ", "*", " ", "t"}], "]"}]}], 
         ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"4", " ", "*", "n"}], ")"}]}], " ", ",", " ", "0", ",", " ", 
       "0", ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "*", " ", "t"}], "]"}], " ", "^", " ", "2"}], " ",
         "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"n", "^", "2"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", "+", 
          RowBox[{"12", " ", "*", " ", 
           RowBox[{"n", "^", "2"}], "*", " ", 
           RowBox[{"t", "^", "2"}]}], "\[Minus]", 
          RowBox[{"8", "*", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{"24", "*", "n", "*", " ", "t", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "+", 
          RowBox[{"9", " ", "*", 
           RowBox[{
            RowBox[{"Sin", "[", " ", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}], "^", "2"}]}]}], " ", 
         ")"}], "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"n", " ", "^", " ", "2"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "*", "n", " ", "*", " ", "t"}], " ", "+", " ", 
          
          RowBox[{"2", " ", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], ")"}], " ", "/", 
        " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"26", " ", "*", " ", "n", " ", "*", " ", "t"}], " ", "-", 
          " ", 
          RowBox[{"32", " ", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], " ", "+", " ", 
          RowBox[{"3", " ", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "*", " ", "n", " ", "*", " ", "t"}], "]"}]}]}], 
         ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"4", " ", "*", " ", 
          RowBox[{"n", "^", "3"}]}], ")"}]}], ",", " ", 
       RowBox[{"3", " ", "*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", " ", "n"}], " ", "*", " ", "t"}], " ", "+", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], ")"}], "^", "2"}], 
         "/", " ", 
         RowBox[{"n", " ", "^", " ", "3"}]}]}], ",", " ", "0"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"23", " ", "*", "n", " ", "*", " ", "t"}], "+", 
          RowBox[{"6", " ", "*", 
           RowBox[{"n", "^", "3"}], " ", "*", 
           RowBox[{"t", "^", "3"}]}], "+", 
          RowBox[{"42", "*", "n", "*", "t", "*", " ", 
           RowBox[{"Cos", "[", " ", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{"56", " ", "*", " ", 
           RowBox[{"Sin", "[", " ", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], "\[Minus]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"9", "/", "2"}], ")"}], " ", "*", " ", 
           RowBox[{"Sin", " ", "[", 
            RowBox[{"2", "*", "n", "*", "t"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"n", "^", "2"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "3"}], " ", "*", " ", 
         RowBox[{
          RowBox[{"t", "^", "2"}], " ", "/", " ", "2"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", " ", "-", " ", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"n", " ", "^", " ", "2"}]}]}], ",", " ", "0", ",", " ", 
       RowBox[{"3", "*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "n"}], " ", "*", "t"}], " ", "+", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], ")"}], "^", "2"}], 
         " ", "/", " ", 
         RowBox[{"n", "^", "3"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"14", " ", "*", " ", "n", " ", "*", " ", "t"}], " ", "+", 
          " ", 
          RowBox[{"3", " ", "*", " ", 
           RowBox[{"n", "^", "3"}], " ", "*", " ", 
           RowBox[{"t", "^", "3"}]}], " ", "+", " ", 
          RowBox[{"24", " ", "*", " ", "n", " ", "*", " ", "t", " ", "*", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], " ", "-", " ", 
          RowBox[{"32", " ", "*", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "*", " ", "t"}], "]"}]}], " ", "-", " ", 
          RowBox[{"3", " ", "*", " ", 
           RowBox[{"Sin", "[", " ", 
            RowBox[{"2", " ", "*", "n", " ", "*", "t"}], "]"}]}]}], ")"}], 
        " ", "/", " ", 
        RowBox[{"n", " ", "^", "3"}]}], " ", ",", " ", "0"}], " ", 
      "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "*", " ", "t"}], "]"}], " ", "^", " ", "2"}], " ",
         "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"n", "^", "2"}]}], ")"}]}], ",", " ", "0", ",", " ", "0", 
       ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "*", " ", "n", " ", "*", " ", "t"}], " ", "-", 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "*", " ", "n", " ", "*", "t"}], " ", "]"}]}], 
         ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"4", " ", "*", " ", 
          RowBox[{"n", "^", "3"}]}], ")"}]}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "n_", "]"}], " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        RowBox[{"-", "2"}], "*", " ", "n"}], ",", " ", "0", ",", " ", "1", 
       ",", " ", "0", ",", " ", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "*", " ", "n"}], ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "0", " ", ",", 
       " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", "0", ",", "0"}],
       " ", "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0"}], " ",
       "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.915207400405731*^9, 3.9152074562786083`*^9}, {
   3.915207626986486*^9, 3.915207656770328*^9}, 3.915207701078247*^9, {
   3.9152077891815643`*^9, 3.915207914379712*^9}, {3.915207957997191*^9, 
   3.91520802734941*^9}, {3.915208060550067*^9, 3.915208359873516*^9}, {
   3.9152084456271563`*^9, 3.91520845352076*^9}, {3.9152084923691263`*^9, 
   3.915208493399199*^9}, {3.915208539284288*^9, 3.915208759959551*^9}, {
   3.915208860175782*^9, 3.9152089698807173`*^9}, {3.915209041110429*^9, 
   3.915209045809341*^9}, {3.915209077873567*^9, 3.9152091190250607`*^9}, {
   3.915209266448163*^9, 3.9152093994371433`*^9}, 3.91520945210252*^9, 
   3.915209484188558*^9, {3.91520951868909*^9, 3.915209522284071*^9}, {
   3.915209558104547*^9, 3.915209565091613*^9}, {3.915209661126911*^9, 
   3.915209667964457*^9}, {3.915209734454227*^9, 3.91520973615809*^9}, {
   3.915209844307173*^9, 3.915209849852386*^9}, {3.915209906684849*^9, 
   3.915209912246091*^9}, {3.915210073632641*^9, 3.915210082331007*^9}, {
   3.915210135796091*^9, 3.915210184256339*^9}, {3.915210264209553*^9, 
   3.915210271460771*^9}, {3.915210316333955*^9, 3.915210325613083*^9}, {
   3.915210396437333*^9, 3.915210454020884*^9}, {3.9152105291310253`*^9, 
   3.9152105482416487`*^9}, {3.9152105787230663`*^9, 3.915210717976399*^9}, {
   3.915210874643454*^9, 3.915210911334372*^9}, {3.915210980834712*^9, 
   3.915210992218297*^9}, 3.9152110447996397`*^9, {3.915211115551198*^9, 
   3.915211115665627*^9}, {3.915211191270122*^9, 3.915211240043332*^9}, {
   3.915211283317527*^9, 3.915211300327223*^9}, {3.915211354873315*^9, 
   3.915211367401425*^9}, {3.915211929827795*^9, 3.9152119496604147`*^9}, {
   3.915217737534236*^9, 3.9152177408826857`*^9}, {3.9152179276004343`*^9, 
   3.915217938632118*^9}, {3.9152180438753242`*^9, 3.915218062320715*^9}, {
   3.915218098349234*^9, 3.915218117957918*^9}, 3.915218553658494*^9, {
   3.9152198926596737`*^9, 3.915219914809917*^9}, {3.915220775364246*^9, 
   3.915220783504162*^9}, {3.915220820948245*^9, 3.915220821487267*^9}, {
   3.915221456471846*^9, 3.9152214849308023`*^9}, 3.915377527677445*^9, 
   3.915384990579211*^9, {3.915388038137292*^9, 3.9153880487537947`*^9}, {
   3.9165053970749483`*^9, 3.916505399481557*^9}},
 CellLabel->
  "In[1498]:=",ExpressionUUID->"efd9f47c-38e9-4c6e-a7b6-cec6d77c5959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9152098042360086`*^9, 3.915209821355462*^9}, {
   3.915220992786055*^9, 3.9152210100251904`*^9}, {3.915380292623567*^9, 
   3.9153803246509237`*^9}, {3.915381406192965*^9, 3.9153814063074417`*^9}, 
   3.915384988585099*^9, 3.916505424256966*^9},
 CellLabel->
  "In[1500]:=",ExpressionUUID->"59c84052-bf99-4950-81a3-f578015f1b7b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915221032778784*^9, 3.915221034206257*^9}, 
   3.915385004381506*^9, {3.915388043789607*^9, 3.915388044362475*^9}, {
   3.915388267180832*^9, 3.915388272665246*^9}, {3.91538861880009*^9, 
   3.915388673206418*^9}, {3.915388704764431*^9, 3.9153887237300797`*^9}, {
   3.915388897546788*^9, 3.915388921831174*^9}, {3.9153893681050034`*^9, 
   3.915389380055146*^9}, 
   3.916505347186*^9},ExpressionUUID->"6a7661d3-3885-47e4-82db-00b0fe86f100"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"stm", "[", 
      RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4", "-", 
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}], "n"], ",", 
         FractionBox[
          RowBox[{"2", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}]}], "n"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "n"}], " ", "t"}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "1", ",", "0", 
         ",", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], "n"], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "t"}], "+", 
          FractionBox[
           RowBox[{"4", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}], "n"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", " ", "n", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}], ",", 
         RowBox[{"2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"6", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "0", ",", "0", 
         ",", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "n"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stm", "[", 
      RowBox[{"t", ",", "n"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stminverse", "[", 
      RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}], "-", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           RowBox[{"8", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"], "n"]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}], "3"]}], "n"]}], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "4"]}], "n"], "-", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"]}], "n"], "+", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"]}], "n"], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "4"]}], "n"]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"6", " ", "n", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "+", 
           RowBox[{"12", " ", "n", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}], "+", 
           RowBox[{"6", " ", "n", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "1", ",", "0", ",", 
         FractionBox[
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "3"]}], "n"], "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "4"]}], "n"], "+", 
           FractionBox[
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"]}], "n"], "-", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"]}], "n"], "-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "4"]}], "n"]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"3", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}], "-", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}]}], "n"], "+", 
           RowBox[{"6", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           FractionBox[
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "3"]}], "n"], "+", 
           RowBox[{"3", " ", "t", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "3"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"], "n"]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "-", 
           RowBox[{"3", " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "3"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"6", " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}], "-", 
           RowBox[{"6", " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}], "+", 
           RowBox[{"6", " ", "n", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           RowBox[{"12", " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           RowBox[{"6", " ", "n", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "4"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0"}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"n", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}]}], "+", 
           RowBox[{"n", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "3"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "3"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              RowBox[{"n", " ", "t"}], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"n", " ", "t"}], "]"}], "4"]}]]}], "}"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"t", ",", " ", "n"}], "]"}], "  ", "//", " ", "MatrixForm"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "MatrixForm"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.915217744446987*^9, 3.915217753730588*^9}, {
   3.915217863884224*^9, 3.915217925906679*^9}, {3.915218070513467*^9, 
   3.915218072529118*^9}, {3.915218129082494*^9, 3.915218207117037*^9}, {
   3.9152183979494467`*^9, 3.9152184272635517`*^9}, {3.915218470624608*^9, 
   3.915218491349223*^9}, {3.915218560896593*^9, 3.915218561929001*^9}, {
   3.9152186171482353`*^9, 3.915218624691762*^9}, {3.915218860164674*^9, 
   3.9152188608791113`*^9}, {3.915218903036808*^9, 3.915218923187241*^9}, {
   3.915218967002554*^9, 3.9152190037267437`*^9}, {3.915219048969636*^9, 
   3.9152191372057858`*^9}, {3.9152192019432907`*^9, 
   3.9152192191528397`*^9}, {3.915219250884112*^9, 3.915219264403941*^9}, {
   3.915219303526249*^9, 3.9152193513763742`*^9}, {3.9152195072341003`*^9, 
   3.915219530986082*^9}, {3.915219626216835*^9, 3.915219639261629*^9}, {
   3.915219717916738*^9, 3.9152197183489237`*^9}, {3.915219904453231*^9, 
   3.915219961984846*^9}, {3.9152200066101627`*^9, 3.9152200558077908`*^9}, {
   3.9152200966791763`*^9, 3.915220134152783*^9}, {3.9152201933227367`*^9, 
   3.915220194814374*^9}, {3.915220378602742*^9, 3.9152203797072973`*^9}, {
   3.915220616709903*^9, 3.915220624167461*^9}, {3.9152210287302017`*^9, 
   3.915221030152667*^9}, {3.9152722639412403`*^9, 3.915272267430462*^9}, {
   3.915374075751082*^9, 3.915374086841331*^9}, {3.9153741399218273`*^9, 
   3.9153741646496572`*^9}, {3.915375093982973*^9, 3.91537512671392*^9}, {
   3.915377339070612*^9, 3.915377340023732*^9}, 3.915385003259975*^9, 
   3.915387715363372*^9, 3.915387757934074*^9, {3.915387885153468*^9, 
   3.915387977175515*^9}, {3.91538801749713*^9, 3.915388032614285*^9}, {
   3.915388068720374*^9, 3.915388078409226*^9}, {3.915388262682023*^9, 
   3.915388265681432*^9}, {3.915388609804014*^9, 3.9153886114063673`*^9}, {
   3.9153887402044373`*^9, 3.915388792167823*^9}, {3.915388883560367*^9, 
   3.9153888836912193`*^9}, 3.915388992137732*^9, 3.9153893719197598`*^9, 
   3.915389407167961*^9, {3.9165054361659803`*^9, 
   3.91650548711152*^9}},ExpressionUUID->"199f22b4-8f91-432b-836b-\
de5c4914d6c9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"72", " ", "t", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"n", " ", "t"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"154", " ", "n", " ", "t"}], "+", 
         RowBox[{"48", " ", 
          SuperscriptBox["n", "3"], " ", 
          SuperscriptBox["t", "3"]}], "-", 
         RowBox[{"384", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}], "-", 
         RowBox[{"27", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "n", " ", "t"}], "]"}]}]}], 
        RowBox[{"4", " ", "n"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "n", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       FractionBox[
        RowBox[{"6", "-", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}]}], "n"]}], "0", 
      FractionBox[
       RowBox[{"8", "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["t", "2"]}], "-", 
        RowBox[{"8", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"24", " ", "n", " ", "t", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}], "2"]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["n", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"23", " ", "n", " ", "t"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["t", "3"]}], "+", 
        RowBox[{"42", " ", "n", " ", "t", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"56", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["9", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "n", " ", "t"}], "]"}]}]}], 
       SuperscriptBox["n", "2"]], "0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "n", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       FractionBox[
        RowBox[{"6", "-", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}]}], "n"]}], "t", "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "n", " ", "t"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}]}], 
       SuperscriptBox["n", "2"]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["t", "2"]}], "2"]}], "+", 
       FractionBox[
        RowBox[{"4", "-", 
         RowBox[{"4", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}]}], 
        SuperscriptBox["n", "2"]]}], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "n", " ", "t"}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "n", " ", "t"}], "]"}]}], 
       RowBox[{"4", " ", "n"}]], "0", "0", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"n", " ", "t"}], "]"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["n", "2"]}]]},
     {
      FractionBox[
       RowBox[{"8", "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["n", "2"], " ", 
         SuperscriptBox["t", "2"]}], "-", 
        RowBox[{"8", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"24", " ", "n", " ", "t", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"n", " ", "t"}], "]"}], "2"]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["n", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "n", " ", "t"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}]}], 
       SuperscriptBox["n", "2"]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"26", " ", "n", " ", "t"}], "-", 
        RowBox[{"32", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "n", " ", "t"}], "]"}]}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["n", "3"]}]], 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "n"}], " ", "t"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "t"}], "]"}]}], ")"}], "2"]}], 
       SuperscriptBox["n", "3"]], "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"23", " ", "n", " ", "t"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["t", "3"]}], "+", 
        RowBox[{"42", " ", "n", " ", "t", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"56", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["9", "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "n", " ", "t"}], "]"}]}]}], 
       SuperscriptBox["n", "2"]], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["t", "2"]}], "2"]}], "+", 
       FractionBox[
        RowBox[{"4", "-", 
         RowBox[{"4", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"n", " ", "t"}], "]"}]}]}], 
        SuperscriptBox["n", "2"]]}], "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "n"}], " ", "t"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"n", " ", "t"}], "]"}]}], ")"}], "2"]}], 
       SuperscriptBox["n", "3"]], 
      FractionBox[
       RowBox[{
        RowBox[{"14", " ", "n", " ", "t"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["n", "3"], " ", 
         SuperscriptBox["t", "3"]}], "+", 
        RowBox[{"24", " ", "n", " ", "t", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"32", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"n", " ", "t"}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "n", " ", "t"}], "]"}]}]}], 
       SuperscriptBox["n", "3"]], "0"},
     {"0", "0", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"n", " ", "t"}], "]"}], "2"], 
       RowBox[{"2", " ", 
        SuperscriptBox["n", "2"]}]], "0", "0", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "n", " ", "t"}], "-", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "n", " ", "t"}], "]"}]}], 
       RowBox[{"4", " ", 
        SuperscriptBox["n", "3"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.916505437433742*^9, 3.91650548392579*^9}},
 CellLabel->
  "Out[1509]//MatrixForm=",ExpressionUUID->"fc62bd54-203b-4a6b-b88a-\
9e36b1e13f98"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "n"}], "0", "1", "0", "0"},
     {
      RowBox[{"2", " ", "n"}], "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.916505437433742*^9, 3.916505483928999*^9}},
 CellLabel->
  "Out[1510]//MatrixForm=",ExpressionUUID->"4d6320ed-f8e7-4be6-b545-\
5e1988b80064"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.915387791220331*^9},
 NumberMarks->False,
 CellLabel->
  "In[372]:=",ExpressionUUID->"0def9b0b-e42f-4e7e-b8b2-57ca94775a30"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9153877898300962`*^9},
 NumberMarks->False,
 CellLabel->
  "In[373]:=",ExpressionUUID->"f67ff140-f44a-41e2-a740-c353de0e632d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.915387776309473*^9},
 NumberMarks->False,
 CellLabel->
  "In[374]:=",ExpressionUUID->"16513978-b3b6-42d3-b2c1-a45ee2c97f9c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915377240207314*^9, 3.915377240207526*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"26621c29-8ad7-473a-b69b-f2bad736b08a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915220049538309*^9, 3.915220051090829*^9}, {
   3.9152202011927433`*^9, 3.915220231307931*^9}, {3.915220322302103*^9, 
   3.915220427685877*^9}, {3.9152204614166*^9, 3.915220468075796*^9}, {
   3.915220626350687*^9, 3.915220633983801*^9}, {3.915220685226151*^9, 
   3.9152206967300787`*^9}, {3.9152207472449417`*^9, 3.915220748981082*^9}, {
   3.915220791448532*^9, 3.915220797606853*^9}, {3.915220963285727*^9, 
   3.915220966146577*^9}, {3.915221158283286*^9, 3.915221162549856*^9}, {
   3.9152712642342987`*^9, 3.915271273262076*^9}, 3.915375086481875*^9, {
   3.915377243396351*^9, 3.9153772435357113`*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"04b7f94f-9fb1-494c-86d9-24035fb280a8"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dimensions", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"stm", "[", 
        RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
      RowBox[{"-", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"stm", "[", 
        RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
      RowBox[{"-", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.9152722560635223`*^9, 3.915272295127219*^9}, {
  3.915272365692854*^9, 3.915272365730564*^9}, {3.915272404987413*^9, 
  3.915272421352049*^9}, {3.915272482312854*^9, 3.915272488188224*^9}, {
  3.9152725264173822`*^9, 3.9152725511957808`*^9}, {3.915272583880497*^9, 
  3.915272590159368*^9}, {3.91527262724757*^9, 3.915272640345839*^9}, {
  3.915272685290979*^9, 3.915272695039627*^9}, {3.915272738237314*^9, 
  3.9152727789661016`*^9}, {3.915375071385474*^9, 3.915375074673627*^9}, {
  3.915389306757338*^9, 
  3.915389308977173*^9}},ExpressionUUID->"fc988bc5-ae99-417f-b464-\
a25cc825841b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915380524552267*^9, 3.915380530850638*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"3384e1b8-ea5e-4d71-93d5-22ce3e94526e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"x0xf", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ",
      "0", ",", " ", "rx", ",", " ", "ry", ",", " ", "rz", ",", " ", "vx", 
     ",", " ", "vy", ",", " ", "vz"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.915219942310989*^9, 3.915219948075522*^9}, {
  3.915220498117141*^9, 3.91522050949028*^9}, {3.915271318329129*^9, 
  3.915271360260684*^9}, {3.9152714051576757`*^9, 3.915271414217783*^9}, {
  3.9153805268905497`*^9, 3.9153805411763783`*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"58f267fb-cd68-4e0a-b609-dc576127dabe"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Dimensions", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"stm", "[", 
        RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
      RowBox[{"-", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"c", "[", "5", "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"r", "[", 
      RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ".", 
    RowBox[{"c", "[", "5", "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
       RowBox[{"-", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"stm", "[", 
          RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.91521956489742*^9, 3.915219572392708*^9}, {
   3.915271380915525*^9, 3.91527139214284*^9}, {3.915271423149618*^9, 
   3.915271459690158*^9}, 3.9152715803486967`*^9, {3.915271654385973*^9, 
   3.915271671788755*^9}, {3.915271791852089*^9, 3.9152717935797377`*^9}, {
   3.9152728307208557`*^9, 3.915272875394992*^9}, {3.915272966849962*^9, 
   3.9152729747696133`*^9}, {3.9153805446976557`*^9, 3.9153805470702267`*^9}},
 
 CellLabel->
  "In[380]:=",ExpressionUUID->"572448ce-bd1e-4f69-a45d-2cfeb8d88af1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91537468692314*^9, 3.915374692081183*^9}, {
  3.915374774807843*^9, 3.915374798030613*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"1a1e7cb8-326d-4206-8885-29b657ae7fb5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Evaluate", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
           " ", "0", ",", " ", "rx", ",", " ", "ry", ",", " ", "rz", ",", " ",
           "vx", ",", " ", "vy", ",", " ", "vz"}], "}"}], "}"}], ".", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"stm", "[", 
           RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
         RowBox[{"-", " ", 
          RowBox[{"Inverse", "[", 
           RowBox[{"stm", "[", 
            RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"c", "[", "5", "]"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"r", "[", 
         RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ".", 
       RowBox[{"c", "[", "5", "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"stm", "[", 
            RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
          RowBox[{"-", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"stm", "[", 
             RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}], 
       ".", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
         " ", "0", ",", " ", "rx", ",", " ", "ry", ",", " ", "rz", ",", " ", 
         "vx", ",", " ", "vy", ",", " ", "vz"}], "}"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9152714809834023`*^9, 3.9152714878843307`*^9}, {
   3.915271519511301*^9, 3.915271522857791*^9}, {3.9152730073377733`*^9, 
   3.915273026806435*^9}, {3.915273061554641*^9, 3.9152730726519947`*^9}, {
   3.915273528946011*^9, 3.915273545887691*^9}, {3.9152737772124977`*^9, 
   3.915273854223865*^9}, {3.915273967817843*^9, 3.915274024660317*^9}, {
   3.9152740819533777`*^9, 3.9152740876917257`*^9}, {3.91527415258393*^9, 
   3.915274157262067*^9}, {3.915274227097464*^9, 3.915274229896504*^9}, {
   3.9153805496781893`*^9, 3.915380551736315*^9}, 
   3.915389313412428*^9},ExpressionUUID->"3b98e55e-4d28-4a68-9375-\
1986b56f17bb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.915377181126603*^9},
 NumberMarks->False,
 CellLabel->
  "In[383]:=",ExpressionUUID->"6c413efe-3374-42f0-8a07-81f210191ed6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915273590654943*^9, 3.915273591370393*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"5d195a24-2815-4fd1-a4b4-abda7c0ae1fb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9152730825613527`*^9, 3.9152735879097357`*^9},
 CellLabel->
  "In[385]:=",ExpressionUUID->"88b470a2-70e5-49e0-a23e-ddbb5131e24b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915273217733741*^9, 3.915273217744987*^9}, 
   3.9153771753022547`*^9},
 CellLabel->
  "In[386]:=",ExpressionUUID->"8c2d909f-24de-450f-ac5d-141c12c5a9fe"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"isScalar", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", 
         "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], "}"}], ".", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"stm", "[", 
          RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
        RowBox[{"-", " ", 
         RowBox[{"Inverse", "[", 
          RowBox[{"stm", "[", 
           RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"c", "[", "5", "]"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"r", "[", 
        RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ".", 
      RowBox[{"c", "[", "5", "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"stm", "[", 
           RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
         RowBox[{"-", " ", 
          RowBox[{"Inverse", "[", 
           RowBox[{"stm", "[", 
            RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", 
        "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9152189800782127`*^9, 3.9152189993031054`*^9}, {
   3.915219168156104*^9, 3.915219176665885*^9}, 3.915273173895413*^9, {
   3.9152732213206*^9, 3.915273272728711*^9}, 3.9152735657428837`*^9, {
   3.915273725949647*^9, 3.915273753101161*^9}, 3.915274041380302*^9, {
   3.915380555023017*^9, 3.915380562346861*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"15e5b7ce-9d3e-4b51-94f3-3b0306b901f4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"equation", " ", "=", " ", 
   RowBox[{"\[AliasDelimiter]", 
    RowBox[{"\[AliasDelimiter]", 
     RowBox[{"\[AliasDelimiter]", 
      RowBox[{"\[AliasDelimiter]", 
       RowBox[{"\[AliasDelimiter]", 
        RowBox[{"\[AliasDelimiter]", 
         RowBox[{"\[AliasDelimiter]", 
          RowBox[{"\[AliasDelimiter]", 
           RowBox[{"\[AliasDelimiter]", 
            RowBox[{"\[AliasDelimiter]", 
             RowBox[{"\[AliasDelimiter]", 
              RowBox[{
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
                    ",", "xf", ",", "yf", ",", "3", ",", "4", ",", "5", ",", 
                    "6"}], "}"}], "}"}], ".", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Inverse", "[", 
                    RowBox[{"stm", "[", 
                    RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"-", " ", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{"stm", "[", 
                    RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], 
                   ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"c", "[", "5", "]"}], "]"}], ".", 
                   RowBox[{"Inverse", "[", 
                    RowBox[{"r", "[", 
                    RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ".", 
                   RowBox[{"c", "[", "5", "]"}], ".", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Inverse", "[", 
                    RowBox[{"stm", "[", 
                    RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"-", " ", 
                    RowBox[{"Inverse", "[", 
                    RowBox[{"stm", "[", 
                    RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
                    ",", "xf", ",", "yf", ",", "3", ",", "4", ",", "5", ",", 
                    "6"}], "}"}]}], "]"}], "]"}], " ", "==", " ", "m"}], 
               "*)"}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.915271441662301*^9, 3.915271442264567*^9}, {
  3.915271570126855*^9, 3.915271578584025*^9}, {3.915369026694379*^9, 
  3.915369030296297*^9}, {3.915369064475278*^9, 3.9153690811168547`*^9}, {
  3.91537250991304*^9, 3.915372511335806*^9}, {3.9153727203893642`*^9, 
  3.915372727273563*^9}, {3.915373474152917*^9, 3.915373480530026*^9}, {
  3.915373804881051*^9, 3.9153738079400682`*^9}, {3.9153805650192957`*^9, 
  3.915380567039728*^9}, {3.915381066465125*^9, 3.915381066496614*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[388]:=",ExpressionUUID->"d0360e3d-4dab-4ba3-b073-8e777bff2e11"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "xf", ",",
          "yf", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], "}"}], ".", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"stm", "[", 
          RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
        RowBox[{"-", " ", 
         RowBox[{"Inverse", "[", 
          RowBox[{"stm", "[", 
           RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"c", "[", "5", "]"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"r", "[", 
        RowBox[{"1", ",", " ", "5"}], "]"}], "]"}], ".", 
      RowBox[{"c", "[", "5", "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"stm", "[", 
           RowBox[{"0", ",", " ", "5"}], "]"}], "]"}], ",", " ", 
         RowBox[{"-", " ", 
          RowBox[{"Inverse", "[", 
           RowBox[{"stm", "[", 
            RowBox[{"1", ",", " ", "5"}], "]"}], "]"}]}]}], "]"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "xf", ",", 
        "yf", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}], " ", "==", 
     " ", "m"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"xf", ",", " ", 
      RowBox[{"-", "1000"}], ",", " ", "1000"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"yf", ",", " ", 
      RowBox[{"-", "1000"}], ",", " ", "1000"}], "}"}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9152714830547047`*^9, 3.915271493609129*^9}, 
   3.9152715725015163`*^9, {3.915372731285338*^9, 3.915372762955224*^9}, {
   3.915372850150222*^9, 3.9153728558538847`*^9}, 3.915372899676358*^9, {
   3.9153805691100273`*^9, 3.915380572123787*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"82e5541a-e7c2-4a0b-96a8-c139014b4160"],

Cell[CellGroupData[{

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.9152189188664713`*^9},
 CellLabel->
  "In[389]:=",ExpressionUUID->"e238860f-b71c-450c-bd22-3455a7eaef05"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\:f3b5Tag List in \!\({{0, 0, 0, 1, 0, 0}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, \
0, 0, 1}, {3\\\\\\ \*SuperscriptBox[\(n\), \(2\)], 0, 0, 0, 2\\\\\\ n, 0}, \
{0, 0, 0, \(-2\)\\\\\\ n, 0, 0}, {0, 0, \(-\*SuperscriptBox[\(n\), \(2\)]\), \
0, 0, 0}}[x_]\) is Protected.\:f3b5", 2, 208, 17, 30892863161249333963, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.915218136591516*^9, 3.915218210383423*^9, 3.915218435367935*^9, 
   3.915218494861121*^9, 3.915218628198688*^9, {3.915218661193783*^9, 
   3.915218679152494*^9}},ExpressionUUID->"d7f9892b-c560-462d-828e-\
d0605987e2f9"]
}, {3}]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91537293546061*^9, 3.915372935461763*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"edb63cea-9b08-4918-a6ed-4b3dbd264b32"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9153730020427017`*^9, 3.915373002042975*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"ee59b86a-eb0f-4de8-b774-23ac28d7662d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"solutions", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{"equation", ",", " ", 
     RowBox[{"{", 
      RowBox[{"xf", ",", " ", "yf"}], "}"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.915372994554802*^9, 3.9153730263283863`*^9}, {
  3.915373464657227*^9, 3.915373468141947*^9}, {3.915380575102807*^9, 
  3.9153805768215523`*^9}},
 CellLabel->
  "In[392]:=",ExpressionUUID->"06c94dd5-1bd4-42b6-bd40-a0425ebf7bfa"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.915380137730871*^9, 3.915380147725277*^9}, {
  3.9153801900861692`*^9, 3.9153801902804832`*^9}, {3.915380224877522*^9, 
  3.9153802430241327`*^9}, {3.9153809481165867`*^9, 3.91538096178623*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"70af19b1-6ec3-4f16-bd75-1dcfc413ccd7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9153730899648314`*^9, 3.915373089971689*^9}, {
   3.9153731662890244`*^9, 3.9153731678355083`*^9}, {3.915373598549267*^9, 
   3.9153735988426*^9}, 3.915373862659664*^9, {3.915379876595602*^9, 
   3.915379920539763*^9}, {3.915379980588006*^9, 3.915379982589699*^9}, {
   3.915380103752302*^9, 3.9153801150949993`*^9}, {3.915380264912122*^9, 
   3.915380272475312*^9}, {3.91538033577085*^9, 3.915380375588077*^9}, 
   3.9153809641183233`*^9},
 CellLabel->
  "In[394]:=",ExpressionUUID->"30ccac0d-e0a6-4a2e-a612-e5d0e71c26b9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915373101085252*^9, 3.9153731118511753`*^9}, 
   3.915380962861744*^9, {3.915381080331143*^9, 3.915381109625334*^9}, {
   3.91538138745785*^9, 3.915381392492065*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"0b05e917-1982-4a8c-a1fc-e239cff8fca3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9153813901271477`*^9, 3.915381391253928*^9}, {
   3.915387428293388*^9, 3.91538748349741*^9}, {3.915387519407711*^9, 
   3.915387567279277*^9}, {3.9153876293962593`*^9, 3.915387688140039*^9}, {
   3.915387845136538*^9, 3.9153878523216143`*^9}, 3.9153879951924467`*^9, {
   3.915388092218128*^9, 3.91538810572091*^9}, {3.91538814888365*^9, 
   3.915388149186096*^9}, 3.915388255802874*^9, {3.915388496086851*^9, 
   3.9153885213362427`*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"0adbb88f-42b7-4ceb-a6bb-e261e8a98156"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915381393959627*^9, 3.915381393960546*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"f171eeeb-4439-4e0e-a51b-207f92391c94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gramian", "[", 
   RowBox[{"t0_", ",", " ", "tf_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Integrate", "[", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"stm", "[", 
      RowBox[{"tf", ",", " ", "5"}], "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"stm", "[", 
       RowBox[{"tau", ",", "5"}], "]"}], "]"}], ".", " ", "B", ".", " ", 
     RowBox[{"Transpose", "[", "B", "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"stm", "[", 
        RowBox[{"tf", ",", " ", "5"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"tau", ",", " ", "5"}], "]"}], "]"}]}], "]"}]}], "  ", ",", 
    "      ", 
    RowBox[{"{", 
     RowBox[{"tau", ",", " ", "t0", ",", " ", "tf"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.915373101100697*^9, 3.915373106231882*^9}, 
   3.9153809594889593`*^9, {3.915381083190489*^9, 3.915381107872932*^9}, {
   3.915381352354808*^9, 3.9153813560508833`*^9}, {3.915381397347879*^9, 
   3.915381403596081*^9}, {3.915387438455662*^9, 3.915387439360099*^9}, {
   3.915387617932354*^9, 3.9153876214184847`*^9}, {3.915388188105587*^9, 
   3.9153882008741837`*^9}, {3.915388237619832*^9, 3.915388247533061*^9}, {
   3.915388306789227*^9, 3.915388378974544*^9}, {3.915388499644093*^9, 
   3.915388511509377*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b7f6fbe7-5274-40ce-9e5b-1bcff52022f6"],

Cell[BoxData[
 RowBox[{"gramian", "[", 
  RowBox[{"0", ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.915381189936366*^9, 3.915381194876395*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"524c2b27-8bb9-4ecf-889c-91c2eac0a3d3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91538146842894*^9, 3.915381472146693*^9}},
 CellLabel->
  "In[400]:=",ExpressionUUID->"35cd92c3-1999-434a-ad34-0130c3ba13a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"optimaldynamics", "[", 
   RowBox[{
   "t_", ",", " ", "tf_", ",", " ", "t0_", ",", " ", "x0_", ",", " ", "xf_"}],
    "]"}], " ", ":=", " ", 
  RowBox[{"-", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", "B", "]"}], ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"stm", "[", 
       RowBox[{"tf", ",", " ", "5"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"stm", "[", 
        RowBox[{"t", ",", " ", "5"}], "]"}], "]"}]}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"gramian", "[", 
      RowBox[{"t0", ",", " ", "tf"}], "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"stm", "[", 
        RowBox[{"tf", ",", " ", "5"}], "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{"stm", "[", 
         RowBox[{"t0", ",", " ", "5"}], "]"}], "]"}], ".", "x0"}], " ", "-", 
      " ", "xf"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.915381473775834*^9, 3.915381589465988*^9}, {
   3.915382418001299*^9, 3.9153824802007523`*^9}, 3.915382846190497*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"3b79a3d6-efaf-40b6-93bd-801efd007f4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"costfunctional", "[", 
   RowBox[{"t0_", ",", " ", "tf_", " ", ",", " ", "x0_", ",", " ", "xf_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"optimaldynamics", "[", 
       RowBox[{
       "tau", ",", " ", "tf", ",", " ", "t0", ",", " ", "x0", ",", " ", 
        "xf"}], "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"optimaldynamics", "[", 
        RowBox[{
        "tau", ",", " ", "tf", ",", " ", "t0", ",", " ", "x0", ",", " ", 
         "xf"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"tau", ",", " ", "t0", ",", " ", "tf"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.915382839647397*^9, 3.915382966600347*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"636cebf8-02a9-4b00-a873-a3b6ed2d8ecf"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"costfunctional", "[", 
   RowBox[{"0", ",", " ", "1", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
      " ", "0"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", " ", "0", ",", "0", ",", " ", "0", ",", " ", "1", ",", " ", 
      "0"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.915383149716367*^9, 3.915383177833974*^9}, {
  3.915383269721675*^9, 3.9153832729485598`*^9}, {3.9153834802104053`*^9, 
  3.915383482963295*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"2a7501ce-47fe-44af-b333-391cdb0e812e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ",
      "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", " ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firsts", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"x0", ",", " ", "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tfs", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1", ",", " ", "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t0s", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "k"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finals", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", "6"}], "]"}], ",", " ", 
     RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datapoints", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"t0s", ",", " ", "tfs", ",", " ", "firsts", ",", " ", "finals"}],
      "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.915383371798586*^9, 3.915383376949902*^9}, {
   3.915383993451714*^9, 3.915383993789464*^9}, {3.915384525802215*^9, 
   3.915384540865444*^9}, {3.9153847054857817`*^9, 3.915384706438778*^9}, {
   3.915384769976225*^9, 3.915384803750641*^9}, {3.915384835583741*^9, 
   3.915384918542737*^9}, {3.915384966914145*^9, 3.915384979057313*^9}, {
   3.9153866667111692`*^9, 3.9153867520166073`*^9}, 3.9153869312165823`*^9, {
   3.915387377650899*^9, 3.915387387294902*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"277cd5cb-4e5c-480d-b425-236c45a2a2bd"],

Cell[BoxData[{
 RowBox[{"res", " ", "=", " ", 
  RowBox[{
  "costfunctional", " ", "@@@", " ", 
   "datapoints"}]}], "\[IndentingNewLine]", 
 RowBox[{"AllTrue", "[", 
  RowBox[{"res", ",", 
   RowBox[{
    RowBox[{"#", "<=", "m"}], "&"}]}], "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.915386809450547*^9, 3.915386848916091*^9}, {
  3.915386919757436*^9, 3.915386923466113*^9}, {3.91538730123838*^9, 
  3.915387318979927*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"4844e31b-b8ac-4dc6-a8e8-726692e7cd8c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.915386754811222*^9, 
  3.915386792915097*^9}},ExpressionUUID->"7e8e3900-2c6d-4b79-bb93-\
55150bd79981"]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 10}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"439bfbd9-f97f-4c08-a637-49e5270b50d2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 299, 5, 30, "Input",ExpressionUUID->"c9f5c03e-7b14-46db-af1f-952b22ef8bfb"],
Cell[860, 27, 14907, 350, 556, "Input",ExpressionUUID->"efd9f47c-38e9-4c6e-a7b6-cec6d77c5959"],
Cell[15770, 379, 1104, 28, 136, "Input",ExpressionUUID->"59c84052-bf99-4950-81a3-f578015f1b7b"],
Cell[16877, 409, 491, 7, 30, "Input",ExpressionUUID->"6a7661d3-3885-47e4-82db-00b0fe86f100"],
Cell[CellGroupData[{
Cell[17393, 420, 26367, 695, 587, "Input",ExpressionUUID->"199f22b4-8f91-432b-836b-de5c4914d6c9"],
Cell[43763, 1117, 7825, 236, 220, "Output",ExpressionUUID->"fc62bd54-203b-4a6b-b88a-9e36b1e13f98"],
Cell[51591, 1355, 977, 29, 128, "Output",ExpressionUUID->"4d6320ed-f8e7-4be6-b545-5e1988b80064"]
}, Open  ]],
Cell[52583, 1387, 172, 4, 30, "Input",ExpressionUUID->"0def9b0b-e42f-4e7e-b8b2-57ca94775a30"],
Cell[52758, 1393, 174, 4, 30, "Input",ExpressionUUID->"f67ff140-f44a-41e2-a740-c353de0e632d"],
Cell[52935, 1399, 172, 4, 30, "Input",ExpressionUUID->"16513978-b3b6-42d3-b2c1-a45ee2c97f9c"],
Cell[53110, 1405, 175, 3, 30, "Input",ExpressionUUID->"26621c29-8ad7-473a-b69b-f2bad736b08a"],
Cell[53288, 1410, 743, 11, 30, "Input",ExpressionUUID->"04b7f94f-9fb1-494c-86d9-24035fb280a8"],
Cell[54034, 1423, 1451, 34, 94, "Input",ExpressionUUID->"fc988bc5-ae99-417f-b464-a25cc825841b"],
Cell[55488, 1459, 175, 3, 30, "Input",ExpressionUUID->"3384e1b8-ea5e-4d71-93d5-22ce3e94526e"],
Cell[55666, 1464, 661, 13, 30, "Input",ExpressionUUID->"58f267fb-cd68-4e0a-b609-dc576127dabe"],
Cell[56330, 1479, 1532, 38, 30, "Input",ExpressionUUID->"572448ce-bd1e-4f69-a45d-2cfeb8d88af1"],
Cell[57865, 1519, 223, 4, 30, "Input",ExpressionUUID->"1a1e7cb8-326d-4206-8885-29b657ae7fb5"],
Cell[58091, 1525, 2408, 54, 94, "Input",ExpressionUUID->"3b98e55e-4d28-4a68-9375-1986b56f17bb"],
Cell[60502, 1581, 172, 4, 30, "Input",ExpressionUUID->"6c413efe-3374-42f0-8a07-81f210191ed6"],
Cell[60677, 1587, 175, 3, 30, "Input",ExpressionUUID->"5d195a24-2815-4fd1-a4b4-abda7c0ae1fb"],
Cell[60855, 1592, 177, 3, 30, "Input",ExpressionUUID->"88b470a2-70e5-49e0-a23e-ddbb5131e24b"],
Cell[61035, 1597, 203, 4, 30, "Input",ExpressionUUID->"8c2d909f-24de-450f-ac5d-141c12c5a9fe"],
Cell[61241, 1603, 1946, 47, 73, "Input",ExpressionUUID->"15e5b7ce-9d3e-4b51-94f3-3b0306b901f4"],
Cell[63190, 1652, 3198, 67, 52, "Input",ExpressionUUID->"d0360e3d-4dab-4ba3-b073-8e777bff2e11"],
Cell[66391, 1721, 2095, 53, 52, "Input",ExpressionUUID->"82e5541a-e7c2-4a0b-96a8-c139014b4160"],
Cell[CellGroupData[{
Cell[68511, 1778, 172, 3, 52, "Input",ExpressionUUID->"e238860f-b71c-450c-bd22-3455a7eaef05"],
Cell[68686, 1783, 710, 15, 31, "Message",ExpressionUUID->"d7f9892b-c560-462d-828e-d0605987e2f9"]
}, {3}]],
Cell[69408, 1801, 174, 3, 30, "Input",ExpressionUUID->"edb63cea-9b08-4918-a6ed-4b3dbd264b32"],
Cell[69585, 1806, 177, 3, 30, "Input",ExpressionUUID->"ee59b86a-eb0f-4de8-b774-23ac28d7662d"],
Cell[69765, 1811, 473, 11, 30, "Input",ExpressionUUID->"06c94dd5-1bd4-42b6-bd40-a0425ebf7bfa"],
Cell[70241, 1824, 429, 7, 115, "Input",ExpressionUUID->"70af19b1-6ec3-4f16-bd75-1dcfc413ccd7"],
Cell[70673, 1833, 572, 9, 30, "Input",ExpressionUUID->"30ccac0d-e0a6-4a2e-a612-e5d0e71c26b9"],
Cell[71248, 1844, 298, 5, 30, "Input",ExpressionUUID->"0b05e917-1982-4a8c-a1fc-e239cff8fca3"],
Cell[71549, 1851, 572, 9, 30, "Input",ExpressionUUID->"0adbb88f-42b7-4ceb-a6bb-e261e8a98156"],
Cell[72124, 1862, 175, 3, 30, "Input",ExpressionUUID->"f171eeeb-4439-4e0e-a51b-207f92391c94"],
Cell[72302, 1867, 1429, 32, 30, "Input",ExpressionUUID->"b7f6fbe7-5274-40ce-9e5b-1bcff52022f6"],
Cell[73734, 1901, 233, 4, 30, "Input",ExpressionUUID->"524c2b27-8bb9-4ecf-889c-91c2eac0a3d3"],
Cell[73970, 1907, 174, 3, 30, "Input",ExpressionUUID->"35cd92c3-1999-434a-ad34-0130c3ba13a6"],
Cell[74147, 1912, 1151, 30, 30, "Input",ExpressionUUID->"3b79a3d6-efaf-40b6-93bd-801efd007f4d"],
Cell[75301, 1944, 917, 24, 30, "Input",ExpressionUUID->"636cebf8-02a9-4b00-a873-a3b6ed2d8ecf"],
Cell[76221, 1970, 654, 15, 30, "Input",ExpressionUUID->"2a7501ce-47fe-44af-b333-391cdb0e812e"],
Cell[76878, 1987, 1929, 46, 178, "Input",ExpressionUUID->"277cd5cb-4e5c-480d-b425-236c45a2a2bd"],
Cell[78810, 2035, 510, 13, 73, "Input",ExpressionUUID->"4844e31b-b8ac-4dc6-a8e8-726692e7cd8c"],
Cell[79323, 2050, 152, 3, 30, "Input",ExpressionUUID->"7e8e3900-2c6d-4b79-bb93-55150bd79981"]
}
]
*)

