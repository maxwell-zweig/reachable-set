(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    169924,       3846]
NotebookOptionsPosition[    162426,       3750]
NotebookOutlinePosition[    162870,       3767]
CellTagsIndexPosition[    162827,       3764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "This", " ", "is", " ", "code", " ", "modified", " ", 
    "specifically", " ", "for", " ", "the", " ", "2", "d", " ", "case"}], " ",
    "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "the", " ", "directory", " ", "that", " ", "you", 
    " ", "want", " ", "your", " ", "plots", " ", "to", " ", "go", " ", "to", 
    " ", "here"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "\"\</users/maxzweig/fuelthrust\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "axes", " ", "for", " ", "the", " ", 
     "energy", " ", "limited", " ", "reachable", " ", "set", " ", 
     "associated", " ", "with", " ", "a", " ", "given", " ", "terminal", " ", 
     "time", " ", "and", " ", "thrust"}], " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAxes", "[", 
     RowBox[{"terminaltime_", ",", " ", "quadform_", ",", " ", "thrustmax_"}],
      "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ax1", ",", "ax2"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "minimum", " ", "and", " ", "maximum", 
     " ", "ratios", " ", "between", " ", "an", " ", "energy", " ", "limited", 
     " ", "set", " ", "and", " ", "an", " ", "arbitrary", " ", "reachable", 
     " ", "set", " ", "given", " ", "as", " ", "set", " ", "of", " ", 
     "points"}], " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reachablestatsoperator", "[", 
     RowBox[{"points_", ",", "axis1_", ",", "axis2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], 
              "^", "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], 
              "^", "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ratio", "[", "pos_", "]"}], ":=", " ", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"ellipseVecFromUnitVec", "[", 
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{"pos", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", "axis1", 
            ",", " ", "axis2"}], "]"}], " ", "]"}], "/", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"maxminrat", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Max"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Min"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
              " ", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}], 
           " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
            ")"}]}], ",", " ", 
          RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"maxminvec", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"v1s", "[", 
            RowBox[{"[", " ", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                 "Max"}]}], "    ", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
            " ", "toq2q1"}], " ", ",", " ", 
          RowBox[{
           RowBox[{"v1s", "[", 
            RowBox[{"[", " ", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                 "Min"}]}], "   ", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
            " ", "toq2q1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rats", " ", "=", " ", 
        RowBox[{"maxminrat", "[", " ", "points", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"maxminvec", "[", " ", "points", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rats", " ", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vecs", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", " ", 
           RowBox[{"vecs", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getFinalEnergyPos", "[", 
      RowBox[{"tt_", ",", " ", "tmax_", ",", " ", "nt_", ",", " ", "delta_"}],
       "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"energyform", "[", 
          RowBox[{"tff_", ",", " ", "na_"}], "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "c", ",", " ", "r", ",", " ", "sig", ",", " ", "gamma", ",", " ", 
             "nmat"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "[", "n_", "]"}], " ", "=", " ", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{
                  RowBox[{"-", "2"}], "*", " ", "n"}], ",", " ", "0", ",", 
                 " ", "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", " ", "*", " ", "n"}], ",", " ", "0", ",", " ", 
                 "0", ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "0", 
                 " ", ",", " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", 
                 "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", "0", 
                 ",", "0"}], " ", "}"}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", "0", ",", " ", 
                 RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", 
                 "0"}], " ", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
            " ", 
            RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "MatrixForm"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"t_", ",", " ", "h_"}], "]"}], " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"72", " ", "t", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"154", " ", "h", " ", "t"}], "+", 
                    RowBox[{"48", " ", 
                    SuperscriptBox["h", "3"], " ", 
                    SuperscriptBox["t", "3"]}], "-", 
                    RowBox[{"384", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                    RowBox[{"27", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
                   RowBox[{"4", " ", "h"}]]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "h", " ", 
                   SuperscriptBox["t", "2"]}], "+", 
                  FractionBox[
                   RowBox[{"6", "-", 
                    RowBox[{"6", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "0", ",", 
                 FractionBox[
                  RowBox[{"8", "+", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["h", "2"], " ", 
                    SuperscriptBox["t", "2"]}], "-", 
                   RowBox[{"8", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"24", " ", "h", " ", "t", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "+", 
                   RowBox[{"9", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
                  RowBox[{"2", " ", 
                   SuperscriptBox["h", "2"]}]], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"23", " ", "h", " ", "t"}], "+", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["h", "3"], " ", 
                    SuperscriptBox["t", "3"]}], "+", 
                   RowBox[{"42", " ", "h", " ", "t", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"56", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{
                    FractionBox["9", "2"], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
                  SuperscriptBox["h", "2"]], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "h", " ", 
                   SuperscriptBox["t", "2"]}], "+", 
                  FractionBox[
                   RowBox[{"6", "-", 
                    RowBox[{"6", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "t", ",",
                  "0", ",", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "h"}], " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
                  SuperscriptBox["h", "2"]], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"3", " ", 
                    SuperscriptBox["t", "2"]}], "2"]}], "+", 
                  FractionBox[
                   RowBox[{"4", "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}]}], 
                   SuperscriptBox["h", "2"]]}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"2", " ", "h", " ", "t"}], "+", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
                  RowBox[{"4", " ", "h"}]], ",", "0", ",", "0", ",", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}], "2"], 
                  RowBox[{"2", " ", 
                   SuperscriptBox["h", "2"]}]]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox[
                  RowBox[{"8", "+", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["h", "2"], " ", 
                    SuperscriptBox["t", "2"]}], "-", 
                   RowBox[{"8", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"24", " ", "h", " ", "t", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "+", 
                   RowBox[{"9", " ", 
                    SuperscriptBox[
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
                  RowBox[{"2", " ", 
                   SuperscriptBox["h", "2"]}]], ",", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "h"}], " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
                  SuperscriptBox["h", "2"]], ",", "0", ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"26", " ", "h", " ", "t"}], "-", 
                   RowBox[{"32", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "+", 
                   RowBox[{"3", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
                  RowBox[{"4", " ", 
                   SuperscriptBox["h", "3"]}]], ",", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "h"}], " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
                  SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"23", " ", "h", " ", "t"}], "+", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["h", "3"], " ", 
                    SuperscriptBox["t", "3"]}], "+", 
                   RowBox[{"42", " ", "h", " ", "t", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"56", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{
                    FractionBox["9", "2"], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
                  SuperscriptBox["h", "2"]], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"3", " ", 
                    SuperscriptBox["t", "2"]}], "2"]}], "+", 
                  FractionBox[
                   RowBox[{"4", "-", 
                    RowBox[{"4", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}]}], 
                   SuperscriptBox["h", "2"]]}], ",", "0", ",", 
                 FractionBox[
                  RowBox[{"3", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "h"}], " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
                  SuperscriptBox["h", "3"]], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"14", " ", "h", " ", "t"}], "+", 
                   RowBox[{"3", " ", 
                    SuperscriptBox["h", "3"], " ", 
                    SuperscriptBox["t", "3"]}], "+", 
                   RowBox[{"24", " ", "h", " ", "t", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"32", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                   RowBox[{"3", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
                  SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 FractionBox[
                  SuperscriptBox[
                   RowBox[{"Sin", "[", 
                    RowBox[{"h", " ", "t"}], "]"}], "2"], 
                  RowBox[{"2", " ", 
                   SuperscriptBox["h", "2"]}]], ",", "0", ",", "0", ",", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "h", " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
                   RowBox[{"4", " ", 
                    SuperscriptBox["h", "3"]}]]}]}], "}"}]}], "}"}]}], ";", 
            RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"t", ",", " ", "n"}], "]"}], " ", "//", " ", 
             "MatrixForm"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sig", "[", 
              RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"4", "-", 
                  RowBox[{"3", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0", ",", "0", 
                 ",", 
                 FractionBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}], "n"], ",", 
                 FractionBox[
                  RowBox[{"2", "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], "n"], ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"6", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "n"}], " ", "t"}], "+", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "1", ",", 
                 "0", ",", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], "n"], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"4", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}], ",", "0", ",", "0", ",", 
                 FractionBox[
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}], "n"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", " ", "n", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
                 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}], ",", 
                 RowBox[{"2", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"6", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "0", ",", 
                 "0", ",", 
                 RowBox[{
                  RowBox[{"-", "2"}], " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"4", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", 
                 RowBox[{
                  RowBox[{"-", "n"}], " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
                 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}]}], "}"}]}], "}"}]}], ";", 
            " ", 
            RowBox[{"(*", " ", "Good", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"gamma", "[", 
              RowBox[{"t_", ",", " ", "t0_", ",", " ", "n_"}], "]"}], " ", 
             "=", " ", 
             RowBox[{
              RowBox[{"sig", "[", 
               RowBox[{"t", ",", " ", "n"}], "]"}], ".", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sig", "[", 
                 RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
                "Inverse"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nmat", "[", 
              RowBox[{"t0_", ",", " ", "tf_", ",", " ", "n_"}], "]"}], " ", 
             "=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sig", "[", 
                    RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
                   "Inverse"}], ",", " ", 
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"sig", "[", 
                    RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
                   "Inverse"}], ",", " ", "2"}], "]"}], " ", "//", " ", 
                "Transpose"}], ")"}], ".", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"tf", ",", " ", "n"}], "]"}], " ", "//", " ", 
                "Inverse"}], ")"}], ".", 
              RowBox[{"c", "[", "n", "]"}], ".", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sig", "[", 
                  RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
                 "Inverse"}], ",", " ", 
                RowBox[{
                 RowBox[{"-", " ", 
                  RowBox[{"sig", "[", 
                   RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
                 "Inverse"}], ",", " ", "2"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nmat", "[", 
             RowBox[{"0", ",", " ", "tff", ",", " ", "na"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "6", "]"}], " ", "-", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], 
            ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis", " ", "=", " ", 
         RowBox[{"Orthogonalize", "[", "udd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"projmat", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
            RowBox[{"basis", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;"}], "]"}], "]"}]}], "]"}], " ", "//", " ", 
          "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"projmatT", " ", "=", " ", 
         RowBox[{"projmat", " ", "//", " ", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"selectionMat", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eformxf", " ", "=", " ", 
         RowBox[{
          RowBox[{"energyform", "[", 
           RowBox[{"tt", ",", " ", "nt"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"7", ";;", "12"}], ",", " ", 
            RowBox[{"7", ";;", "12"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ydir", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eigenvectors", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projmatT", ".", "selectionMat", ".", "projmat"}], ",", 
             " ", 
             RowBox[{"projmatT", ".", "eformxf", ".", "projmat"}]}], "}"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"projmat", ".", "ydir"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmag", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tt", " ", 
            RowBox[{
             RowBox[{"tmax", "^", "2"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{"xdir", ".", "eformxf", ".", "xdir"}], ")"}]}]}], ")"}],
           " ", "//", " ", "Sqrt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xdir", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"delta", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", "0"}], ",", 
           " ", 
           RowBox[{"-", "xdir"}], ",", " ", "xdir"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "tmag"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostatev2", "[", 
     RowBox[{"ics_", ",", " ", "isp_", ",", " ", "tf_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", 
          ",", "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", 
          "lzv", ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], 
           ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"switchingfunc", "[", 
                 RowBox[{
                 "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                   " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
               "2"}]}], ")"}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", 
           "/", " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "eqnsStateOpt"}], " ", "=", " ", 
          RowBox[{"{", "  ", 
           RowBox[{
            RowBox[{
             RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
             RowBox[{"3", 
              RowBox[{"n", "^", "2"}], " ", "x"}], " ", "-", "lxv"}], ",", 
            "    ", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "n", " ", "vx"}], " ", "-", "lyv"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"-", " ", 
               RowBox[{"n", "^", "2"}]}], " ", "z"}], " ", "-", " ", 
             "lzv"}]}], " ", "}"}]}], ";"}], " ", "**)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", "  ", 
        RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], 
              "\[Equal]", "ics"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]",
           "vars", ",", "  ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tf", ",", " ", "tf"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "tf", "]"}], "&"}], "/@", "soln"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findInitialCostates", "[", 
     RowBox[{
     "icRel_", ",", " ", "fcRel_", ",", " ", "n_", ",", " ", "A_", ",", " ", 
      "td_", ",", " ", "mmax_", ",", " ", "m0_", ",", " ", "tmax_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "-", 
         " ", 
         RowBox[{"{", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{
          "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
           "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getInitCostates", "[", 
         RowBox[{"varMat_", ",", "icsRel_", ",", "fcsRel_"}], "]"}], ":=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{"varMat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "6"}], ",", 
             RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], ",", 
          RowBox[{"fcsRel", "-", 
           RowBox[{
            RowBox[{"varMat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "6"}], ",", 
               RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], ".", "icsRel"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"topLeftMatrix", "=", "A"}], ";", "\[IndentingNewLine]", 
       RowBox[{"topRightMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleRightMatrix", "=", 
        RowBox[{"-", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"bottomRightMatrix", "=", 
        RowBox[{
         RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bottomLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"A", ",", " ", 
            RowBox[{"Join", "[", " ", 
             RowBox[{"topRightMatrix", ",", " ", 
              RowBox[{"Join", "[", 
               RowBox[{
               "middleLeftMatrix", ",", " ", "middleRightMatrix", ",", " ", 
                "2"}], "]"}]}], "]"}], ",", " ", "2"}], "]"}], ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
           "bottomLeftMatrix", ",", " ", "bottomRightMatrix", ",", " ", "2"}],
            " ", "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stm", "[", "tf_", "]"}], " ", ":=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"fullmatrix", " ", "tf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initCo", " ", "=", " ", 
        RowBox[{"getInitCostates", "[", 
         RowBox[{
          RowBox[{"stm", "[", "td", "]"}], ",", " ", "icRel", ",", " ", 
          "fcRel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lambdastm", "[", "ta_", "]"}], " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}], ")"}], " ", 
          "ta"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lma", " ", "=", " ", 
        RowBox[{
         RowBox[{"isp", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lambdastm", "[", 
                 RowBox[{"mmax", " ", 
                  RowBox[{"isp", " ", "/", " ", "tmax"}]}], "]"}], ".", 
                "initCo"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "6"}], "]"}], "]"}], "   ", "//", " ", 
             "Norm"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"m0", " ", "-", " ", "mmax"}], ")"}]}]}], " ", "-", " ", 
         RowBox[{"NIntegrate", "[", "  ", 
          RowBox[{
           RowBox[{"tmax", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"lambdastm", "[", "t", "]"}], ".", "initCo"}], 
                  ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], " ", "//", 
               " ", "Norm"}], ")"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m0", " ", "-", " ", 
                 RowBox[{"tmax", " ", 
                  RowBox[{"t", " ", "/", " ", "isp"}]}]}], ")"}], " ", "^", 
               "2"}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", 
             RowBox[{"mmax", " ", 
              RowBox[{"isp", " ", "/", " ", "tmax"}]}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initCoM", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"initCo", ",", " ", 
          RowBox[{"{", "lma", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "initCoM"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numerPropAndSTM2", "[", 
     RowBox[{
     "vars_", ",", "ics_", ",", "dyn_", ",", "jac_", ",", "jac2_", ",", 
      "time_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"soln", ",", "zeros", ",", "tpzeros"}], "}"}], ",", 
      RowBox[{
       RowBox[{"zeros", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "vars", "]"}]}], "]"}]}], ";", 
       RowBox[{"tpzeros", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{"zeros", ",", "zeros"}], "]"}], ",", "zeros"}], "]"}]}], 
       ";", 
       RowBox[{"soln", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", "vars"}], 
               ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], 
              "\[Equal]", "ics"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Phi", "'"}], "[", "t", "]"}], "==", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"jac", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}], ".", 
              RowBox[{"Phi", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Phi2", "'"}], "[", "t", "]"}], "==", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"jac", "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"vars", "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}], ".", 
               RowBox[{"Phi2", "[", "t", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Phi", "[", "t", "]"}], "]"}], ".", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"(", 
                   RowBox[{"jac2", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}], "]"}]}], "]"}], ".", 
               RowBox[{"Phi", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"Phi", "[", "0", "]"}], "==", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "vars", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Phi2", "[", "0", "]"}], "==", "tpzeros"}]}], "}"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"vars", ",", 
            RowBox[{"{", 
             RowBox[{"Phi", ",", "Phi2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "time", ",", "time"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "time", "]"}], "&"}], "/@", "vars"}], ")"}], "/.", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Phi", "[", "time", "]"}], "/.", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Phi2", "[", "time", "]"}], "/.", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propInitialCostatesThrust", "[", 
     RowBox[{
     "icRel_", ",", " ", "n_", ",", " ", "A_", ",", " ", "td_", ",", " ", 
      "mmax_", ",", " ", "m0_", ",", " ", "tmax_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "lxr",
           ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{"tmax", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", 
           "/", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lxv", "^", "2"}], " ", "+", " ", 
               RowBox[{"lyv", "^", "2"}], " ", "+", 
               RowBox[{"lzv", "^", "2"}]}], " ", ")"}], " ", "//", " ", 
             "Sqrt"}], ")"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{
          "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
           "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            "eqnsStateOpt"}], "]"}], ",", "eqnsOpt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"jac", "=", 
        RowBox[{"D", "[", 
         RowBox[{"dyn", ",", 
          RowBox[{"{", "vars", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"jac2", "=", 
        RowBox[{"D", "[", 
         RowBox[{"jac", ",", 
          RowBox[{"{", "vars", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"numerPropAndSTM2", "[", 
         RowBox[{"vars", ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", "6"}], "]"}], ",", " ", "icRel"}], "]"}], ",", 
          " ", "dyn", ",", " ", "jac", ",", " ", "jac2", ",", " ", "td"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
     "joint_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "m0_", ",", 
      " ", "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", 
            RowBox[{"joint", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "7"}], "]"}], "]"}]}], " ", "]"}], ",", " ", 
          "isp", ",", " ", "endTime"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cons", "[", 
         RowBox[{"dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "ma_"}], 
         "]"}], " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"udd", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", 
             "-", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", 
              RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"udd", ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c2", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"lf", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", ".", " ", 
              "dey"}], " ", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c3", " ", "=", "  ", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"endTime", " ", 
                RowBox[{"tmax", " ", "/", " ", "isp"}]}], "<=", "ma"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                RowBox[{"endTime", " ", 
                 RowBox[{"tmax", " ", "/", " ", "isp"}]}]}], "}"}], ",", " ", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", "ma"}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c4", " ", "=", " ", 
            RowBox[{"lf", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "6"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"c1", ",", " ", "c2"}], "]"}], ",", " ", "c3"}], 
               "]"}], ",", " ", "c4"}], "]"}], " ", "//", " ", 
            "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cons", "[", 
        RowBox[{"direction", ",", " ", 
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfind", "[", 
     RowBox[{
     "ly_", ",", " ", "init_", ",", " ", "mm_", ",", " ", "direction_", ",", 
      " ", "A_", ",", " ", "m0_", ",", " ", "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"s", " ", "=", " ", 
            RowBox[{"MatrixExp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
              "endTime"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"subs", " ", "=", " ", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", 
                   RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                  "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", 
                   " ", "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", 
                 " ", "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ly", ",", " ", 
                    "0"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", "ly"}]}], "}"}]}]}], "]"}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "endTime"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cons", "[", 
             RowBox[{
             "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_"}], 
             "]"}], " ", ":=", " ", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"udd", " ", "=", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ",
                  "-", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
                   ")"}], ".", 
                  RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"c1", " ", "=", 
                RowBox[{"{", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"udd", ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xf", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"xf", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "}"}]}], " ", ";", 
               "\[IndentingNewLine]", 
               RowBox[{"c2", " ", "=", "  ", 
                RowBox[{"If", " ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"endTime", " ", 
                    RowBox[{"tmax", " ", "/", " ", "isp"}]}], "<=", "mmax"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m0", " ", "-", " ", 
                    RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                    RowBox[{"endTime", " ", 
                    RowBox[{"tmax", " ", "/", " ", "isp"}]}]}], "}"}], ",", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m0", " ", "-", " ", 
                    RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                    "mmax"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
                "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", "init"}], " ", "}"}], "}"}], ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "\[Rule]", "10"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "poss"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getReachablePoint", "[", 
     RowBox[{
     "direction_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_", 
      ",", " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posf", " ", "=", " ", 
        RowBox[{"getFinalEnergyPos", "[", 
         RowBox[{
         "endTime", ",", " ", "tmax", ",", " ", "n", ",", " ", "direction"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initCostates", " ", "=", " ", 
        RowBox[{"findInitialCostates", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
           "}"}], ",", " ", "posf", ",", " ", "n", ",", " ", "A", ",", " ", 
          "endTime", ",", " ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",", 
          " ", 
          RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hey", " ", "=", " ", 
        RowBox[{"initCostates", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialGuess2", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"initCostates", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"initCostates", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{
         RowBox[{"rootfind", "[", 
          RowBox[{"hey", ",", " ", "initialGuess2", ",", " ", 
           RowBox[{"tmax", " ", "fuelpercent", " ", 
            RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
           "direction", ",", " ", "A", ",", " ", "m0", ",", " ", "isp"}], 
          "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lxm2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "hey", ",", " ", 
                  "0"}], "}"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                   "subs"}], " ", ")"}], " ", "/.", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                   RowBox[{"v2", " ", "->", "hey"}]}], "}"}]}]}], "]"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", " ", "isp", ",", " ", "endTime"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"out", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939729075467511*^9, 3.939729090183818*^9}, {
   3.939738190916923*^9, 3.939738206534154*^9}, {3.9397589382068243`*^9, 
   3.939758938546671*^9}, {3.9397705671668987`*^9, 3.939770596913928*^9}, {
   3.939772196433568*^9, 3.939772202641374*^9}, {3.939772268145981*^9, 
   3.939772269671165*^9}, {3.939772774397547*^9, 3.9397727761267843`*^9}, {
   3.9397729016005783`*^9, 3.9397729311649513`*^9}, 3.9397732805895147`*^9, {
   3.940466789052109*^9, 3.940466790172817*^9}, {3.940466870287772*^9, 
   3.9404668730241337`*^9}, {3.940550445808197*^9, 3.9405504955095463`*^9}, {
   3.940550645163851*^9, 3.940550678987441*^9}, {3.94055072112564*^9, 
   3.940550823801209*^9}, {3.9405508628089943`*^9, 3.940550876343471*^9}, 
   3.940550928894618*^9, {3.94055099743615*^9, 3.940550999660128*^9}, {
   3.9405511051251707`*^9, 3.9405511069134483`*^9}, {3.9405511778875103`*^9, 
   3.94055121467408*^9}, {3.9405512512659607`*^9, 3.940551283274836*^9}, {
   3.940551380569178*^9, 3.940551400356626*^9}, 3.9405515303155527`*^9, {
   3.94055161122302*^9, 3.940551612786004*^9}, {3.940599080614152*^9, 
   3.940599102834415*^9}, {3.940599161087613*^9, 3.9405991649997396`*^9}, {
   3.94059989431002*^9, 3.940599917766323*^9}, {3.940599962988117*^9, 
   3.940599963536326*^9}, {3.940600020124267*^9, 3.9406000231654863`*^9}, {
   3.940600120720972*^9, 3.940600202120462*^9}, {3.940600308159964*^9, 
   3.940600308783695*^9}, {3.940600395449255*^9, 3.940600414842168*^9}, {
   3.940601493404436*^9, 3.940601501082363*^9}, {3.9406015581967297`*^9, 
   3.940601562126377*^9}, {3.9406016349943542`*^9, 3.940601654530643*^9}, {
   3.9406020215438347`*^9, 3.9406020269473743`*^9}, {3.940608404311987*^9, 
   3.940608404691531*^9}, {3.940608502386119*^9, 3.940608505363304*^9}, {
   3.940608690343299*^9, 3.940608690810286*^9}, {3.940608948992734*^9, 
   3.940608975250257*^9}, {3.940609231801025*^9, 3.940609234865506*^9}, {
   3.940609275137212*^9, 3.940609287151318*^9}, {3.9406098606339903`*^9, 
   3.940609876589637*^9}, {3.940610109234393*^9, 3.940610109288344*^9}, {
   3.940610383798914*^9, 3.94061038403069*^9}, {3.9406105172273617`*^9, 
   3.940610520834305*^9}, {3.94061064915304*^9, 3.940610654973712*^9}, {
   3.940612690961554*^9, 3.940612786626652*^9}, {3.940613068505394*^9, 
   3.940613074347137*^9}, {3.940613152102597*^9, 3.9406131521651087`*^9}, {
   3.940614110266932*^9, 3.940614111469262*^9}, {3.940614169528878*^9, 
   3.9406141787848873`*^9}, {3.940614272923246*^9, 3.940614278054255*^9}, {
   3.940616250756616*^9, 3.940616251133417*^9}, {3.940616355210651*^9, 
   3.9406163749074497`*^9}, {3.940616503125251*^9, 3.9406165059642763`*^9}, {
   3.9406166155375566`*^9, 3.9406166183655863`*^9}, {3.940616662894883*^9, 
   3.940616671640141*^9}, {3.9406168381400633`*^9, 3.940616838191267*^9}, {
   3.9406168765832663`*^9, 3.9406168766327953`*^9}, {3.940617262044869*^9, 
   3.9406172773637247`*^9}, {3.940618354106642*^9, 3.940618389658963*^9}, {
   3.940618462078704*^9, 3.940618479258544*^9}, 3.940618552946515*^9, {
   3.940618726475478*^9, 3.94061874413246*^9}, {3.940618841789955*^9, 
   3.9406188571658287`*^9}, {3.940618904938076*^9, 3.940618942774856*^9}, {
   3.940618998434513*^9, 3.940618999733069*^9}, {3.940619712175825*^9, 
   3.940619712576332*^9}, {3.940619973612961*^9, 3.940619974860991*^9}, {
   3.940620015709753*^9, 3.94062008555162*^9}, {3.9406201196702623`*^9, 
   3.9406201295889606`*^9}, {3.9406203925196457`*^9, 
   3.9406203994364777`*^9}, {3.940620455140674*^9, 3.9406204554053507`*^9}, {
   3.940620489791079*^9, 3.940620490133729*^9}, {3.940620567840304*^9, 
   3.9406205679537983`*^9}, {3.940620637746958*^9, 3.940620640831489*^9}, {
   3.940620687972727*^9, 3.9406206880455837`*^9}, {3.940620725469335*^9, 
   3.940620727120475*^9}, {3.940620781723898*^9, 3.940620786029851*^9}, {
   3.940620838314703*^9, 3.940620847577928*^9}, {3.940620888488495*^9, 
   3.940620889827568*^9}, {3.940621173561473*^9, 3.940621187017885*^9}, {
   3.94062129685919*^9, 3.94062133653544*^9}, {3.9406213948873243`*^9, 
   3.940621396929677*^9}, {3.940621684336273*^9, 3.94062169936209*^9}, {
   3.9406217876630363`*^9, 3.94062182099995*^9}, {3.9406222775759993`*^9, 
   3.940622278908633*^9}, {3.9406225704324493`*^9, 3.9406225771801233`*^9}, {
   3.940622677107677*^9, 3.940622680590123*^9}, {3.940623185581359*^9, 
   3.940623210744137*^9}, {3.940623289792686*^9, 3.940623299276252*^9}, 
   3.940623565760182*^9, {3.940623627342018*^9, 3.940623628997134*^9}, {
   3.9406238294948177`*^9, 3.9406238329993277`*^9}, {3.940624086712628*^9, 
   3.940624089185576*^9}, {3.940627343620598*^9, 3.940627347206685*^9}, {
   3.940627461011836*^9, 3.940627468835535*^9}, 3.940627504049109*^9, {
   3.940635683828641*^9, 3.940635693176412*^9}, {3.9406357360319843`*^9, 
   3.9406357458347387`*^9}, {3.940636080977592*^9, 3.9406361037309*^9}, {
   3.940636178015853*^9, 3.940636178409669*^9}, {3.940636235306897*^9, 
   3.9406362401235723`*^9}, {3.941025037704258*^9, 3.941025046814034*^9}, {
   3.941203682140253*^9, 3.9412037103059063`*^9}, {3.941203741719153*^9, 
   3.941203752278411*^9}, {3.9412057403737173`*^9, 3.941205741386429*^9}, {
   3.941206503141294*^9, 3.9412065110476027`*^9}, {3.941206575318674*^9, 
   3.941206607568199*^9}, {3.9412067588702917`*^9, 3.941206765108327*^9}, {
   3.941206815863701*^9, 3.941206828490828*^9}, {3.941380256641616*^9, 
   3.9413802747069893`*^9}, {3.9413821137398157`*^9, 
   3.9413821793651943`*^9}, {3.9413823746420307`*^9, 3.941382412181016*^9}, {
   3.9413824463692493`*^9, 3.941382510638538*^9}, {3.9413840079521847`*^9, 
   3.941384012814979*^9}, {3.941384048276434*^9, 3.941384071272071*^9}, {
   3.941384133106862*^9, 3.9413841451679373`*^9}, {3.941384176106847*^9, 
   3.9413841906756077`*^9}, {3.9413842604344397`*^9, 3.941384417526003*^9}, {
   3.941384475804749*^9, 3.941384490403714*^9}, {3.941384538033826*^9, 
   3.9413846071450233`*^9}, {3.941384683225644*^9, 3.941384724579934*^9}, {
   3.941385356757915*^9, 3.9413854254443502`*^9}, {3.941385463576733*^9, 
   3.9413854667739487`*^9}, {3.941385530104163*^9, 3.941385542887578*^9}, {
   3.941385596173017*^9, 3.941385612964837*^9}, {3.941388352768071*^9, 
   3.941388361713107*^9}, {3.941468439236871*^9, 3.941468469761054*^9}, {
   3.9414685656765413`*^9, 3.941468567481572*^9}, {3.941468906888383*^9, 
   3.941468908636071*^9}, {3.941468964641871*^9, 3.941469139344284*^9}, {
   3.941470124810523*^9, 3.941470125255631*^9}, {3.9416490762352133`*^9, 
   3.941649142873995*^9}, {3.941649194255047*^9, 3.94164919461801*^9}, {
   3.941649719976585*^9, 3.941649729361993*^9}, {3.941649842257956*^9, 
   3.941649865861958*^9}, 3.941922553456903*^9, {3.9419226683114643`*^9, 
   3.941922699197268*^9}, {3.94192291606936*^9, 3.941922929430016*^9}, {
   3.941922959522664*^9, 3.9419229612874193`*^9}, {3.9419230072930593`*^9, 
   3.941923015740151*^9}, {3.9419230773760366`*^9, 3.941923078188032*^9}, {
   3.94192310874439*^9, 3.941923146301938*^9}, {3.9419235911920977`*^9, 
   3.9419235986621847`*^9}, {3.9419279964492483`*^9, 3.941928002275008*^9}, {
   3.943819104266883*^9, 3.943819132261901*^9}, {3.943819170652658*^9, 
   3.943819181941875*^9}, {3.943819525244673*^9, 3.943819584344078*^9}, {
   3.94381964126537*^9, 3.943819644476128*^9}, {3.9438196748721657`*^9, 
   3.943819677965816*^9}, 3.943819719059938*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"9f53022a-d697-437e-951e-509984f201a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu1", " ", "=", " ", 
   RowBox[{"3.986", " ", 
    RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", "3600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mu1", " ", "/", " ", 
      RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
       " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", 
       "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", 
       RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isp", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax", " ", "=", " ", "0.002"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmax", " ", "=", " ", 
   RowBox[{"0.002", " ", 
    RowBox[{"endTime", " ", "/", " ", "isp"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0", " ", "=", " ", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.939729075467511*^9, 3.939729090183818*^9}, {
   3.939729138983253*^9, 3.939729139543161*^9}, {3.9397292348611517`*^9, 
   3.939729237195491*^9}, {3.939729323950099*^9, 3.93972934790425*^9}, {
   3.939729660214937*^9, 3.939729676619982*^9}, {3.939737839158016*^9, 
   3.939737839509756*^9}, {3.939738549786147*^9, 3.939738552562326*^9}, 
   3.939738625622373*^9, {3.9397386951289682`*^9, 3.93973873118929*^9}, {
   3.9397392512854977`*^9, 3.9397392538625917`*^9}, {3.939761178561426*^9, 
   3.939761182755658*^9}, {3.940466730474791*^9, 3.940466744077626*^9}, {
   3.940466818699069*^9, 3.940466827182488*^9}, 3.940613656762583*^9, {
   3.941384875453857*^9, 3.941384892738882*^9}, {3.941385642170479*^9, 
   3.94138569071126*^9}, {3.941385751912437*^9, 3.941385761937057*^9}, {
   3.941469405037835*^9, 3.941469447239739*^9}, {3.941470775129786*^9, 
   3.941470779597411*^9}, {3.9416491697295313`*^9, 3.941649170272429*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"20668259-929e-459d-a9c0-39decda84ec0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", "initialGuess"}], " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"initCostatesThrust", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"initCostatesThrust", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "}"}]}], "]"}]}], "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getReachablePoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "/", " ", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"1", " ", "/", " ", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", " ", "endTime", ",", 
     " ", "tmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",", " ", "1",
      ",", " ", "isp"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"getReachablePoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", " ", "/", " ", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"1", "/", " ", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", " ", "endTime", ",", 
     " ", "tmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",", " ", 
     "0.1", ",", " ", "isp"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.939729075467511*^9, 3.939729090183818*^9}, {
   3.939729138983253*^9, 3.939729139543161*^9}, {3.9397292348611517`*^9, 
   3.939729237195491*^9}, {3.939729323950099*^9, 3.93972934790425*^9}, {
   3.939729660214937*^9, 3.939729719042933*^9}, {3.939738416266756*^9, 
   3.93973844299537*^9}, 3.939738543055036*^9, 3.9397389303462543`*^9, {
   3.939739240976721*^9, 3.9397392413056726`*^9}, 3.9397570884800034`*^9, {
   3.939757612077632*^9, 3.939757620060237*^9}, {3.939757737452137*^9, 
   3.9397577489179373`*^9}, {3.939757797291477*^9, 3.939757815430519*^9}, {
   3.939757864256872*^9, 3.939757916465268*^9}, {3.939757946768558*^9, 
   3.939757974776003*^9}, {3.939758113250658*^9, 3.93975811756773*^9}, {
   3.939758150003708*^9, 3.9397583269847727`*^9}, {3.939758505015449*^9, 
   3.939758565543474*^9}, {3.939758661804023*^9, 3.9397586980118027`*^9}, {
   3.939758797576786*^9, 3.939758871319851*^9}, {3.939758974930644*^9, 
   3.93975901821981*^9}, {3.939759221685601*^9, 3.9397592837046432`*^9}, 
   3.939759386576572*^9, {3.939759421296691*^9, 3.93975942389439*^9}, {
   3.939759610548588*^9, 3.939759621672731*^9}, {3.939759826233289*^9, 
   3.939759856227509*^9}, {3.939760843415382*^9, 3.9397608575072517`*^9}, {
   3.939760890442287*^9, 3.939760928309763*^9}, {3.9397609603258257`*^9, 
   3.939760966863152*^9}, {3.939761020603758*^9, 3.939761103643282*^9}, {
   3.939761190655878*^9, 3.939761261863969*^9}, {3.939761438671773*^9, 
   3.939761503553495*^9}, {3.939761679588667*^9, 3.939761755064048*^9}, {
   3.939761799999823*^9, 3.939761855217486*^9}, {3.939761906563386*^9, 
   3.9397619089308043`*^9}, {3.9397619674677343`*^9, 
   3.9397619940652437`*^9}, {3.93976212962716*^9, 3.9397622011866407`*^9}, {
   3.93976249264699*^9, 3.93976250137424*^9}, {3.939762532417913*^9, 
   3.9397625602172318`*^9}, 3.939762665441477*^9, {3.9397626997940073`*^9, 
   3.939762699981741*^9}, 3.939762812628365*^9, {3.939762848319805*^9, 
   3.93976284836231*^9}, {3.9397640770199833`*^9, 3.939764077522215*^9}, {
   3.9397642186010027`*^9, 3.9397642188928556`*^9}, {3.939764404568946*^9, 
   3.9397644047407503`*^9}, {3.939764512679119*^9, 3.939764543320496*^9}, {
   3.939770919605859*^9, 3.939770941567371*^9}, {3.939771033918585*^9, 
   3.939771055490781*^9}, {3.9397710937199497`*^9, 3.939771104549624*^9}, {
   3.939771430916444*^9, 3.939771453526251*^9}, {3.939771506729141*^9, 
   3.9397716418557262`*^9}, {3.9397716834004602`*^9, 3.939771685002586*^9}, {
   3.939771748509059*^9, 3.939771806393593*^9}, {3.939771873465105*^9, 
   3.939771880494814*^9}, {3.939771929486685*^9, 3.939771962404767*^9}, {
   3.939772711930896*^9, 3.939772733346726*^9}, {3.939772851912313*^9, 
   3.9397728537028418`*^9}, {3.9397733444900217`*^9, 
   3.9397733477289352`*^9}, {3.939773380959621*^9, 3.939773388093281*^9}, {
   3.9397734418293657`*^9, 3.9397734582064943`*^9}, {3.9397738282291517`*^9, 
   3.939773828289253*^9}, {3.939774248663314*^9, 3.9397742715690002`*^9}, {
   3.939815521016803*^9, 3.939815537378039*^9}, {3.939815718777688*^9, 
   3.9398157358044157`*^9}, {3.9404669063752213`*^9, 3.940466920396575*^9}, {
   3.940466953388885*^9, 3.940466953471829*^9}, {3.940467005389265*^9, 
   3.940467005461338*^9}, {3.940467059634787*^9, 3.9404670732039003`*^9}, {
   3.940467141342338*^9, 3.9404671681199408`*^9}, {3.940543683394458*^9, 
   3.940543728541346*^9}, {3.940543778910768*^9, 3.940543817010187*^9}, {
   3.9405439843841*^9, 3.9405440176531467`*^9}, {3.940544048570425*^9, 
   3.94054406607654*^9}, {3.9405442836639*^9, 3.940544377970763*^9}, 
   3.94054443274932*^9, {3.9405449443530807`*^9, 3.940544971110506*^9}, {
   3.9405450012658157`*^9, 3.940545003806862*^9}, {3.9405451230792503`*^9, 
   3.940545150706637*^9}, {3.940545241365925*^9, 3.940545248755528*^9}, {
   3.941469176774226*^9, 3.941469197482995*^9}, {3.941469267424321*^9, 
   3.941469282095491*^9}, {3.941469470034775*^9, 3.941469472947503*^9}, {
   3.94146951000039*^9, 3.941469515217811*^9}, {3.941469587235593*^9, 
   3.941469588490575*^9}, {3.941469679905534*^9, 3.941469680190628*^9}, {
   3.9414697532017603`*^9, 3.941469773354639*^9}, {3.941470009473846*^9, 
   3.941470010457008*^9}, {3.941470139384735*^9, 3.941470156618341*^9}, {
   3.9416497029658937`*^9, 3.941649703632071*^9}, {3.9416499538742867`*^9, 
   3.941649955535117*^9}, {3.941650055498291*^9, 3.941650144092914*^9}, {
   3.941922767570146*^9, 3.941922786428556*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"36c3b5ff-916a-40e8-8d84-d282379bc1ba"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    21, 1, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820781957041*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"312ace63-2b3d-4531-b2b6-e768f3995d07"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    21, 2, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820782244772*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"2ae7cdb0-fe74-42e0-85b1-7bb839b2df6d"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    21, 3, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820782269207*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"08b7dd31-880a-461d-9741-f3c88b47ccfa"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Solve\\\", \\\"::\\\", \
\\\"svars\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 21, 4, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820782273529*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"2c5196f6-4e32-4284-afb7-3b354f5d5328"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7018.786681727873`"}], ",", 
   RowBox[{"-", "7018.786683299839`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.943820051238839*^9, 3.9438202228209057`*^9, 3.943820313690823*^9, {
   3.943820398018362*^9, 3.943820408593824*^9}, 3.9438207823343973`*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"1995b8bf-6990-47a0-a7e2-f703e1852a7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7018.786681727873`"}], ",", 
   RowBox[{"-", "7018.786683299839`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.943820051255686*^9, 3.943820222837304*^9, 3.9438203136926327`*^9, {
   3.943820398031806*^9, 3.943820408594533*^9}, 3.943820782353106*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"f701fec7-d9d2-4fd5-8c7d-757acebf66e8"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    22, 5, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820783804922*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"45fe2be0-e3e1-4d75-8ba9-ccb39924bdf5"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    22, 6, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784006892*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"8ffe19b0-ad12-4b08-b511-46950d8a4f86"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    22, 7, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784011223*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"9d6d6021-9000-4a6f-af40-821320e0091f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Solve\\\", \\\"::\\\", \
\\\"svars\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 22, 8, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784013604*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"c0932f12-acae-4d24-9ba5-55723797ceb1"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 22, 9, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784114036*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"41ebd4c3-b6c7-42ef-8e16-f2483a3b31cf"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 22, 10, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.94382078411693*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"d224c2f0-172c-4a08-b5c8-8e4ab1f7edf2"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 22, 11, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784119343*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"3e36750c-5992-4732-9756-f1ac0aa5b79f"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"InterpolatingFunction\\\
\", \\\"::\\\", \\\"dmval\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 22, 12, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784121746*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"fdd0fa38-99a2-4295-b641-a81addd9fd5a"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 22, 13, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943815863472258*^9, 3.9438159396867228`*^9, 3.943816060719812*^9, 
   3.943819136130868*^9, 3.9438191861192503`*^9, 3.9438194260926447`*^9, 
   3.943819588393651*^9, 3.9438196477189407`*^9, 3.9438197258650837`*^9, 
   3.943819797729888*^9, {3.9438200388686743`*^9, 3.9438200508541117`*^9}, 
   3.943820222437593*^9, 3.943820313316668*^9, {3.943820397638068*^9, 
   3.943820408305956*^9}, 3.943820784423695*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"4e2b37bb-ad17-4e47-876f-27dbc662eb53"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1011.9612996074522`"}], ",", 
   RowBox[{"-", "1011.9611954803497`"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.943820051238839*^9, 3.9438202228209057`*^9, 3.943820313690823*^9, {
   3.943820398018362*^9, 3.943820408593824*^9}, 3.943820784427977*^9},
 CellLabel->
  "During evaluation of \
In[21]:=",ExpressionUUID->"d5563dad-ed10-40a7-b236-8d56c3814e63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1011.9612996074522`"}], ",", 
   RowBox[{"-", "1011.9611954803497`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.943820051255686*^9, 3.943820222837304*^9, 3.9438203136926327`*^9, {
   3.943820398031806*^9, 3.943820408594533*^9}, 3.9438207844286423`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"b323c19d-5f17-41fb-841a-7aa2afb4f549"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "plots", " ", "the", " ", "thrust", " ", "or", " ", "fuel", " ", 
    "limited", " ", "reachable", " ", "set", " ", "alone"}], "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"plotthrustfuel", "[", 
      RowBox[{
      "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", 
       ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", "isp_", ",", " ", 
       "num_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deltas", " ", "=", " ", 
         RowBox[{"CirclePoints", "[", "num", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"endTimes", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"endTime", ",", " ", "num"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmaxs", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"thrustmax", ",", " ", "num"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ns", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"n", ",", " ", "num"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m0s", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"m0", ",", " ", "num"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"As", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"A", ",", " ", "num"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"percents", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"fuelpercent", ",", " ", "num"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"isps", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"isp", ",", " ", "num"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "[", "isps", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testbounds", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{"getReachablePoint", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "deltas", ",", " ", "endTimes", ",", " ", "tmaxs", ",", " ", "ns",
              ",", " ", "m0s", ",", " ", "As", ",", " ", "percents", ",", " ",
              "isps"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "testbounds", "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"flipTransformation", "=", 
         RowBox[{"ReflectionTransform", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"plot", " ", "=", "  ", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"GeometricTransformation", "[", 
               RowBox[{
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Point", "[", 
                   RowBox[{"testbounds", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", " ", 
                    RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}],
                   ",", "flipTransformation"}], "]"}], ",", 
                RowBox[{"ScalingTransform", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}],
               "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
             RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
             RowBox[{
             "PlotLabel", " ", "->", " ", 
              "\"\<Energy Reachable and Thrust Limited RRS\>\""}], ",", " ", 
             RowBox[{"AxesLabel", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<y\>\"", ",", " ", "\"\<x\>\""}], "}"}]}]}], "]"}],
            ",", " ", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\""}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<RRSttt``.png\>\"", ",", " ", "endTime"}], "]"}], " ",
            "//", " ", "ToString"}], ",", " ", "plot"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotenergythrustfuel", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "A_", ",", " ", "fuelpercent_", ",", " ", "isp_", ",", " ", 
      "quadform_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax1length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], 
              "^", "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], 
              "^", "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"deltas", " ", "=", " ", 
        RowBox[{"CirclePoints", "[", "10", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"endTimes", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"endTime", ",", " ", "10"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tmaxs", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"tmax", ",", " ", "10"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ns", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"n", ",", " ", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m0s", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"m0", ",", " ", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"As", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"A", ",", " ", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"percents", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"fuelpercent", ",", " ", "10"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"isps", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"isp", ",", " ", "10"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"getReachablePoint", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "deltas", ",", " ", "endTimes", ",", " ", "tmaxs", ",", " ", "ns", 
            ",", " ", "m0s", ",", " ", "As", ",", " ", "percents", ",", " ", 
            "isps"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"teststats", " ", "=", " ", 
        RowBox[{"reachablestatsoperator", "[", 
         RowBox[{"testbounds", ",", "ax1", ",", "ax2"}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"ax1length", ",", " ", "ax2length"}], " ", 
                    "}"}]}], "]"}], ",", " ", 
                   RowBox[{"RotationTransform", "[", 
                    RowBox[{"ax1", " ", "//", " ", "vectoangle"}], "]"}]}], 
                  "]"}], ",", " ", "flipTransformation"}], "]"}], ",", " ", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Point", "[", 
                  RowBox[{"testbounds", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", " ", 
                    RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}],
                  ",", "flipTransformation"}], "]"}], ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", " ", 
             "\"\<Energy Reachable and Thrust Limited RRS\>\""}], ",", " ", 
            RowBox[{"PlotLegends", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Energy Limited\>\"", ",", " ", "\"\<Thrust Limited\>\"", 
               ",", " ", "\"\<Maximum Ratio\>\"", ",", " ", 
               "\"\<Minimum Ratio\>\""}], " ", "}"}]}], ",", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y\>\"", ",", " ", "\"\<x\>\""}], "}"}]}]}], "]"}], 
          ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\""}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<RRSttt``.png\>\"", ",", " ", "terminaltime"}], "]"}], 
          " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.940545475974537*^9, 3.9405455144909067`*^9}, {
   3.94054644889688*^9, 3.940546482197057*^9}, {3.940546582544568*^9, 
   3.940546696308799*^9}, {3.9405467557336683`*^9, 3.940546791172244*^9}, 
   3.940546956236534*^9, {3.9405469986845303`*^9, 3.9405470360351067`*^9}, {
   3.94054731323728*^9, 3.9405473398908243`*^9}, {3.94054737852822*^9, 
   3.9405474401617527`*^9}, 3.9405475100669937`*^9, {3.940548053108667*^9, 
   3.9405480867685843`*^9}, {3.940548148264907*^9, 3.9405481574884243`*^9}, {
   3.9405484596821623`*^9, 3.940548503410819*^9}, {3.940548553960794*^9, 
   3.940548591657934*^9}, {3.94054863414614*^9, 3.9405486367799873`*^9}, {
   3.940548670833288*^9, 3.940548678704708*^9}, {3.941385678489656*^9, 
   3.94138568218368*^9}, {3.94138579128703*^9, 3.9413857916209307`*^9}, {
   3.9413862013643847`*^9, 3.941386202095677*^9}, {3.941387901422639*^9, 
   3.941387901489688*^9}, {3.941470240157777*^9, 3.941470241940666*^9}, 
   3.941649189236442*^9, {3.941923844328608*^9, 3.941923855888772*^9}, {
   3.941923900410643*^9, 3.941923994276842*^9}, {3.941924902915393*^9, 
   3.941924916793366*^9}, {3.941927625592629*^9, 3.941927638113119*^9}, {
   3.941927924939714*^9, 3.9419279266348124`*^9}, {3.941928844587256*^9, 
   3.941928921655033*^9}, {3.941929260200131*^9, 3.941929382922906*^9}, {
   3.94192943843006*^9, 3.941929442942153*^9}, {3.94381565045715*^9, 
   3.943815685055113*^9}, {3.94381978305285*^9, 3.9438197938553658`*^9}, {
   3.943820012106776*^9, 3.943820032466467*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8b5b8702-adf8-4749-b91d-2b81d2d5f094"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu1", " ", "=", " ", 
   RowBox[{"3.986", " ", 
    RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", "3600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mu1", " ", "/", " ", 
      RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
       " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", 
       "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", 
       RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isp", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax", " ", "=", " ", "0.002"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fuelpercent", " ", "=", " ", "0.6"}], ";"}]}], "Input",
 CellChangeTimes->{{3.94054679843462*^9, 3.940546886995098*^9}, {
  3.940547075805558*^9, 3.940547075857524*^9}, {3.940547121689823*^9, 
  3.9405471251769733`*^9}, {3.9405475225104094`*^9, 3.940547582206544*^9}, {
  3.9405478073051*^9, 3.940547891886931*^9}, {3.940547949521173*^9, 
  3.940547965651803*^9}, {3.940548323068399*^9, 3.94054833415143*^9}, {
  3.941385824499892*^9, 3.941385825144237*^9}, {3.941386182500462*^9, 
  3.941386182910057*^9}, {3.941389267628182*^9, 3.941389286539604*^9}, {
  3.941389601147933*^9, 3.941389603370103*^9}, {3.941389838137951*^9, 
  3.9413898387921543`*^9}, {3.9414702167692537`*^9, 3.94147021735351*^9}, {
  3.941470497827619*^9, 3.941470497957759*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"d513c419-6579-41fa-a137-2fc3ab03f38d"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.9413875202518797`*^9, {3.941387551055583*^9, 3.941387576303935*^9}, {
   3.941387630291091*^9, 3.941387682784707*^9}, {3.9413878819391108`*^9, 
   3.941387961563304*^9}, {3.941388000268013*^9, 3.941388000611863*^9}, {
   3.94138808211195*^9, 3.94138808919916*^9}, {3.941388258785308*^9, 
   3.9413882948947363`*^9}, {3.941388578411167*^9, 3.941388579998085*^9}, {
   3.94138862346801*^9, 3.941388676110384*^9}, {3.941388723268598*^9, 
   3.941388749798339*^9}, {3.941388828169697*^9, 3.941388835099101*^9}, 
   3.941388878196147*^9, {3.941388917049328*^9, 3.941388928598549*^9}, {
   3.941468189573832*^9, 3.9414683388709507`*^9}, {3.941468394554309*^9, 
   3.941468422613408*^9}, 3.941468562615348*^9, {3.941649312222785*^9, 
   3.941649313026412*^9}, {3.941923626195459*^9, 3.941923645189638*^9}, {
   3.941923814830471*^9, 3.941923834840003*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"347315eb-5952-4dac-82ae-ee97e068074b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plotthrustfuel", "[", 
  RowBox[{
  "tmax", ",", "n", ",", " ", "endTime", ",", " ", "m0", ",", " ", "A", ",", 
   " ", "fuelpercent", ",", " ", "isp", ",", " ", "200"}], "]"}]], "Input",
 CellChangeTimes->{{3.9413879865416803`*^9, 3.94138801754471*^9}, {
   3.941388297036381*^9, 3.941388330380043*^9}, {3.941649303732328*^9, 
   3.941649305426667*^9}, {3.9419238609458437`*^9, 3.94192386295807*^9}, {
   3.943820042110806*^9, 3.9438200424244328`*^9}, 3.943820217771263*^9, {
   3.9438203982002*^9, 3.943820399674673*^9}, {3.943820777058454*^9, 
   3.943820777175585*^9}, {3.943820846458878*^9, 
   3.943820847400077*^9}},ExpressionUUID->"5fd21741-2040-4f47-8267-\
e40639170c70"],

Cell[BoxData[
 RowBox[{"{", "900", "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438207845114326`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"cf70ad03-22da-4a34-a6f8-b13915502119"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    35, 14, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.9438207855854797`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b4cbacdd-0b16-49b1-bfc3-99152b8cbfd1"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    35, 15, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785798502*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d90287c2-b4d8-4391-9558-1ed19d2db429"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    35, 16, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785810339*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"6245d313-83be-4f21-89e2-b6d2d2a07143"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Solve\\\", \\\"::\\\", \
\\\"svars\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 35, 17, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785815208*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bee13995-ac6c-4a66-9a5f-64ba77913f3a"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 35, 18, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785897934*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"66983df0-a3b8-45c8-94cc-5914841cb97b"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 35, 19, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785900639*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"35d00da1-b4e2-4af5-959f-08614b48d075"],

Cell[BoxData[
 TemplateBox[{
  "InterpolatingFunction", "dmval", 
   "\"Input value \\!\\(\\*RowBox[{\\\"{\\\", \\\"3600\\\", \\\"}\\\"}]\\) \
lies outside the range of data in the interpolating function. Extrapolation \
will be used.\"", 2, 35, 20, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785902918*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4e7ea81e-fc9d-45a0-9d9e-0ddf7736205b"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"InterpolatingFunction\\\
\", \\\"::\\\", \\\"dmval\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 35, 21, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820785906365*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c63cac67-af05-4d62-bdee-311321a94419"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 22, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.9438207859490967`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d4c9c597-9cf3-476c-a2b5-c4ff662d023d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "51.65851474604866`"}], ",", "14799.014204976307`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438207859530687`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ac59ff4a-f685-482b-ba17-5502a3673702"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "156.59412314511238`"}], ",", "14953.090634554523`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.94382078732918*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"dbc7bc27-7243-415c-9950-9cc94d0ae3aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "263.7372404318476`"}], ",", "15109.496384427264`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438207886979027`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"327ac4f5-4871-475d-b7e8-c9158c99cbe7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "373.14832166405483`"}], ",", "15268.26346609713`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820790076077*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"dee98b29-284c-4b26-b22a-1d3c768ba84c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "484.889135398951`"}], ",", "15429.4224686417`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820791480389*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"44660682-9a60-47b5-8eb3-a8318e516438"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "599.0227164471851`"}], ",", "15593.00207166378`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820792819399*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"45ec345c-97dc-429d-a5b8-225efb7f3e62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "715.6133593774967`"}], ",", "15759.029879655678`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820794197606*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8b371b9b-f76e-44e4-9be7-236782868260"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 23, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820795656996*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"04aceea0-7147-4169-a58c-1653febadf14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "834.7265237002564`"}], ",", "15927.530895089556`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438207956604853`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e7866fdb-af8e-4305-8a56-87a71e90db62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "956.4287419962577`"}], ",", "16098.527110441852`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438207975738277`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d38cc0ab-88b1-46ee-8b7c-63ad20e418e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1080.7876304559018`"}], ",", "16272.038888121488`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820798966798*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bb4d322a-41d2-48cb-a33a-567cb1d76e94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1207.871719145443`"}], ",", "16448.083095682025`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.94382080034461*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3e1d88b4-6d2c-48ea-bdba-667be0b29db4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1337.7503692687742`"}], ",", "16626.67328627542`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208017091084`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4c47bf1b-086c-4962-8d20-ecd3c3884b4f"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 24, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.9438208031337357`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"581498e4-f955-48d1-bf5d-f85cb3bbddfa"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \
\\\"::\\\", \\\"lstol\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 35, 25, 31080385215654194323, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.943816064028392*^9, 3.9438191393052*^9, 3.943819189149138*^9, 
   3.943819429166767*^9, 3.943819591435203*^9, 3.943819650689562*^9, 
   3.943819728972856*^9, 3.943819800788067*^9, 3.9438200544779463`*^9, 
   3.9438202260480556`*^9, 3.943820316996167*^9, {3.943820401251417*^9, 
   3.94382041133718*^9}, 3.943820803137465*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8970e2a4-f4e9-438b-8345-d10f30a0e2ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1470.4935559891062`"}], ",", "16807.81825663224`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820803139914*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f87d0242-537f-4032-a5cc-7b1c815a0276"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1606.1721554702021`"}], ",", "16991.52694156613`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820804592133*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"1a8fbd26-0313-4085-b0e3-537db7e18e83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1744.857033102786`"}], ",", "17177.797086094193`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820806047031*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"56f0e66e-f97b-4b0f-a0b3-752b2240099f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1886.6194026596734`"}], ",", "17366.626419675835`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208075586452`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b82c2b72-ea3e-46f0-8974-6a5364423b40"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2031.530438909172`"}], ",", "17558.004542964314`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820808949862*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f1c5535e-9a5f-4881-9673-9c2afe2446bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2179.661258783055`"}], ",", "17751.9161101475`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820810404891*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"6b9e2859-08e6-436e-80aa-797b6e36a6f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2331.0821490363433`"}], ",", "17948.338342074556`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820811762875*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"670cc014-30d8-4e22-83c4-c873d3e57683"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2485.8629240084497`"}], ",", "18147.24190813863`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208132200212`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"13b0bf95-d90f-4ab2-b5b6-3b3c2ee27351"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2644.0722828685693`"}], ",", "18348.59046371499`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820814701247*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"0eac4cc8-807d-4056-bc5c-6377a60ce793"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2805.7774589975547`"}], ",", "18552.338881790958`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820816073542*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c6dcd0c3-8a02-4c66-bad1-4a7e07e9d743"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2973.283127166156`"}], ",", "18772.570842200574`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208179074373`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9aa19754-5007-4a9a-9f1a-fdf6d8305491"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3139.9327448725867`"}], ",", "18966.796171859143`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208193358994`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"be20e236-6b92-4f25-9bba-f7631c34ab51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3312.5063410220146`"}], ",", "19177.366293958316`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208207334642`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"668a8f80-aa04-4ea0-93d5-e4dcd9934171"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3488.8209664806777`"}], ",", "19390.051711971104`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820822167666*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e29022c3-e026-4cfa-a1cb-d6c2620b3ca9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3668.929844865759`"}], ",", "19604.7532461696`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820823583848*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e46031e0-5431-4bdf-bdf1-c68ff66d9034"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3852.8818420210923`"}], ",", "19821.358753460852`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820825048993*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"425a14fd-8d4f-4b3c-a835-ea782e3317bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4040.7208400748577`"}], ",", "20039.7422965315`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820826420514*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b98778b6-2769-47bc-a573-d1cf462edc01"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4232.485177085482`"}], ",", "20259.76382405518`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.9438208277721024`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"827bc2f5-9026-442b-aeb6-abe366c552c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4428.206762565591`"}], ",", "20481.26744023993`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820829196928*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f2218c50-137e-4cd3-a163-900f07386631"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4627.91060031154`"}], ",", "20704.081862282357`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820830658908*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"16cfd2dc-82e2-4799-941a-98b84294fd83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4831.613701983401`"}], ",", "20928.01818399729`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820832009742*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7e4549be-3d54-4c8e-83a6-8e10d0cf3d5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5039.32467001909`"}], ",", "21152.870889248832`"}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.943816056254883*^9, 3.943816062902237*^9}, 
   3.943819138161146*^9, 3.9438191880575323`*^9, 3.943819428087284*^9, 
   3.943819590346013*^9, 3.943819649635458*^9, 3.943819727883422*^9, 
   3.943819799733615*^9, 3.9438200534027863`*^9, 3.9438202249722137`*^9, 
   3.943820315852717*^9, {3.943820400162189*^9, 3.9438204102791758`*^9}, 
   3.943820833371409*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"45048275-d9d1-4268-8740-b6682f5c3aa3"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.941390726295014*^9, 3.9413907455483027`*^9}, {
   3.941390792464863*^9, 3.9413908068631067`*^9}, {3.941390874671982*^9, 
   3.941390946986927*^9}, {3.941390992261529*^9, 3.941391053923119*^9}, {
   3.94139148345782*^9, 3.941391489194717*^9}, {3.9413916370814323`*^9, 
   3.941391640090476*^9}, {3.941391768456985*^9, 3.941391770623742*^9}, {
   3.941650017594261*^9, 3.9416500213563557`*^9}, 3.9419293151817427`*^9},
 CellLabel->
  "In[306]:=",ExpressionUUID->"ffb84391-493c-4148-bd96-c25035f7905d"]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 28}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"166d5a90-ee36-4b27-b7ba-6d70161916cb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 81509, 1913, 3532, "Input",ExpressionUUID->"9f53022a-d697-437e-951e-509984f201a5"],
Cell[82070, 1935, 3088, 71, 199, "Input",ExpressionUUID->"20668259-929e-459d-a9c0-39decda84ec0"],
Cell[CellGroupData[{
Cell[85183, 2010, 5898, 97, 178, "Input",ExpressionUUID->"36c3b5ff-916a-40e8-8d84-d282379bc1ba"],
Cell[91084, 2109, 752, 15, 28, "Message",ExpressionUUID->"312ace63-2b3d-4531-b2b6-e768f3995d07"],
Cell[91839, 2126, 752, 15, 28, "Message",ExpressionUUID->"2ae7cdb0-fe74-42e0-85b1-7bb839b2df6d"],
Cell[92594, 2143, 752, 15, 28, "Message",ExpressionUUID->"08b7dd31-880a-461d-9741-f3c88b47ccfa"],
Cell[93349, 2160, 843, 16, 28, "Message",ExpressionUUID->"2c5196f6-4e32-4284-afb7-3b354f5d5328"],
Cell[94195, 2178, 414, 10, 24, "Print",ExpressionUUID->"1995b8bf-6990-47a0-a7e2-f703e1852a7f"],
Cell[94612, 2190, 387, 8, 34, "Output",ExpressionUUID->"f701fec7-d9d2-4fd5-8c7d-757acebf66e8"],
Cell[95002, 2200, 752, 15, 28, "Message",ExpressionUUID->"45fe2be0-e3e1-4d75-8ba9-ccb39924bdf5"],
Cell[95757, 2217, 752, 15, 28, "Message",ExpressionUUID->"8ffe19b0-ad12-4b08-b511-46950d8a4f86"],
Cell[96512, 2234, 752, 15, 28, "Message",ExpressionUUID->"9d6d6021-9000-4a6f-af40-821320e0091f"],
Cell[97267, 2251, 843, 16, 28, "Message",ExpressionUUID->"c0932f12-acae-4d24-9ba5-55723797ceb1"],
Cell[98113, 2269, 861, 16, 28, "Message",ExpressionUUID->"41ebd4c3-b6c7-42ef-8e16-f2483a3b31cf"],
Cell[98977, 2287, 861, 16, 28, "Message",ExpressionUUID->"d224c2f0-172c-4a08-b5c8-8e4ab1f7edf2"],
Cell[99841, 2305, 862, 16, 28, "Message",ExpressionUUID->"3e36750c-5992-4732-9756-f1ac0aa5b79f"],
Cell[100706, 2323, 860, 16, 28, "Message",ExpressionUUID->"fdd0fa38-99a2-4295-b641-a81addd9fd5a"],
Cell[101569, 2341, 990, 18, 46, "Message",ExpressionUUID->"4e2b37bb-ad17-4e47-876f-27dbc662eb53"],
Cell[102562, 2361, 414, 10, 24, "Print",ExpressionUUID->"d5563dad-ed10-40a7-b236-8d56c3814e63"],
Cell[102979, 2373, 391, 8, 34, "Output",ExpressionUUID->"b323c19d-5f17-41fb-841a-7aa2afb4f549"]
}, Open  ]],
Cell[103385, 2384, 22877, 516, 1312, "Input",ExpressionUUID->"8b5b8702-adf8-4749-b91d-2b81d2d5f094"],
Cell[126265, 2902, 2770, 65, 199, "Input",ExpressionUUID->"d513c419-6579-41fa-a137-2fc3ab03f38d"],
Cell[129038, 2969, 998, 14, 52, "Input",ExpressionUUID->"347315eb-5952-4dac-82ae-ee97e068074b"],
Cell[CellGroupData[{
Cell[130061, 2987, 704, 12, 30, "Input",ExpressionUUID->"5fd21741-2040-4f47-8267-e40639170c70"],
Cell[130768, 3001, 540, 10, 24, "Print",ExpressionUUID->"cf70ad03-22da-4a34-a6f8-b13915502119"],
Cell[131311, 3013, 670, 14, 28, "Message",ExpressionUUID->"b4cbacdd-0b16-49b1-bfc3-99152b8cbfd1"],
Cell[131984, 3029, 668, 14, 28, "Message",ExpressionUUID->"d90287c2-b4d8-4391-9558-1ed19d2db429"],
Cell[132655, 3045, 668, 14, 28, "Message",ExpressionUUID->"6245d313-83be-4f21-89e2-b6d2d2a07143"],
Cell[133326, 3061, 759, 15, 28, "Message",ExpressionUUID->"bee13995-ac6c-4a66-9a5f-64ba77913f3a"],
Cell[134088, 3078, 777, 15, 28, "Message",ExpressionUUID->"66983df0-a3b8-45c8-94cc-5914841cb97b"],
Cell[134868, 3095, 777, 15, 28, "Message",ExpressionUUID->"35d00da1-b4e2-4af5-959f-08614b48d075"],
Cell[135648, 3112, 777, 15, 28, "Message",ExpressionUUID->"4e7ea81e-fc9d-45a0-9d9e-0ddf7736205b"],
Cell[136428, 3129, 775, 15, 28, "Message",ExpressionUUID->"c63cac67-af05-4d62-bdee-311321a94419"],
Cell[137206, 3146, 907, 17, 46, "Message",ExpressionUUID->"d4c9c597-9cf3-476c-a2b5-c4ff662d023d"],
Cell[CellGroupData[{
Cell[138138, 3167, 618, 13, 24, "Print",ExpressionUUID->"ac59ff4a-f685-482b-ba17-5502a3673702"],
Cell[138759, 3182, 616, 13, 24, "Print",ExpressionUUID->"dbc7bc27-7243-415c-9950-9cc94d0ae3aa"],
Cell[139378, 3197, 618, 13, 24, "Print",ExpressionUUID->"327ac4f5-4871-475d-b7e8-c9158c99cbe7"],
Cell[139999, 3212, 616, 13, 24, "Print",ExpressionUUID->"dee98b29-284c-4b26-b22a-1d3c768ba84c"],
Cell[140618, 3227, 613, 13, 24, "Print",ExpressionUUID->"44660682-9a60-47b5-8eb3-a8318e516438"],
Cell[141234, 3242, 615, 13, 24, "Print",ExpressionUUID->"45ec345c-97dc-429d-a5b8-225efb7f3e62"],
Cell[141852, 3257, 616, 13, 24, "Print",ExpressionUUID->"8b371b9b-f76e-44e4-9be7-236782868260"]
}, Open  ]],
Cell[142483, 3273, 905, 17, 46, "Message",ExpressionUUID->"04aceea0-7147-4169-a58c-1653febadf14"],
Cell[CellGroupData[{
Cell[143413, 3294, 618, 13, 24, "Print",ExpressionUUID->"e7866fdb-af8e-4305-8a56-87a71e90db62"],
Cell[144034, 3309, 618, 13, 24, "Print",ExpressionUUID->"d38cc0ab-88b1-46ee-8b7c-63ad20e418e7"],
Cell[144655, 3324, 617, 13, 24, "Print",ExpressionUUID->"bb4d322a-41d2-48cb-a33a-567cb1d76e94"],
Cell[145275, 3339, 615, 13, 24, "Print",ExpressionUUID->"3e1d88b4-6d2c-48ea-bdba-667be0b29db4"],
Cell[145893, 3354, 618, 13, 24, "Print",ExpressionUUID->"4c47bf1b-086c-4962-8d20-ecd3c3884b4f"]
}, Open  ]],
Cell[146526, 3370, 907, 17, 46, "Message",ExpressionUUID->"581498e4-f955-48d1-bf5d-f85cb3bbddfa"],
Cell[147436, 3389, 762, 15, 28, "Message",ExpressionUUID->"8970e2a4-f4e9-438b-8345-d10f30a0e2ed"],
Cell[CellGroupData[{
Cell[148223, 3408, 616, 13, 24, "Print",ExpressionUUID->"f87d0242-537f-4032-a5cc-7b1c815a0276"],
Cell[148842, 3423, 616, 13, 24, "Print",ExpressionUUID->"1a8fbd26-0313-4085-b0e3-537db7e18e83"],
Cell[149461, 3438, 616, 13, 24, "Print",ExpressionUUID->"56f0e66e-f97b-4b0f-a0b3-752b2240099f"],
Cell[150080, 3453, 619, 13, 24, "Print",ExpressionUUID->"b82c2b72-ea3e-46f0-8974-6a5364423b40"],
Cell[150702, 3468, 616, 13, 24, "Print",ExpressionUUID->"f1c5535e-9a5f-4881-9673-9c2afe2446bd"],
Cell[151321, 3483, 614, 13, 24, "Print",ExpressionUUID->"6b9e2859-08e6-436e-80aa-797b6e36a6f3"],
Cell[151938, 3498, 617, 13, 24, "Print",ExpressionUUID->"670cc014-30d8-4e22-83c4-c873d3e57683"],
Cell[152558, 3513, 618, 13, 24, "Print",ExpressionUUID->"13b0bf95-d90f-4ab2-b5b6-3b3c2ee27351"],
Cell[153179, 3528, 616, 13, 24, "Print",ExpressionUUID->"0eac4cc8-807d-4056-bc5c-6377a60ce793"],
Cell[153798, 3543, 617, 13, 24, "Print",ExpressionUUID->"c6dcd0c3-8a02-4c66-bad1-4a7e07e9d743"],
Cell[154418, 3558, 618, 13, 24, "Print",ExpressionUUID->"9aa19754-5007-4a9a-9f1a-fdf6d8305491"],
Cell[155039, 3573, 619, 13, 24, "Print",ExpressionUUID->"be20e236-6b92-4f25-9bba-f7631c34ab51"],
Cell[155661, 3588, 619, 13, 24, "Print",ExpressionUUID->"668a8f80-aa04-4ea0-93d5-e4dcd9934171"],
Cell[156283, 3603, 617, 13, 24, "Print",ExpressionUUID->"e29022c3-e026-4cfa-a1cb-d6c2620b3ca9"],
Cell[156903, 3618, 614, 13, 24, "Print",ExpressionUUID->"e46031e0-5431-4bdf-bdf1-c68ff66d9034"],
Cell[157520, 3633, 617, 13, 24, "Print",ExpressionUUID->"425a14fd-8d4f-4b3c-a835-ea782e3317bc"],
Cell[158140, 3648, 615, 13, 24, "Print",ExpressionUUID->"b98778b6-2769-47bc-a573-d1cf462edc01"],
Cell[158758, 3663, 617, 13, 24, "Print",ExpressionUUID->"827bc2f5-9026-442b-aeb6-abe366c552c4"],
Cell[159378, 3678, 615, 13, 24, "Print",ExpressionUUID->"f2218c50-137e-4cd3-a163-900f07386631"],
Cell[159996, 3693, 615, 13, 24, "Print",ExpressionUUID->"16cfd2dc-82e2-4799-941a-98b84294fd83"],
Cell[160614, 3708, 615, 13, 24, "Print",ExpressionUUID->"7e4549be-3d54-4c8e-83a6-8e10d0cf3d5d"],
Cell[161232, 3723, 615, 13, 24, "Print",ExpressionUUID->"45048275-d9d1-4268-8740-b6682f5c3aa3"]
}, Open  ]]
}, Open  ]],
Cell[161874, 3740, 548, 8, 30, "Input",ExpressionUUID->"ffb84391-493c-4148-bd96-c25035f7905d"]
}
]
*)

