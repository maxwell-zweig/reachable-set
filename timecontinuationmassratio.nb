(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    323675,       7446]
NotebookOptionsPosition[    306258,       7245]
NotebookOutlinePosition[    306658,       7261]
CellTagsIndexPosition[    306615,       7258]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "This", " ", "is", " ", "code", " ", "modified", " ", 
    "specifically", " ", "for", " ", "the", " ", "2", "d", " ", "case"}], " ",
    "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "the", " ", "directory", " ", "that", " ", "you", " ",
     "want", " ", "your", " ", "plots", " ", "to", " ", "go", " ", "to", " ", 
    "here"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "\"\</users/maxzweig/fuelthrust\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Solve", "::", "svars"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "lstol"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vectoangle", "[", "k_", "]"}], " ", ":=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"k", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "axes", " ", "for", " ", "the", " ", 
     "energy", " ", "limited", " ", "reachable", " ", "set", " ", 
     "associated", " ", "with", " ", "a", " ", "given", " ", "terminal", " ", 
     "time", " ", "and", " ", "thrust"}], " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAxes", "[", 
     RowBox[{"terminaltime_", ",", " ", "quadform_", ",", " ", "thrustmax_"}],
      "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ax1", ",", "ax2"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "minimum", " ", "and", " ", "maximum", 
     " ", "ratios", " ", "between", " ", "an", " ", "energy", " ", "limited", 
     " ", "set", " ", "and", " ", "an", " ", "arbitrary", " ", "reachable", " ",
      "set", " ", "given", " ", "as", " ", "set", " ", "of", " ", "points"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reachablestatsoperator", "[", 
      RowBox[{"points_", ",", "axis1_", ",", "axis2_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "[", "points", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"points", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ellipseVecFromUnitVec", "[", 
          RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
           "uv"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ratio", "[", "pos_", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"ellipseVecFromUnitVec", "[", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", "axis1", ",",
              " ", "axis2"}], "]"}], " ", "]"}], "/", " ", 
          RowBox[{"Norm", "[", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminrat", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Max"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Min"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminvec", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Max"}]}], "    ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}], " ", ",", " ", 
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Min"}]}], "   ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rats", " ", "=", " ", 
         RowBox[{"maxminrat", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vecs", " ", "=", " ", 
         RowBox[{"maxminvec", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rats", " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", " ", 
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}]}]}],
       "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "computes", " ", "minimum", " ", "and", " ", "maximum", " ", "ratios", " ",
       "between", " ", "the", " ", "thrust", " ", "limited", " ", "and", " ", 
      
      RowBox[{"thrust", "/", "fuel"}], " ", "limited", " ", "reachable", " ", 
      "sets"}], ",", " ", 
     RowBox[{
     "given", " ", "as", " ", "a", " ", "set", " ", "of", " ", "points", " ", 
      "that", " ", "are", " ", "indexed", " ", "by", " ", "angle", " ", "in", 
      " ", "their", " ", 
      RowBox[{"arrays", ".", "\[IndentingNewLine]", "Assuming"}], " ", 
      "given", " ", "points", " ", "are", " ", "angle", " ", 
      RowBox[{"aligned", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"thrustfuelstats", "[", 
      RowBox[{"thrustpoints_", ",", " ", "fuelpoints_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListRatios", "[", 
          RowBox[{"list1_", ",", " ", "list2_"}], "]"}], " ", ":=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"list1", ",", "list2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ratios", " ", "=", " ", 
         RowBox[{"ListRatios", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "thrustpoints"}], "]"}], ",", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "fuelpoints"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Min"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "maxratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "minratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "maxpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "minpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
          "minpos"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"energyform", "[", 
      RowBox[{"tff_", ",", " ", "na_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c", ",", " ", "r", ",", " ", "sig", ",", " ", "gamma", ",", " ", 
         "nmat"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "n_", "]"}], " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{
              RowBox[{"-", "2"}], "*", " ", "n"}], ",", " ", "0", ",", " ", 
             "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", " ", "*", " ", "n"}], ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "0", " ", ",",
              " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", "0", ",", 
             "0"}], " ", "}"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", 
             "0"}], " ", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", " ", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "MatrixForm"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t_", ",", " ", "h_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"72", " ", "t", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"h", " ", "t"}], "]"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"154", " ", "h", " ", "t"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["h", "3"], " ", 
                 SuperscriptBox["t", "3"]}], "-", 
                RowBox[{"384", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                RowBox[{"27", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
               RowBox[{"4", " ", "h"}]]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "t", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"2", " ", "h", " ", "t"}], "+", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
              RowBox[{"4", " ", "h"}]], ",", "0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"26", " ", "h", " ", "t"}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              RowBox[{"4", " ", 
               SuperscriptBox["h", "3"]}]], ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"14", " ", "h", " ", "t"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "h", " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
               RowBox[{"4", " ", 
                SuperscriptBox["h", "3"]}]]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t", ",", " ", "n"}], "]"}], " ", "//", " ", "MatrixForm"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sig", "[", 
          RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "-", 
              RowBox[{"3", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"], ",", 
             FractionBox[
              RowBox[{"2", "-", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}]}], "n"], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "n"}], " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "1", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], "n"], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "t"}], "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", " ", "n", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", 
             RowBox[{"2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "0", ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}]}], "}"}]}], "}"}]}], ";", " ", 
        RowBox[{"(*", " ", "Good", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"t_", ",", " ", "t0_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"sig", "[", 
           RowBox[{"t", ",", " ", "n"}], "]"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sig", "[", 
             RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nmat", "[", 
          RowBox[{"t0_", ",", " ", "tf_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sig", "[", 
                RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
               "Inverse"}], ",", " ", 
              RowBox[{
               RowBox[{"-", " ", 
                RowBox[{"sig", "[", 
                 RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
               "Inverse"}], ",", " ", "2"}], "]"}], " ", "//", " ", 
            "Transpose"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "Transpose"}], 
           ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"tf", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}], ".", 
          RowBox[{"c", "[", "n", "]"}], ".", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sig", "[", 
              RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
             "Inverse"}], ",", " ", 
            RowBox[{
             RowBox[{"-", " ", 
              RowBox[{"sig", "[", 
               RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
             "Inverse"}], ",", " ", "2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nmat", "[", 
         RowBox[{"0", ",", " ", "tff", ",", " ", "na"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getFinalEnergyPos", "[", 
      RowBox[{
      "tt_", ",", " ", "tmax_", ",", " ", "nt_", ",", " ", "delta_", ",", " ",
        "rho_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "6", "]"}], " ", "-", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",",
             " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis", " ", "=", " ", 
         RowBox[{"Orthogonalize", "[", "udd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"projmat", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
            RowBox[{"basis", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;"}], "]"}], "]"}]}], "]"}], " ", "//", " ", 
          "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"projmatT", " ", "=", " ", 
         RowBox[{"projmat", " ", "//", " ", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"selectionMat", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eformxf", " ", "=", " ", 
         RowBox[{
          RowBox[{"energyform", "[", 
           RowBox[{"tt", ",", " ", "nt"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"7", ";;", "12"}], ",", " ", 
            RowBox[{"7", ";;", "12"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ydir", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eigenvectors", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projmatT", ".", "selectionMat", ".", "projmat"}], ",", 
             " ", 
             RowBox[{"projmatT", ".", "eformxf", ".", "projmat"}]}], "}"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"projmat", ".", "ydir"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmag", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tt", " ", "rho", " ", 
            RowBox[{
             RowBox[{"tmax", "^", "2"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{"xdir", ".", "eformxf", ".", "xdir"}], ")"}]}]}], ")"}],
           " ", "//", " ", "Sqrt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xdir", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"delta", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", "0"}], ",", 
           " ", 
           RowBox[{"-", "xdir"}], ",", " ", "xdir"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<energy computation executed\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "tmag"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], ",",
      " ", 
     RowBox[{
     "just", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
      "correct", " ", "mass", " ", "costate", " ", "is", " ", "calculated", " ",
       "ahead", " ", "of", " ", "time"}]}], " ", "**)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostatev2", "[", 
     RowBox[{
     "ics_", ",", " ", "isp_", ",", " ", "tf_", ",", " ", "tmax_", ",", " ", 
      "A_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", ",",
           "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", 
          ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"(*", "-", "*)"}], 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"switchingfunc", "[", 
                 RowBox[{
                 "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                   " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
               "2"}]}], ")"}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{"(*", 
           RowBox[{"(", "-", ")"}], "*)"}], 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", "/",
            " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", "  ", 
        RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], "\[Equal]",
               "ics"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "vars", ",",
           "  ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tf", ",", " ", "tf"}], "}"}], ",", " ", 
          RowBox[{"Method", " ", "->", " ", "\"\<BDF\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "tf", "]"}], "&"}], "/@", "soln"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], ",",
      " ", 
     RowBox[{
     "just", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
      "correct", " ", "mass", " ", "costate", " ", "is", " ", "calculated", " ",
       "ahead", " ", "of", " ", "time"}]}], " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostateRecoder", "[", 
     RowBox[{
     "ics_", ",", " ", "isp_", ",", " ", "tf_", ",", " ", "tmax_", ",", " ", 
      "A_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", ",",
           "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", 
          ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"(*", "-", "*)"}], 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"switchingfunc", "[", 
                 RowBox[{
                 "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                   " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
               "2"}]}], ")"}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{"(*", 
           RowBox[{"(", "-", ")"}], "*)"}], 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", "/",
            " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"switches", " ", "=", "  ", 
        RowBox[{"Reap", "[", 
         RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
               RowBox[{"(", 
                RowBox[{"dyn", "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"vars", "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], 
               "\[Equal]", "ics"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "vars", ",", "  ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "tf"}], "}"}], ",", " ", 
           RowBox[{"Method", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<EventLocator\>\"", ",", " ", 
              RowBox[{"\"\<Event\>\"", " ", "->", " ", 
               RowBox[{"switchingfunc", "[", 
                RowBox[{
                 RowBox[{"lxv", "[", "t", "]"}], ",", " ", 
                 RowBox[{"lyv", "[", "t", "]"}], ",", " ", 
                 RowBox[{"lzv", "[", "t", "]"}], " ", ",", " ", 
                 RowBox[{"lm", "[", "t", "]"}], ",", " ", 
                 RowBox[{"m", "[", "t", "]"}], ",", " ", "isp"}], "]"}]}], ",",
               " ", 
              RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
               RowBox[{"Sow", "[", "t", "]"}]}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "switches"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], ",",
      " ", 
     RowBox[{
     "just", " ", "compute", " ", "the", " ", "initial", " ", "guess", " ", 
      "for", " ", "the", " ", "magnitude", " ", "ratio", " ", "given", " ", 
      "the", " ", "output", " ", "of", " ", "this", " ", "function"}]}], " ", 
    "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findInitialCostates", "[", 
     RowBox[{
     "icRel_", ",", " ", "fcRel_", ",", " ", "n_", ",", " ", "A_", ",", " ", 
      "td_", ",", " ", "mmax_", ",", " ", "m0_", ",", " ", "tmax_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "-", 
         " ", 
         RowBox[{"{", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{
          "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
           "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getInitCostates", "[", 
         RowBox[{"varMat_", ",", "icsRel_", ",", "fcsRel_"}], "]"}], ":=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{"varMat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "6"}], ",", 
             RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], ",", 
          RowBox[{"fcsRel", "-", 
           RowBox[{
            RowBox[{"varMat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "6"}], ",", 
               RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], ".", "icsRel"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"topLeftMatrix", "=", "A"}], ";", "\[IndentingNewLine]", 
       RowBox[{"topRightMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleRightMatrix", "=", 
        RowBox[{"-", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"bottomRightMatrix", "=", 
        RowBox[{
         RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bottomLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"A", ",", " ", 
            RowBox[{"Join", "[", " ", 
             RowBox[{"topRightMatrix", ",", " ", 
              RowBox[{"Join", "[", 
               RowBox[{
               "middleLeftMatrix", ",", " ", "middleRightMatrix", ",", " ", 
                "2"}], "]"}]}], "]"}], ",", " ", "2"}], "]"}], ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
           "bottomLeftMatrix", ",", " ", "bottomRightMatrix", ",", " ", "2"}],
            " ", "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stm", "[", "tf_", "]"}], " ", ":=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"fullmatrix", " ", "tf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initCo", " ", "=", " ", 
        RowBox[{"getInitCostates", "[", 
         RowBox[{
          RowBox[{"stm", "[", "td", "]"}], ",", " ", "icRel", ",", " ", 
          "fcRel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lambdastm", "[", "ta_", "]"}], " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}], ")"}], " ", 
          "ta"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lma", " ", "=", " ", 
        RowBox[{
         RowBox[{"isp", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lambdastm", "[", 
                 RowBox[{"mmax", " ", 
                  RowBox[{"isp", " ", "/", " ", "tmax"}]}], "]"}], ".", 
                "initCo"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "6"}], "]"}], "]"}], "   ", "//", " ", 
             "Norm"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"m0", " ", "-", " ", "mmax"}], ")"}]}]}], " ", "-", " ", 
         RowBox[{"NIntegrate", "[", "  ", 
          RowBox[{
           RowBox[{"tmax", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"lambdastm", "[", "t", "]"}], ".", "initCo"}], 
                  ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], " ", "//", 
               " ", "Norm"}], ")"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m0", " ", "-", " ", 
                 RowBox[{"tmax", " ", 
                  RowBox[{"t", " ", "/", " ", "isp"}]}]}], ")"}], " ", "^", 
               "2"}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", 
             RowBox[{"mmax", " ", 
              RowBox[{"isp", " ", "/", " ", "tmax"}]}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initCoM", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"initCo", ",", " ", 
          RowBox[{"{", "lma", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "initCoM"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfind", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", 
      "tm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
          "timeLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ly", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cons", "[", 
         RowBox[{
         "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_"}], "]"}],
         " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"udd", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-",
              " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", 
              RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"udd", ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c2", " ", "=", "  ", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"timeLength", " ", 
                RowBox[{"tm", " ", "/", " ", "isp"}]}], "<=", "mmax"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m0", " ", "-", " ", 
                   RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                 RowBox[{"timeLength", " ", 
                  RowBox[{"tm", " ", "/", " ", "isp"}]}]}], ")"}], "}"}], ",",
               " ", 
              RowBox[{"{", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m0", " ", "-", " ", 
                   RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                 "mmax"}], ")"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
            "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", "ly", ",", 
                    " ", "0"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", "ly"}]}], "}"}]}]}], " ", "]"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ly"}], "}"}], 
                    " ", "//", " ", "Norm"}], ")"}]}]}], "}"}]}], "]"}]}], 
               "]"}], ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "  ", 
               RowBox[{
                RowBox[{"init", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"init", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "ly"}], "}"}], 
                  "   ", "//", " ", "Norm"}], ")"}]}]}], "}"}]}], " ", "}"}], 
           "}"}], ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "->", "20"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", "ly", ",", " ", 
         RowBox[{
          RowBox[{"poss", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2", ",", " ", "2"}], "]"}], "]"}], " ", "*",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"poss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",",
               " ", "ly"}], "}"}], " ", "//", " ", "Norm"}], ")"}]}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "modified", " ", "for", " ", "mass", " ", "ratio"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindalt2", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", 
      "tm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
          "timeLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lx", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cons", "[", 
         RowBox[{
         "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_"}], "]"}],
         " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"udd", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-",
              " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", 
              RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"udd", ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c2", " ", "=", "  ", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"timeLength", " ", 
                RowBox[{"tm", " ", "/", " ", "isp"}]}], "<=", "mmax"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                RowBox[{"timeLength", " ", 
                 RowBox[{"tm", " ", "/", " ", "isp"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                "mmax"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
            "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lx", " ", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", "lx"}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], " ", "]"}],
                   ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "lx"}], "}"}], 
                    " ", "//", " ", "Norm"}], ")"}]}]}], "}"}]}], "]"}]}], 
               "]"}], ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"init", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], " ", "/", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"init", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", "lx"}], 
                   "}"}], " ", "//", " ", "Norm"}], ")"}]}]}], "}"}]}], "}"}],
            "}"}], ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "->", "20"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"lx", ",", " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{
          RowBox[{"poss", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2", ",", " ", "2"}], "]"}], "]"}], " ", "*",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"poss", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",",
               " ", "lx"}], "}"}], " ", "//", " ", "Norm"}], ")"}]}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindaug", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "fuelpercent_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{"rootfind", "[", 
         RowBox[{"init", ",", "  ", 
          RowBox[{"tm", " ", "fuelpercent", " ", 
           RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ",", " ", 
          "direction", ",", " ", "A", ",", " ", "m0", ",", " ", "isp", ",", 
          " ", "timeLength", ",", " ", "tm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tm", ",", 
          " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"terminalMass", " ", "=", " ", 
        RowBox[{"m0", " ", "-", " ", 
         RowBox[{"out", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"terminalAngle", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
            " ", 
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",", 
          " ", "10000", ",", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"out", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ", "&&",
             " ", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], "  ",
           "||", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"terminalMass", " ", "/", " ", 
              RowBox[{"(", 
               RowBox[{"tm", " ", "fuelpercent", " ", 
                RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ")"}]}], " ", 
             "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", "-",
              " ", 
             RowBox[{"Mod", "[", 
              RowBox[{"nextAngle", ",", " ", 
               RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ", 
           "0.00125"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"rootfindalt2", "[", 
             RowBox[{"init", ",", "  ", 
              RowBox[{"tm", " ", "fuelpercent", " ", 
               RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ",", " ", 
              "direction", ",", " ", "A", ",", " ", "m0", ",", " ", "isp", ",",
               "timeLength", ",", " ", "tm"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out3", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "timeLength", ",", " ", 
              "tm", ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "res"}], "\[IndentingNewLine]", ")"}], ",", "lxm2"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getReachablePoint", "[", 
     RowBox[{
     "direction_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_", ",",
       " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posf", " ", "=", " ", 
        RowBox[{"getFinalEnergyPos", "[", 
         RowBox[{
         "endTime", ",", " ", "tmax", ",", " ", "n", ",", " ", "direction", ",",
           " ", "fuelpercent"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initCostates", " ", "=", " ", 
        RowBox[{"findInitialCostates", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
           "}"}], ",", " ", "posf", ",", " ", "n", ",", " ", "A", ",", " ", 
          "endTime", ",", " ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",", 
          " ", 
          RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialGuess2", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"initCostates", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<root finding\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{"rootfind", "[", 
         RowBox[{"initialGuess2", ",", "  ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
          RowBox[{"direction", " ", "//", " ", "N"}], ",", " ", "A", ",", " ",
           "m0", ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax", ",",
           " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", "  ", "Norm"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
         "Normalize"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"direction", " ", "//", " ", "N"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "lxm2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveBVPsNested", "[", 
     RowBox[{
     "initialAngle_", ",", " ", "initialGuess_", ",", " ", "endTime_", ",", 
      " ", "tmax_", ",", " ", "n_", ",", " ", "m0_", ",", " ", "A_", ",", " ",
       "fuelpercent_", ",", " ", "isp_", ",", " ", "numPoints_"}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "initialAngle", ",", " ", "\"\< \>\"", ",", "  ", "initialGuess", ",",
          " ", "\"\< \>\"", ",", " ", "endTime", ",", " ", "\"\< \>\"", ",", 
         " ", "tmax", ",", " ", "\"\< \>\"", ",", " ", "n", ",", 
         " ", "\"\< \>\"", ",", " ", "m0", ",", " ", "\"\< \>\"", ",", " ", 
         "A", ",", " ", "\"\< \>\"", ",", " ", "fuelpercent", ",", 
         " ", "\"\< \>\"", ",", " ", "isp", ",", " ", "\"\< \>\"", ",", " ", 
         "numPoints"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevPosition", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{"2", " ", "*", " ", 
              RowBox[{"Pi", " ", "/", " ", "numPoints"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prevCostate", " ", "==", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
              RowBox[{
               RowBox[{"findInitialCostates", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                  "}"}], ",", " ", 
                 RowBox[{"getFinalEnergyPos", "[", 
                  RowBox[{"endTime", ",", " ", "tmax", "  ", 
                   RowBox[{"(*", "*)"}], ",", " ", "n", ",", " ", 
                   "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                 " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                 RowBox[{"tmax", " ", "fuelpercent", " ", 
                  RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0",
                  ",", " ", 
                 RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
               "]"}], ",", " ", "prevCostate"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nextGuess", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lxm2", " ", "=", " ", 
            RowBox[{"rootfind", "[", 
             RowBox[{"nextGuess", ",", "  ", 
              RowBox[{"tmax", " ", "fuelpercent", " ", 
               RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
              "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", "isp",
               ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalMass", " ", "=", " ", 
            RowBox[{"m0", " ", "-", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "retrying", " ", "with", " ", "energy", " ", "optimal", 
             " ", "initial", " ", "guess", " ", "if", " ", "necessary"}], 
            "**)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"nextGuessReturn", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ",
                   "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"nextAngle", ",", " ", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", "<", " ",
                 "0.00125"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"terminalMass", " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                   "-", " ", "1"}], "]"}], " ", "<", " ", "0.01"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "  ", "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rootfind", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"findInitialCostates", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", " ", 
                   RowBox[{"getFinalEnergyPos", "[", 
                    RowBox[{
                    "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ",
                     "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                   " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "m0", ",", " ", 
                   RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
                 "]"}], ",", "  ", 
                RowBox[{"tmax", " ", "fuelpercent", " ", 
                 RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                "isp", ",", " ", "endTime", ",", " ", "tmax"}], " ", "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"out2", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "if", " ", "still", " ", "failure", " ", "to", " ", 
              "perfectly", " ", "satisfy", " ", "constraints"}], ",", " ", 
             RowBox[{
             "retrying", " ", "with", " ", "alternate", " ", "optimization", " ",
               "holding", " ", "x", " ", "constant", " ", "and", " ", 
              "allowing", " ", "changes", " ", "in", " ", "y"}]}], " ", 
            "**)"}], "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ",
                 "&&", " ", 
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], 
              "  ", "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"terminalMass", " ", "/", " ", 
                  RowBox[{"(", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                  "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||",
               " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", 
                 "-", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"nextAngle", ",", " ", 
                   RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ",
                "0.00125"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"res", " ", "=", " ", 
                RowBox[{"rootfindalt2", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], " ", "}"}], ",", "  ", 
                  RowBox[{"tmax", " ", "fuelpercent", " ", 
                   RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                  "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                  "isp", ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"out3", " ", "=", " ", 
                RowBox[{"propStateCostatev2", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                    "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                  "tmax", ",", " ", "A"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nextAngle", ",", " ", "res", " ", ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"{", 
            RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "**)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"initialAngle", ",", " ", "initialGuess", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", " ", "numPoints"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveBVPsNestedAlt", "[", 
     RowBox[{
     "initialGuess_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_",
       ",", " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_", ",", " ", "numPoints_", ",", " ", "lb_", ",", " ", "ub_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "lb", ",", " ", "\"\< \>\"", ",", " ", "ub", ",", " ", "\"\< \>\"", ",",
          "initialGuess", ",", " ", "\"\< \>\"", ",", " ", "endTime", ",", 
         " ", "\"\< \>\"", ",", " ", "tmax", ",", " ", "\"\< \>\"", ",", " ", 
         "n", ",", " ", "\"\< \>\"", ",", " ", "m0", ",", " ", "\"\< \>\"", ",",
          " ", "A", ",", " ", "\"\< \>\"", ",", " ", "fuelpercent", ",", 
         " ", "\"\< \>\"", ",", " ", "isp", ",", " ", "\"\< \>\"", ",", " ", 
         "numPoints"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevPosition", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ub", " ", "-", " ", "lb"}], ")"}], " ", "/", " ", 
              "numPoints"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prevCostate", " ", "==", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
              RowBox[{
               RowBox[{"findInitialCostates", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                  "}"}], ",", " ", 
                 RowBox[{"getFinalEnergyPos", "[", 
                  RowBox[{
                  "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ", 
                   "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                 " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                 RowBox[{"tmax", " ", "fuelpercent", " ", 
                  RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0",
                  ",", " ", 
                 RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
               "]"}], ",", " ", "prevCostate"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nextGuess", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lxm2", " ", "=", " ", 
            RowBox[{"rootfind", "[", 
             RowBox[{"nextGuess", ",", "  ", 
              RowBox[{"tmax", " ", "fuelpercent", " ", 
               RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
              "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", "isp",
               ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalMass", " ", "=", " ", 
            RowBox[{"m0", " ", "-", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "retrying", " ", "with", " ", "energy", " ", "optimal", 
             " ", "initial", " ", "guess", " ", "if", " ", "necessary"}], 
            "**)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"nextGuessReturn", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ",
                   "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"nextAngle", ",", " ", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", "<", " ",
                 "0.00125"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"terminalMass", " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                   "-", " ", "1"}], "]"}], " ", "<", " ", "0.01"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "  ", "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rootfind", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"findInitialCostates", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", " ", 
                   RowBox[{"getFinalEnergyPos", "[", 
                    RowBox[{
                    "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ",
                     "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                   " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "m0", ",", " ", 
                   RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
                 "]"}], ",", "  ", 
                RowBox[{"tmax", " ", "fuelpercent", " ", 
                 RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                "isp", ",", " ", "endTime", ",", " ", "tmax"}], " ", "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"out2", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "if", " ", "still", " ", "failure", " ", "to", " ", 
              "perfectly", " ", "satisfy", " ", "constraints"}], ",", " ", 
             RowBox[{
             "retrying", " ", "with", " ", "alternate", " ", "optimization", " ",
               "holding", " ", "x", " ", "constant", " ", "and", " ", 
              "allowing", " ", "changes", " ", "in", " ", "y"}]}], " ", 
            "**)"}], "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ",
                 "&&", " ", 
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], 
              "  ", "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"terminalMass", " ", "/", " ", 
                  RowBox[{"(", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                  "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||",
               " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", 
                 "-", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"nextAngle", ",", " ", 
                   RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ",
                "0.00125"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"res", " ", "=", " ", 
                RowBox[{"rootfindalt2", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], " ", "}"}], ",", "  ", 
                  RowBox[{"tmax", " ", "fuelpercent", " ", 
                   RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                  "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                  "isp", ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"out3", " ", "=", " ", 
                RowBox[{"propStateCostatev2", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                    "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                  "tmax", ",", " ", "A"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nextAngle", ",", " ", "res", " ", ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"{", 
            RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "**)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"lb", ",", " ", "initialGuess", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", " ", "numPoints"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"energyBVPsNested", "[", 
     RowBox[{
     "initialAngle_", ",", " ", "initialGuess_", ",", " ", "endTime_", ",", 
      " ", "tmax_", ",", " ", "n_", ",", " ", "m0_", ",", " ", "A_", ",", " ",
       "fuelpercent_", ",", " ", "isp_", ",", " ", "numPoints_"}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{"2", " ", "*", " ", 
              RowBox[{"Pi", " ", "/", " ", "numPoints"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "computing", " ", "the", " ", "next", " ", "energy", " ",
              "optimal", " ", "initial", " ", "costate"}], " ", "**)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{
             RowBox[{"findInitialCostates", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", " ", 
               RowBox[{"getFinalEnergyPos", "[", 
                RowBox[{"endTime", ",", " ", "tmax", " ", 
                 RowBox[{"(*", "*)"}], ",", " ", "n", ",", " ", 
                 "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", " ", 
               "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
               RowBox[{"tmax", " ", "fuelpercent", " ", 
                RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",",
                " ", 
               RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
             "nextAngle"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"initialGuess", ",", " ", "initialAngle"}], "}"}], ",", " ",
          "numPoints"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computestats", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "fuelpercent", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds2", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "1", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses2", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs2", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augMessRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses2", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rats", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"addRem", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"rats", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
               ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
         "augRemIndices", ",", " ", "removalIndices", ",", " ", 
          "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
          "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"thrustfuelstats", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeStatsAlt", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "lb_", ",", " ", "ub_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num", ",", " ", 
           "lb", ",", " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds2", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "1", ",", " ", "isp", ",", " ", "num", ",", " ", "lb", ",", 
           " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses2", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs2", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augMessRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses2", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rats", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"addRem", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"rats", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
               ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
         "augRemIndices", ",", " ", "removalIndices", ",", " ", 
          "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
          "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"thrustfuelstats", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeEnergyFuelStats", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "mo_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "quadform_", ",", " ", "lb_", ",", " ", "ub_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num", ",", " ", 
           "lb", ",", " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{"removalIndices", ",", " ", "massRemIndices"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reachablestatsoperator", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", "ax1", ",", "ax2"}], " ",
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeMaxMag", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norms", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", "testxfs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norms", " ", "//", " ", "Max"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "plots", " ", "the", " ", "thrust", " ", "or", " ", "fuel", " ",
      "limited", " ", "reachable", " ", "set", " ", 
     RowBox[{"alone", "."}]}], "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotthrustfuel", "[", 
      RowBox[{
      "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
        " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ",
      ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
              " ", "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
              "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", " ", 
              RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
             " ", "0", ",", " ", 
             RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
             RowBox[{
              RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", 
             RowBox[{"-", 
              RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
             " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testbounds", " ", "=", " ", 
         RowBox[{
          RowBox[{"solveBVPsNested", "[", 
           RowBox[{
            RowBox[{"Pi", "/", "4"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
             " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
             " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testbounds2", " ", "=", " ", 
         RowBox[{
          RowBox[{"solveBVPsNested", "[", 
           RowBox[{
            RowBox[{"Pi", "/", "4"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
             " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
             " ", "1", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "testbounds3"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"solveBVPsNested", "[", 
             RowBox[{
              RowBox[{"Pi", "/", "4"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", 
              ",", " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", 
              "A", ",", " ", "0.775", ",", " ", "isp", ",", " ", "num"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"testbounds4", " ", "=", " ", 
           RowBox[{
            RowBox[{"solveBVPsNested", "[", 
             RowBox[{
              RowBox[{"Pi", "/", "4"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", 
              ",", " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", 
              "A", ",", " ", "0.875", ",", " ", "isp", ",", " ", "num"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", "**)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "code", " ", "to", " ", "compute", " ", "energy", " ", "optimal", " ",
           "costates"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<doing energy costate computation\>\"", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"vals", " ", "=", " ", 
           RowBox[{"energyBVPsNested", "[", 
            RowBox[{
             RowBox[{"Pi", "/", "4"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
              " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", 
             ",", " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"testECostates", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"vals", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"angles", " ", "=", " ", 
           RowBox[{
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"magnitudes", " ", "=", " ", 
           RowBox[{"Norm", " ", "/@", " ", "testECostates"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eangles", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
            "testECostates"}]}], ";"}], "\[IndentingNewLine]", "**)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"testmasses", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testmasses2", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testxfs", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testxfs2", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "testmasses3"}], " ", "=", " ", 
           RowBox[{"testbounds3", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"testmasses4", " ", "=", " ", 
           RowBox[{"testbounds4", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"testxfs3", " ", "=", " ", 
           RowBox[{"testbounds3", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"testxfs4", " ", "=", " ", 
           RowBox[{"testbounds4", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Max", "[", 
          RowBox[{"Norm", " ", "/@", " ", 
           RowBox[{"testxfs", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idxmaxfull", " ", "=", " ", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"Norm", " ", "/@", " ", 
             RowBox[{"testxfs", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxdirfull", " ", "=", " ", 
         RowBox[{"testxfs", "[", 
          RowBox[{"[", 
           RowBox[{"idxmaxfull", ",", " ", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"idxmaxfull2", " ", "=", " ", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"Norm", " ", "/@", " ", 
             RowBox[{"testxfs2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxdirfull2", " ", "=", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", 
           RowBox[{"idxmaxfull2", ",", " ", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"maxdirfull2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"maxdirfull2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", " ", 
         "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"directions", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"directionsfullthrust", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costates", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costatesfullthrust", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"costates", ",", " ", "directions"}], "}"}], " ", ">>", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<costatefuellim``file\>\"", ",", " ", "endTime"}], 
            "]"}], " ", "//", " ", "ToString"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"costatesfullthrust", ",", " ", "directionsfullthrust"}], 
          "}"}], " ", ">>", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<costatefullthrust``file\>\"", ",", " ", "endTime"}], 
            "]"}], " ", "//", " ", "ToString"}], ")"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"costatedirections", " ", "=", " ", 
         RowBox[{"costates", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", 
            RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costatemasses", " ", "=", " ", 
         RowBox[{"costates", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"costateratios", " ", "=", " ", 
         RowBox[{"costatemasses", " ", "/", " ", 
          RowBox[{"(", 
           RowBox[{"Norm", " ", "/@", " ", "costatedirections"}], ")"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"costateangles", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
          "costatedirections"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "directions"}], " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcTan", " ", "@@", " ", "#"}], " ", "&"}], " ", "/@", 
            " ", "directions"}]}], ";"}], "**)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"l1", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"directions", " ", ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{"costateangles", ",", " ", 
                RowBox[{"2", " ", "Pi"}]}], "]"}]}], " ", "}"}], " ", "//", 
            " ", "Transpose"}], ",", " ", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Target Angle (rads)\>\"", 
              ",", "\"\<Initial Angle (rads) \>\""}], "}"}]}]}], " ", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            
            RowBox[{"\"\<costatedirectiongraph``.png\>\"", ",", " ", 
             "endTime"}], "]"}], " ", "//", " ", "ToString"}], ",", "  ", 
          "l1"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l2", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"directions", ",", " ", "costateratios"}], "}"}], " ", "//",
            " ", "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<costateratiograph``.png\>\"", ",", " ", "endTime"}], 
            "]"}], " ", "//", " ", "ToString"}], ",", " ", "l2"}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l3", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", "directions", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<directions``.png\>\"", ",", " ", "endTime"}], "]"}], 
           " ", "//", " ", "ToString"}], ",", " ", "l3"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "l4"}], " ", "=", " ", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"Mod", "[", 
                    RowBox[{"costateangles", ",", " ", 
                    RowBox[{"2", "Pi"}]}], "]"}], "]"}]}], ")"}], " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"costateangles", ",", 
                    RowBox[{"2", "Pi"}]}], "]"}], " ", "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"eangles", ",", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}]}]}], "}"}], 
             " ", "//", " ", "Transpose"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<relerrors``.png\>\"", ",", " ", "endTime"}], "]"}],
              " ", "//", " ", "ToString"}], ",", " ", "l4"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<maximum departure: \>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"Abs", "[", 
                RowBox[{"Mod", "[", 
                 RowBox[{"costateangles", ",", " ", 
                  RowBox[{"2", "Pi"}]}], "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"costateangles", ",", 
                 RowBox[{"2", "Pi"}]}], "]"}], " ", "-", " ", 
               RowBox[{"Mod", "[", 
                RowBox[{"eangles", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}]}], "]"}], "]"}], 
          ";"}], " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"removalIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ",
           "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"augRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ",
           "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"massRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"testmasses", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"#", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                  " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
           " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"augMessRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"testmasses2", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"#", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
           " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"rats", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}],
            ",", " ", 
           RowBox[{"{", 
            RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"addRem", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"rats", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
                ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"remInds", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{
          "augRemIndices", ",", " ", "removalIndices", ",", " ", 
           "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
           "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
           "minpos"}], "}"}], " ", "=", " ", 
         RowBox[{"thrustfuelstats", "[", 
          RowBox[{
           RowBox[{"testxfs", "[", 
            RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
           RowBox[{"testxfs2", "[", 
            RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "maxratio", ",", " ", "\"\< \>\"", ",", " ", "minratio", ",", 
          " ", "\"\< \>\"", ",", " ", 
          RowBox[{"maxpos", " ", "//", " ", "Normalize"}], ",", " ", 
          RowBox[{"minpos", " ", "//", " ", "Normalize"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"testbounds", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"testxfs", ",", " ", "testxfs2"}], 
          RowBox[{"(*", 
           RowBox[{",", " ", "testxfs3", ",", " ", "testxfs4"}], " ", "*)"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"flipTransformation", "=", 
         RowBox[{"ReflectionTransform", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"plot", " ", "=", "  ", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"GeometricTransformation", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"testbounds", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", " ", 
                    RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}],
                 ",", 
                RowBox[{"ScalingTransform", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}],
               "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Green", ",", " ", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"1.1", " ", "0.001", "maxdirfull2"}]}], "}"}], " ",
                  "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Green", ",", " ", 
                RowBox[{"Arrow", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], " ", "0.001", "maxdirfull2"}]}], 
                  "}"}], " ", "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Red", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                  " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
             " ", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Red", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                   "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
              "]"}], ",", " ", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                  " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                   "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
              "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
             RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
             RowBox[{
             "PlotLabel", " ", "->", 
              " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
             RowBox[{"AxesLabel", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
               "}"}]}]}], "]"}], ",", " ", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blue", ",", "Red", ",", " ", "Green"}], "}"}], ",", 
               RowBox[{"{", 
                
                RowBox[{"\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\"",
                  ",", " ", "\"\<Maximum Direction\>\""}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
         "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<RRStttb``.png\>\"", ",", " ", "endTime"}], "]"}], 
           " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "directions", ",", " ", "directionsfullthrust", ",", " ", "costates",
           ",", " ", "costatesfullthrust"}], "}"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotenergyfuel", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "quadform_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", "  ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{"removalIndices", ",", " ", "massRemIndices"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"teststats", " ", "=", " ", 
        RowBox[{"reachablestatsoperator", "[", 
         RowBox[{
          RowBox[{"testxfs", "[", 
           RowBox[{"[", "remInds", "]"}], "]"}], ",", "ax1", ",", "ax2"}], 
         " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "teststats", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"ax1length", ",", " ", "ax2length"}], " ", 
                    "}"}]}], "]"}], ",", " ", 
                   RowBox[{"RotationTransform", "[", 
                    RowBox[{"ax1", " ", "//", " ", "vectoangle"}], "]"}]}], 
                  "]"}], ",", " ", "flipTransformation"}], "]"}], ",", " ", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"Point", "[", 
                RowBox[{"testxfs", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", " ", 
                   RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}], 
               ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Energy and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"PlotLegends", " ", "->", " ", 
             RowBox[{"{", 
              
              RowBox[{"\"\<Energy Limited\>\"", ",", 
               " ", "\"\<Thrust Limited\>\"", ",", 
               " ", "\"\<Maximum Ratio\>\"", ",", 
               " ", "\"\<Minimum Ratio\>\""}], " ", "}"}]}], ",", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", 
                ",", "\"\<Maximum Ratio\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<energyfuel``.png\>\"", ",", " ", "endTime"}], "]"}], 
          " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9522861895468063`*^9, 3.9522861898199377`*^9}, {
   3.952286798273657*^9, 3.952286805975416*^9}, {3.952286921223054*^9, 
   3.952286942661222*^9}, {3.9522871876648893`*^9, 3.9522872082522383`*^9}, 
   3.952287501825296*^9, {3.952290472087657*^9, 3.9522904742648993`*^9}, {
   3.952293106009499*^9, 3.95229312708536*^9}, 3.9522931914741488`*^9, {
   3.9522932230855503`*^9, 3.952293279043066*^9}, {3.952293337820467*^9, 
   3.952293437471656*^9}, {3.9522935394640617`*^9, 3.952293569761074*^9}, {
   3.952293761093302*^9, 3.952293761321594*^9}, {3.952297554298175*^9, 
   3.9522976029996243`*^9}, {3.952342743207121*^9, 3.952342746333531*^9}, {
   3.952342785153657*^9, 3.9523427899516287`*^9}, {3.9523432507805977`*^9, 
   3.9523432698635807`*^9}, {3.952343314283102*^9, 3.9523433249908457`*^9}, {
   3.952343406507234*^9, 3.9523434215335283`*^9}, {3.952345615189752*^9, 
   3.952345631747403*^9}, {3.9523457448751907`*^9, 3.952345768122336*^9}, {
   3.952345808276223*^9, 3.952345838706813*^9}, {3.952346110208201*^9, 
   3.952346111204088*^9}, {3.9523660244985943`*^9, 3.952366200204225*^9}, {
   3.952368366840674*^9, 3.952368440432873*^9}, {3.9523691088083553`*^9, 
   3.952369131110515*^9}, {3.9523692756190166`*^9, 3.952369286930372*^9}, {
   3.952369330354649*^9, 3.952369337097043*^9}, 3.952370958397942*^9, {
   3.952446196219028*^9, 3.952446252933814*^9}, {3.952446547730194*^9, 
   3.952446641024479*^9}, 3.9524470081561937`*^9, {3.952450943497673*^9, 
   3.952450959315556*^9}, {3.952451187021818*^9, 3.952451187712927*^9}, {
   3.9524513196809464`*^9, 3.952451339588367*^9}, {3.952451376100543*^9, 
   3.952451376454232*^9}, {3.9524514295599213`*^9, 3.952451432160314*^9}, {
   3.9524514846863337`*^9, 3.952451522663151*^9}, {3.952451570425283*^9, 
   3.952451616530802*^9}, {3.952451732162011*^9, 3.9524517407852077`*^9}, {
   3.9524518455365877`*^9, 3.952451847153768*^9}, {3.952451882577126*^9, 
   3.952451888223798*^9}, {3.952451965150872*^9, 3.952452016455902*^9}, {
   3.952452969424354*^9, 3.9524529775305767`*^9}, {3.9524530571124477`*^9, 
   3.952453128297728*^9}, {3.952453672666353*^9, 3.952453703392989*^9}, {
   3.9524537911618567`*^9, 3.95245380022731*^9}, {3.952455835430766*^9, 
   3.952455835859663*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5c101b50-c06f-4166-9a70-caa4dcef817c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu1", " ", "=", " ", 
   RowBox[{"3.986", " ", 
    RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", "360"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mu1", " ", "/", " ", 
      RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isp", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmaxval", " ", "=", " ", "0.002"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fuelpercent", " ", "=", "0.675"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[27]:=",ExpressionUUID->"b9423ae2-e811-4fe1-9b31-5a21383bd0ad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"directioncostatemap", " ", "=", " ", 
   RowBox[{"plotthrustfuel", "[", 
    RowBox[{
    "tmaxval", ",", "n", ",", " ", "2350.1", ",", " ", "m0", ",", " ", 
     "fuelpercent", ",", " ", "isp", ",", "  ", "150"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQ/Sbtik9y0VtHVudyXxC9K7S+B0RrhL/oA9E2ef83
geiO3gWbQfQmD0v9FCCtersBTDctU32SBqTtbmmDaYeFa6zTgXTB/zNgWmzf
gioQLZd1sRpE71ujeQJES102AdNTphh9B9FcrJ4/QPSuzcaKmUA6zW8pmL4W
ZB8Kov0eiYaDaBeui1vrgHSAe/Q2ED3laVBYPZD+sjkJTAdkTxRqANICKdfA
9Ka9cgkg+vZrVzD9OvlRcBeQNlOYEw6iXy2qnQii5b2FJoFop3NVR0H0+oAt
YHqFE8MjEG3XKgqmxSSXvAPR1sdS34PoVauSxbpB9m86Caa5ewwO9wBpTdY6
ML0houjeFiC91KfuIYieW3KxfSuQDuFj6ADRO3SucW0DhY9ZPg+IZti6URdE
t+w+D6YBHFjS/Q==
  "],
 CellLabel->"In[35]:=",ExpressionUUID->"59cd509c-5a94-49c5-b826-2fd28b3e5208"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Pi]", "4"], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2350.1`", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0.002`", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "0.0009200242014178264`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "2.5393335935835275`*^-6", ",", "0", ",", "0", ",", "0", ",", 
       "0.0018400484028356528`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.0018400484028356528`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "8.464445311945092`*^-7"}], ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "0.675`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "10000", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "150"}],
  SequenceForm[
  Rational[1, 4] Pi, " ", {0, 0, 0}, " ", 2350.1, " ", 0.002, " ", 
   0.0009200242014178264, " ", 1, 
   " ", {{0, 0, 0, 1, 0, 0}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 1}, {
    2.5393335935835275`*^-6, 0, 0, 0, 0.0018400484028356528`, 0}, {
    0, 0, 0, -0.0018400484028356528`, 0, 0}, {
    0, 0, -8.464445311945092*^-7, 0, 0, 0}}, " ", 0.675, " ", 10000, " ", 150],
  Editable->False]], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566541645412`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"86849084-d60a-4174-946c-4b38a7ab06e7"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456655220171*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4ca879bb-7ff8-4990-ac0d-d6f033bbfe76"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"2.0057653055458684`*^-6\\\", \
\\\",\\\", \\\"5.235765537861751`*^6\\\"}], \\\"}\\\"}]\\). Try perturbing \
the initial point(s).\"", 2, 35, 1, 30846477195321890935, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952456121827011*^9, 3.9524562779218884`*^9, 
  3.952456655542213*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"21df5297-4b10-4561-9d14-0e7ab14c5fd5"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456656969829*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b6ec0625-a689-447a-a1be-4816a45f487b"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"2.0057653055458684`*^-6\\\", \
\\\",\\\", \\\"5.235765537861751`*^6\\\"}], \\\"}\\\"}]\\). Try perturbing \
the initial point(s).\"", 2, 35, 2, 30846477195321890935, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952456121827011*^9, 3.9524562779218884`*^9, 
  3.952456657170952*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bce3ac8a-135d-4698-aaa9-c8970c20d4b8"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.0816918972582107`*^-6\\\"}], \\\",\\\", \
\\\"5.235765537861751`*^6\\\"}], \\\"}\\\"}]\\). Try perturbing the initial \
point(s).\"", 2, 35, 3, 30846477195321890935, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952456121827011*^9, 3.9524562779218884`*^9, 
  3.952456657193697*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c574d82c-b558-401f-be66-adab44fa8af7"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \
\\\"::\\\", \\\"jsing\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 35, 4, 30846477195321890935, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952456121827011*^9, 3.9524562779218884`*^9, 
  3.952456657213078*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b703e70f-d925-41da-be45-632d56cf1d77"],

Cell[CellGroupData[{

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456658367797*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"0615bbb4-8d91-4e9f-afd8-91c7591c95fc"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456659715877*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"15d4d1db-b636-4825-baaa-bcc8ef415e0b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566610679703`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f594ba67-4f32-40a5-8dae-5fd712952761"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456662487032*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3c93a1be-7067-47c3-baf8-be1b97f1ca54"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456663925926*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"fcba923a-7ee6-4ff5-86e7-d4ebce478376"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566652458572`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4f6a2afa-c1c0-4364-bc31-b8ca239d7112"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456666646228*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"91334acd-ef84-4eb2-881b-cc87701419bd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456668021448*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7cea2953-c7b0-4c5b-8470-04315896a1db"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456669329645*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ed784227-56d6-473c-bc18-c95c4be6a4bd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456670671288*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"fa21e0f2-df98-450c-9954-e5f6e5cf96a2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566719637337`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"51f1ba34-d1e9-4b1e-8275-98125f978927"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456673260521*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"de26f03c-5847-4fdc-9c66-2e90794e471a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566745927773`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2690c117-f264-451c-91ea-743441e656c8"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456675905979*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"62cea3d5-c4f3-43bd-b48c-d3a6edcda0d1"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566771967077`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"04bdc561-82e2-4e7a-80e9-e83e4c24cf2b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456678467802*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8e261510-ab7b-4d84-b5d7-cf22d87a5354"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566797259808`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"97fb7c18-2dd3-4aa9-8fb2-c777b4462884"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456681015903*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"492d89f2-86d6-4e54-a6be-00031a7110bd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245668230716*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"59756f8b-a1f3-4896-9f64-d92b65cdd94d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566836046267`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bea6fcca-4955-4023-9513-dc692df79a64"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456684923326*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bfd488fd-170d-4431-b092-454f42a3aa76"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566862064543`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"aa40e0a2-33c8-448b-a3e7-47747ed7cbcc"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566876092243`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3ee30622-96c6-41fc-87d0-5bf384793187"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566889214983`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d672d59d-8ef4-4fc7-9f6f-f2a9394c4749"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524566902093*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d7656c39-a84d-4490-9794-d1a84130515d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456691531986*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"54dfa515-52f7-4d3c-8197-23308b29508d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456692856491*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c94ca8da-a258-4de3-ad40-4e88a7108a65"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456694152955*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"943dda5a-d2ff-416d-af2d-b36228d1bc09"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456695421492*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e7ad8e4b-2798-4836-aded-a6db2c89b136"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456696693994*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7362b163-93d3-467b-afbc-8d7135b2fc5d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456697975401*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"07d321b8-a0e8-4e35-8c47-f92ef5632ceb"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456699242127*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"00764d07-a4d8-4648-9c56-21a621394217"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567005867853`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"5ab69997-660e-423b-938d-229371bc88fd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567019235897`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"0a1811c8-2829-4daa-9947-0d1da9bf234f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567032519703`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"a65a57e3-b7fc-4f47-a1c4-c582d3206487"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456704519086*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ac7550ba-b63a-4a3f-84f0-300ef0bb7612"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456705793684*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c590f372-c590-4673-a3bf-70a8880fdcae"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456707115735*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9fcda884-0d3c-4526-ac68-3e2af20c3925"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567084071693`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c9832be2-a96c-449e-b56d-2d8cb98e8c87"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567097083073`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"82b0e42d-a8bc-4dea-93c6-074662a92fb8"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456711053125*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d9dbe3b6-9f77-4541-9663-4334cfd2b79b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456712387939*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"818f6ea0-6e48-4e5e-9327-16b4a28f5604"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456713718968*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f3e0b4ba-202a-4499-a808-6991dcd0ab8d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456715002022*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"920dce76-b047-415f-ad4f-b6b9680773e1"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456716260454*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bfcbe0e3-5083-4a43-bb19-bc2f0f1f6a94"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456717548574*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e17f2b7f-b0e3-4d82-aa22-1dc2d34df3ad"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567188326273`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ac062bda-7d1e-4e42-a901-361fb951e523"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245672008954*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"81d73814-0cfb-486e-b06e-bb747776b12c"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456721343351*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c6827c90-aeba-4d32-8e34-e308f2f6b74b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245672263654*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c02bba88-c423-449a-87cc-458b215d47e4"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567238848133`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2a52bae0-19ed-4f74-a60e-b9edfdaa03bb"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567251731567`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d83420d4-60dd-4b57-900e-ae9caedb12f5"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456726412252*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"00dd97fb-18d2-4018-865c-dae94ebbadbb"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567277020884`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"34f2f812-bd0b-43b7-a8a7-80ac35ef86f3"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456728963677*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bd203cf9-54bd-4706-beea-443ee001a85a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567302061253`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"23f82e6d-82d0-430d-a00e-771625ebd053"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456731462644*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"cdc7664a-86ac-4eb3-8a8f-744d7160f0ad"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456732723392*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3f82b676-4bc4-490e-811f-3acabfbdb582"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567339895067`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ccceaf79-5853-40d1-9fa7-0c9d521ea0dc"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245673523853*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"eca3310a-36d2-4995-af2a-bfbe6e4417c2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456736493906*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"6a1a045e-beb1-4582-a83c-379bae46fd97"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567377472477`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"861cc22d-491d-4ea8-aeec-d12d66474ea2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456738991692*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"dae53e32-1a9f-4252-b258-94b36a02450a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456740246125*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9523fffa-d247-4c32-bacb-595136878946"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456741497107*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"89bf2d67-39b8-4689-84c1-3f1b59770056"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456742741901*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8cfdb4da-2f9b-4514-8458-b6d0661a6c81"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456743989423*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"379657c7-1201-4800-bc74-ab0368f7b834"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456745298473*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"a23672dd-48c4-4fd8-942a-4b7734ff77cc"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245674658737*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"43b220c6-b4d2-4eac-9068-384c0fb9c199"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456747862253*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9fe2a74d-0930-4db3-99ba-9f4c4861e486"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456749177264*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2ffadc05-1194-49ef-bf79-90167d8921dd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567504749613`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7e5635dc-1dbf-4f6c-b485-b83ca3d46907"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456751775003*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2da5418a-f23f-4316-aa27-cc9e1f244cdf"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567530950823`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9c082caf-e811-43eb-a4b0-5ce889d0789a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456754385635*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4b338ed5-88df-454e-ab43-513c824ddb45"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456755660754*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"61ff2719-e14d-47d6-b897-5ba8bc2851e6"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567569153*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"a50d07b0-98c6-47f2-9119-d5e7cf303671"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456758163063*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9df63ac6-2a4a-4803-a822-9f59c5fd9a41"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456759411108*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"46a285ea-a3cc-44b6-9dcd-2b47df22a49f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567606538477`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"57665223-1e0a-4a42-8d85-24083aa0af32"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456761899839*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d4afe8c9-eb24-4104-afaa-8a0ffa98b006"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567631484823`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"dec52ef2-5b3e-4043-b57b-e795941e2fa6"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567643894367`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3eb40846-bb56-4f61-ab98-79c24b532811"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456765647593*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"87987e1c-090c-4e20-b9e8-e58109f505d5"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567668992023`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"13b8757b-1787-4918-883f-8bb2fa5bada2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456768147874*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"aa67e992-d50a-402c-9fe2-5346d57aab00"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567694340363`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"696e628b-ebdc-4eaf-a052-86f089f0a893"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456770682268*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c3769e2f-4b71-473c-a3c6-1985f6691e85"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456771934833*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3c5b57cb-f1f7-4033-a0ca-dee1abfc3dad"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567731990356`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b28e053b-b2f7-4ac8-bacc-59bd145e5d7d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456774490506*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"1bd3ac34-3015-4d69-85e4-b1856f847289"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456775809031*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"68eb31a0-1002-4dbc-91dd-bd1b7e72d312"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567770990868`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"0275be72-ee97-4223-8561-ad6003950c68"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456778359955*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"cb6e75c5-03da-4443-86a3-643082895d19"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456779682025*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8ac412ab-4275-4a3d-ae4b-a3a0d8f51511"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456780990774*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"51b487ab-c5c0-43ce-bbfc-9d1d179d58f0"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456782274933*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3f6e0aab-2b46-443a-bee5-8b28d03be500"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456783557901*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3d7b111d-d663-444f-8a47-c93e3538e0f6"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456784831336*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bf19bc10-1897-4191-9169-3654d86bbd6d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567861183853`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ebab9512-786a-4d0b-a326-0b1e0b0c2c92"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456787362235*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b73c530b-7925-40b4-aeb8-e99acc086d1f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245678862121*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"35d45994-f2d4-4f22-adbd-d9b0ec20c7a1"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567898922462`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ba56eec3-86a0-4bfc-81a9-df1976ea4a6f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524567912123213`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"68a77f73-1c97-4f8a-8fdc-3ba1b51e5553"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456792524459*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2962ce13-790a-4bcc-ba9a-4029c3aed84f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245679381411*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"fae62976-1a9e-4efd-81b3-783ae6faae43"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456795126668*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"1d4f65d6-9868-4370-96cd-4664a64be0d1"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245679642734*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"5000584c-6fe5-41a7-8f65-9ed06cd9ee89"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456797729792*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2e044383-ae24-4ed0-85cc-5170332c9949"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456799038591*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"533f6c34-a2af-424d-8d59-f93c031b97e4"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456800287696*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"63e0c8f4-86a8-4506-a64c-89ba23791cf2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456801542965*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"10485c7d-b6de-4b66-9af8-975b91649d50"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456802852038*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"a48df2eb-7cfe-40f2-95cb-a73ded29fa7a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456804172214*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"be71dd8b-c61f-4814-9f0a-470d2505c4bd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456805433436*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9a11564f-f12e-48ad-9b86-d5c83c4bd3fd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456806669429*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c8ef5f9d-917b-4ffe-b2b5-73a166f39b9b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568079090357`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"003b4e14-f194-4fe6-8862-03a646d0afa5"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568091838512`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"613a0372-ff68-4444-bae1-31bea8c545a3"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245681043583*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ab3b3e13-db52-4b5d-8d0c-26fa195fbc8d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568116749897`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"aa4f9d02-e7f2-43ec-90ee-ecbf42ca4491"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456812944813*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2a888292-1954-40ad-985c-f8107170e1f3"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456814188263*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"274b52b1-6857-4f9b-bcf9-4da3786eb7ac"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456815475196*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"32c20afd-dc77-4dd4-b9f0-70b36ef57808"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456816755795*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bade3045-42ba-4276-8ce5-c36cefc648b8"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456818062468*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"cc29f9da-bd6d-484b-bc50-6af2df8f0114"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456819336928*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c20d2226-07c4-4519-954f-be6512841e7c"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568206371107`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"4066e670-5132-480a-8466-92079477039b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568218866167`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"21597442-bca9-4328-a92f-f28fa71c7f2d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568231432877`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"479391d9-3ee1-4d59-a2aa-bdf44ed3ba43"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456824415702*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e2b7361c-2e7b-43be-adaf-a0c78bf97cfb"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456825682868*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"a772e97f-b412-45ab-8b30-3420efd6922b"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456826975277*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"3a6e4126-5b26-4964-af4b-29049b65e69a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456828243314*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"96460b01-65cd-4b80-a88a-bf7724c0f4a9"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568295261173`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"880a179b-da89-435f-85a0-4a23fbea48e5"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456830831105*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"11736220-b568-45a1-8125-b3e79742641d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456832104851*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"6ff48e26-e0a5-4c3b-b420-89c6087d9199"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456833392627*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"9f56f06f-6254-41d2-a5a4-96a9e0477d17"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456834717183*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"081703f8-e6bd-466f-adee-0ff4bd015c2a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456835995179*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"5a5e366b-296b-47cc-bc84-eb33ee498db4"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456837257451*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e899c545-be5a-472e-bc83-ac460f0a116a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568385106287`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"bb4ea8bf-263a-426c-a0fc-bc5e9e658ff4"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456839764469*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c8ae720c-3e21-4921-af7e-74e482ae7e83"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568410141783`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"37d4b1b7-2b84-4a94-80b7-469d6fd0e2ba"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456842268227*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"916c4949-d1b5-4aba-a621-d09f8752f9d0"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568435381613`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"8cb2c6a1-4336-4bc9-98b7-514498ec14d9"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456844798965*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"e002f85d-6392-459b-a270-d0878b3947aa"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456846069829*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"663a1143-c4e8-4e1a-8f3d-f25963810413"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456847356187*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d8a7ec04-3ce0-4b1c-95d2-2bf8769cf772"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568486377783`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"b2f01d98-9037-4ad9-a289-427a9c20f686"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Pi]", "4"], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2350.1`", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0.002`", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "0.0009200242014178264`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "2.5393335935835275`*^-6", ",", "0", ",", "0", ",", "0", ",", 
       "0.0018400484028356528`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.0018400484028356528`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "8.464445311945092`*^-7"}], ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "10000", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "150"}],
  SequenceForm[
  Rational[1, 4] Pi, " ", {0, 0, 0}, " ", 2350.1, " ", 0.002, " ", 
   0.0009200242014178264, " ", 1, 
   " ", {{0, 0, 0, 1, 0, 0}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 1}, {
    2.5393335935835275`*^-6, 0, 0, 0, 0.0018400484028356528`, 0}, {
    0, 0, 0, -0.0018400484028356528`, 0, 0}, {
    0, 0, -8.464445311945092*^-7, 0, 0, 0}}, " ", 1, " ", 10000, " ", 150],
  Editable->False]], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568488516397`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f46b7cea-6b62-4f52-a82e-fb5137cdc2cd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456849899588*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c2585315-7b57-489e-960f-a0fba85df635"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456856460251*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"da24df35-5af5-49b2-a0ad-28370341c296"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.9524568591609793`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"828b4505-f44f-45bf-b8fb-839e7bdea09a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245686067665*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"802400d3-2ea0-4930-97e4-0d46682b7150"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456868760262*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"2ddd9627-0f99-425e-bfbe-a95df3e56a9d"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456871749358*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ed5a0a28-cbc1-44b3-9575-17fd2227cc4c"],

Cell[BoxData["9023.18101629419`"], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456874082159*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"ca5bc9d3-e355-4e6a-85ac-e8580ef9dcfc"],

Cell[BoxData[
 RowBox[{"-", "0.7644542300816035`"}]], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.95245687408272*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"1bab48f8-d314-475f-9f1a-c6f888a5cb13"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.9346497295372481`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "0.8743419725455726`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6293203911630455`"}], ",", "0.7771459613652967`"}], 
    "}"}], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9542403285128698`"}], ",", "0.29904079226695884`"}], 
    "}"}]}],
  SequenceForm[
  0.9346497295372481, " ", 0.8743419725455726, " ", {-0.6293203911630455, 
   0.7771459613652967}, {-0.9542403285128698, 0.29904079226695884`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9524561204666967`*^9, 3.9524562765364227`*^9, 
  3.952456874779263*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"11c26bf5-af57-4428-a41b-9be89870fba3"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "precondition", " ", "is", " ", "that", " ", "directions", " ", 
    "are", " ", "lined", " ", "up", " ", "with", " ", "the", " ", "costate", " ",
     "directions"}], "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"computeReachableSet", "[", "paramList_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thrustmax", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
       RowBox[{"endTime", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
       RowBox[{"m0", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", " ", 
       RowBox[{"fuelpercent", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
       RowBox[{"isp", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", " ", 
       RowBox[{"initialAngle", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", 
       RowBox[{"prevFuelLimCostates", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{"prevThrustLimCostates", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ";", " ", 
       RowBox[{"directions", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "10", "]"}], "]"}]}], ";", " ", 
       RowBox[{"jump", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "11", "]"}], "]"}]}], ";", " ", 
       RowBox[{"differences", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "12", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computing Reachable Set: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "endTime", "]"}]}], " ", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"num", " ", "=", " ", 
        RowBox[{"prevFuelLimCostates", " ", "//", " ", "Length"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maximumMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"thrustmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "num"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"unitVectors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], " ", "//", " ", "N"}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], " ", "//", " ", "N"}]}], "}"}], 
          "&"}], "/@", "directions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"As", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"A", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"initialMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"m0", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"isps", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"isp", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"endTimes", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"endTime", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maximumThrusts", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"thrustmax", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fuelPercents", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"fuelpercent", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "fuelLimitedSolutions"}], " ", "=", " ", 
          RowBox[{"MapThread", "[", 
           RowBox[{"rootfind", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"prevFuelLimCostates", " ", "+", " ", "differences"}], ",",
               " ", "maximumMasses", ",", " ", "unitVectors", ",", " ", "As", 
              ",", " ", "initialMasses", ",", " ", "isps", ",", " ", 
              "endTimes", ",", " ", "maximumThrusts"}], "}"}]}], "]"}]}], 
         ";"}], "**)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"propogate", "[", "posxposymCostate_", "]"}], " ", ":=", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "thrustmax",
           ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "newDifferences"}], " ", "=", " ", 
          RowBox[{
          "fuelLimitedSolutions", " ", "-", " ", "prevFuelLimCostates"}]}], 
         ";"}], "**)"}], "\[IndentingNewLine]", 
       RowBox[{"newDiferences", " ", "=", " ", "differences"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"terminalPositions", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"propogate", ",", "prevFuelLimCostates"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costatedirections", " ", "=", " ", 
        RowBox[{"prevFuelLimCostates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costatemasses", " ", "=", " ", 
        RowBox[{"prevFuelLimCostates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costateratios", " ", "=", 
        RowBox[{"costatemasses", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"Norm", " ", "/@", " ", "costatedirections"}], ")"}]}]}], 
       " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"directions", ",", " ", "costateratios"}], "}"}], " ", "//",
            " ", "Transpose"}], ",", " ", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<costateratiograph``.png\>\"", ",", " ", "endTime"}], 
           "]"}], " ", "//", " ", "ToString"}], ",", " ", "l2"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"idxmaxfull", " ", "=", " ", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{
           RowBox[{"Norm", " ", "/@", " ", 
            RowBox[{"terminalPositions", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxdirfull", " ", "=", " ", 
        RowBox[{"terminalPositions", "[", 
         RowBox[{"[", 
          RowBox[{"idxmaxfull", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"maxdirfull", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"maxdirfull", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", " ", "Print"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"Point", "[", "terminalPositions", "]"}], ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"*", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", " ", 
                  RowBox[{"GeometricTransformation", "[", 
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                    " ", "flipTransformation"}], "]"}]}], "}"}], "]"}]}], ",",
               " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Red", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ",", " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                   " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ","}], " ", "**)"}], "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], " ", "0.001", " ", "maxdirfull"}]}], 
                 "}"}], " ", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.1", " ", "0.001", " ", "maxdirfull"}]}], "}"}], 
                " ", "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red", ",", " ", "Green"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\"", 
                ",", " ", "\"\<Maximum Extent\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<RRStimeContinuation``.png\>\"", ",", " ", "endTime"}],
            "]"}], " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thrustmax", ",", " ", "n", ",", " ", "endTime", ",", " ", "m0", ",",
           " ", "fuelpercent", ",", " ", "isp", ",", " ", "initialAngle", ",",
           " ", "prevFuelLimCostates", ",", " ", "prevThrustLimCostates", ",",
           " ", "directions", ",", " ", "jump"}], "}"}], " ", ">>", " ", 
        "savefile"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"thrustmax", ",", " ", "n", ",", " ", 
         RowBox[{"endTime", " ", "+", " ", "jump"}], ",", " ", "m0", ",", " ",
          "fuelpercent", ",", " ", "isp", ",", " ", "initialAngle", ",", " ", 
         "prevFuelLimCostates", ",", " ", "prevThrustLimCostates", ",", " ", 
         "directions", ",", " ", "jump", ",", " ", "newDifferences"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fuelcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefuellim2000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thrustcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefullthrust2000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9522880209577103`*^9, 3.952288037014545*^9}, {
   3.952288068311412*^9, 3.9522881144367657`*^9}, {3.9522881540505123`*^9, 
   3.952288191682602*^9}, {3.952288323779263*^9, 3.952288381503435*^9}, {
   3.952288784393659*^9, 3.95228880228753*^9}, {3.952288855022126*^9, 
   3.9522888561872873`*^9}, {3.952288930505958*^9, 3.952288932543935*^9}, {
   3.952289008138301*^9, 3.9522891497518187`*^9}, {3.952289381163537*^9, 
   3.95228943803729*^9}, {3.952289477224269*^9, 3.952289529499365*^9}, {
   3.952289864752473*^9, 3.9522898853449097`*^9}, {3.9522901159894457`*^9, 
   3.952290218397468*^9}, {3.9522904067142487`*^9, 3.952290427507471*^9}, {
   3.9522905919934*^9, 3.952290596088129*^9}, {3.952290630852507*^9, 
   3.952290735815261*^9}, {3.952290784426085*^9, 3.952290793026219*^9}, {
   3.952290888110683*^9, 3.95229089527392*^9}, {3.952291406548799*^9, 
   3.952291555198368*^9}, {3.952291652880184*^9, 3.952291655311919*^9}, {
   3.952292292192259*^9, 3.952292322937224*^9}, {3.952292374316038*^9, 
   3.952292421307612*^9}, {3.952292473099818*^9, 3.952292473843815*^9}, {
   3.952292513108602*^9, 3.952292513419232*^9}, {3.952292567955101*^9, 
   3.952292568951789*^9}, {3.952292668528916*^9, 3.952292721217382*^9}, {
   3.952293097118329*^9, 3.952293097255875*^9}, {3.9522936074312143`*^9, 
   3.95229362568161*^9}, {3.952294213561569*^9, 3.9522942243044577`*^9}, {
   3.9522942920649757`*^9, 3.95229429290027*^9}, {3.9522943836461887`*^9, 
   3.952294384608068*^9}, {3.9522944436240396`*^9, 3.952294443979075*^9}, {
   3.952294565081211*^9, 3.952294565250753*^9}, {3.9522946503826714`*^9, 
   3.952294651328926*^9}, {3.9522946883620253`*^9, 3.952294692068173*^9}, {
   3.952294827055934*^9, 3.9522948274501953`*^9}, {3.952294881705195*^9, 
   3.952294883160758*^9}, {3.952295494066304*^9, 3.952295494532824*^9}, {
   3.952295858683568*^9, 3.952295870304421*^9}, {3.952296625890299*^9, 
   3.952296628097329*^9}, {3.952296782847414*^9, 3.952296783245479*^9}, {
   3.9522969619430017`*^9, 3.952296963749568*^9}, {3.952297197269865*^9, 
   3.952297201499192*^9}, {3.952298261462221*^9, 3.952298261544767*^9}, {
   3.9522983507932568`*^9, 3.952298375994681*^9}, {3.952336559607387*^9, 
   3.9523365913458652`*^9}, {3.9523423971527243`*^9, 3.95234242779254*^9}, {
   3.952344636608482*^9, 3.952344660144281*^9}, {3.9523447252215548`*^9, 
   3.952344766728669*^9}, {3.9523448414963617`*^9, 3.952344923707151*^9}, {
   3.952344983085744*^9, 3.952344987496492*^9}, {3.952345021645402*^9, 
   3.9523450296760893`*^9}, {3.952345175110808*^9, 3.952345180375543*^9}, {
   3.952345287118848*^9, 3.952345309007676*^9}, {3.9523453591419697`*^9, 
   3.95234542012918*^9}, {3.952345468385557*^9, 3.952345472711546*^9}, 
   3.952345554011647*^9, {3.9523458868403473`*^9, 3.9523459913619013`*^9}, 
   3.9523465150851*^9, {3.952346875079236*^9, 3.952346875562199*^9}, {
   3.952347119232313*^9, 3.952347142244199*^9}, {3.952347203711673*^9, 
   3.9523472377744226`*^9}, {3.95234732715553*^9, 3.952347330236382*^9}, {
   3.952347423971483*^9, 3.9523474524489326`*^9}, {3.952348460341515*^9, 
   3.9523484678544893`*^9}, {3.952348635366069*^9, 3.952348635627324*^9}, {
   3.952349098061326*^9, 3.9523491094621363`*^9}, 3.952349149143415*^9, {
   3.952349257385799*^9, 3.9523492771387043`*^9}, {3.952349330722267*^9, 
   3.9523493332121563`*^9}, 3.952349795815201*^9, {3.952349965127413*^9, 
   3.952349981294567*^9}, {3.952350014954084*^9, 3.9523500668131237`*^9}, {
   3.952350101627121*^9, 3.952350109429283*^9}, {3.952350596129904*^9, 
   3.9523506309329576`*^9}, {3.9523512845531054`*^9, 
   3.9523512861676893`*^9}, {3.952351465026561*^9, 3.952351475323057*^9}, {
   3.952351968530027*^9, 3.952352027218676*^9}, {3.952352490938115*^9, 
   3.952352616273748*^9}, {3.952352659684924*^9, 3.95235265992698*^9}, {
   3.9523527346968193`*^9, 3.952352736281659*^9}, {3.9523527997786913`*^9, 
   3.952352803278008*^9}, {3.952352837396648*^9, 3.95235286333412*^9}, {
   3.952352976047659*^9, 3.952352978480464*^9}, {3.952354024719987*^9, 
   3.952354065419969*^9}, {3.9523541122552834`*^9, 3.9523541145219183`*^9}, {
   3.9523541508930264`*^9, 3.952354160566077*^9}, {3.952354343041465*^9, 
   3.9523543433589897`*^9}, {3.952355761689695*^9, 3.952355768046053*^9}, {
   3.952355820893283*^9, 3.952355910241551*^9}, {3.9523570472218447`*^9, 
   3.952357156138633*^9}, 3.9523572089449883`*^9, {3.952357303543614*^9, 
   3.952357304954321*^9}, {3.952370481961178*^9, 3.952370503608152*^9}, {
   3.952370753138792*^9, 3.952370826154209*^9}, {3.952370984664372*^9, 
   3.9523709967604847`*^9}, {3.952371165634099*^9, 3.952371171340126*^9}, {
   3.952371569718141*^9, 3.9523715844527693`*^9}, {3.952371792895729*^9, 
   3.952371803233783*^9}, {3.952371874761614*^9, 3.9523718749830227`*^9}, {
   3.9523722857302513`*^9, 3.952372288118513*^9}, {3.952372384575038*^9, 
   3.9523723893196163`*^9}, 3.952372467481367*^9, 3.952373068791698*^9, 
   3.952446190567492*^9, {3.95244955343933*^9, 3.952449557435376*^9}, 
   3.952450266717079*^9, {3.952452574515502*^9, 3.9524526464208717`*^9}, {
   3.9524527050535803`*^9, 3.9524527053020287`*^9}, 3.952454303166293*^9, 
   3.952454342601632*^9, {3.9524544559143248`*^9, 3.95245446010045*^9}, 
   3.9524545096929827`*^9, {3.952454547486352*^9, 3.952454557275228*^9}, {
   3.952454823687044*^9, 3.9524548272151737`*^9}, 3.952457007674715*^9, 
   3.952457045729699*^9, 3.9524570995714006`*^9, 3.9524571561499243`*^9, {
   3.952457191342823*^9, 3.9524571966070757`*^9}, {3.952457239877315*^9, 
   3.9524572426270523`*^9}, 3.952457391517375*^9, {3.952474219921863*^9, 
   3.95247422510422*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"b1d81f0c-e233-48f1-91f6-5198c7f2aeab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"computeReachableSet", "[", 
     RowBox[{
     "tmaxval", ",", " ", "n", ",", " ", "2000", ",", " ", "m0", ",", " ", 
      "fuelpercent", ",", " ", "isp", ",", " ", 
      RowBox[{"Pi", "/", "4"}], ",", " ", 
      RowBox[{"fuelcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"thrustcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"fuelcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"computeReachableSet", "[", 
     RowBox[{
     "tmaxval", ",", " ", "n", ",", " ", "2006.25", ",", " ", "m0", ",", 
      "fuelpercent", ",", " ", "isp", ",", " ", 
      RowBox[{"Pi", "/", "4"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "**)"}]}]], "Input",
 CellChangeTimes->{{3.9522880209577103`*^9, 3.952288037014545*^9}, {
   3.952288068311412*^9, 3.9522881144367657`*^9}, {3.9522881540505123`*^9, 
   3.952288191682602*^9}, {3.952288323779263*^9, 3.952288381503435*^9}, {
   3.952288784393659*^9, 3.95228880228753*^9}, {3.952288855022126*^9, 
   3.9522888561872873`*^9}, {3.952288930505958*^9, 3.952288932543935*^9}, {
   3.952289008138301*^9, 3.9522891497518187`*^9}, {3.952289381163537*^9, 
   3.95228943803729*^9}, {3.952289477224269*^9, 3.952289529499365*^9}, {
   3.952289864752473*^9, 3.9522898853449097`*^9}, {3.9522901159894457`*^9, 
   3.952290218397468*^9}, {3.9522904067142487`*^9, 3.952290427507471*^9}, {
   3.9522905919934*^9, 3.952290596088129*^9}, {3.952290630852507*^9, 
   3.952290735815261*^9}, {3.952290784426085*^9, 3.952290793026219*^9}, {
   3.952290888110683*^9, 3.95229089527392*^9}, {3.952291406548799*^9, 
   3.952291555198368*^9}, {3.952291652880184*^9, 3.952291655311919*^9}, {
   3.952292292192259*^9, 3.952292322937224*^9}, {3.952292374316038*^9, 
   3.952292421307612*^9}, {3.952292473099818*^9, 3.952292473843815*^9}, {
   3.952292513108602*^9, 3.952292513419232*^9}, {3.952292567955101*^9, 
   3.952292568951789*^9}, {3.952292668528916*^9, 3.952292721217382*^9}, {
   3.952293097118329*^9, 3.952293097255875*^9}, {3.9522936074312143`*^9, 
   3.95229362568161*^9}, {3.952294213561569*^9, 3.9522942243044577`*^9}, {
   3.9522942920649757`*^9, 3.95229429290027*^9}, {3.9522943836461887`*^9, 
   3.952294384608068*^9}, {3.9522944436240396`*^9, 3.952294443979075*^9}, {
   3.952294565081211*^9, 3.952294565250753*^9}, {3.9522946503826714`*^9, 
   3.952294651328926*^9}, {3.9522946883620253`*^9, 3.952294692068173*^9}, {
   3.952294827055934*^9, 3.9522948274501953`*^9}, {3.952294881705195*^9, 
   3.952294883160758*^9}, {3.952295494066304*^9, 3.952295494532824*^9}, {
   3.952295858683568*^9, 3.952295870304421*^9}, {3.952296625890299*^9, 
   3.952296628097329*^9}, {3.952296782847414*^9, 3.952296783245479*^9}, {
   3.9522969619430017`*^9, 3.952296963749568*^9}, {3.952297197269865*^9, 
   3.952297201499192*^9}, {3.952298261462221*^9, 3.952298261544767*^9}, {
   3.9522983507932568`*^9, 3.952298375994681*^9}, {3.952336559607387*^9, 
   3.9523365913458652`*^9}, {3.9523423971527243`*^9, 3.95234242779254*^9}, {
   3.952344636608482*^9, 3.952344660144281*^9}, {3.9523447252215548`*^9, 
   3.952344766728669*^9}, {3.9523448414963617`*^9, 3.952344923707151*^9}, {
   3.952344983085744*^9, 3.952344987496492*^9}, {3.952345021645402*^9, 
   3.9523450296760893`*^9}, {3.952345175110808*^9, 3.952345180375543*^9}, {
   3.952345287118848*^9, 3.952345309007676*^9}, {3.9523453591419697`*^9, 
   3.95234542012918*^9}, {3.952345468385557*^9, 3.952345472711546*^9}, 
   3.952345554011647*^9, {3.9523458868403473`*^9, 3.9523459913619013`*^9}, 
   3.9523465150851*^9, {3.952346875079236*^9, 3.952346875562199*^9}, 
   3.952347119232313*^9, {3.952348200602413*^9, 3.952348253330611*^9}, {
   3.952348490666931*^9, 3.952348491593961*^9}, {3.952349200994623*^9, 
   3.952349206800358*^9}, {3.9523500768727303`*^9, 3.952350077458045*^9}, {
   3.9523514264313173`*^9, 3.9523514273688602`*^9}, {3.9523520338920507`*^9, 
   3.9523520357535753`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"00acd85e-6837-4f86-a78c-d542ae1b9523"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"NestList", "[", 
    RowBox[{"computeReachableSet", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "tmaxval", ",", " ", "n", ",", " ", "2000", ",", " ", "m0", ",", " ", 
       "fuelpercent", ",", " ", "isp", ",", " ", 
       RowBox[{"Pi", "/", "4"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fuelcostates", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"thrustcostates", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fuelcostates", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], ")"}], "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", "4", ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"indices", " ", "//", " ", "Length"}]}], "]"}]}], "}"}], ",",
      " ", "1000"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.952351380738874*^9, 3.952351453782484*^9}, {
   3.9523514846903067`*^9, 3.952351486209444*^9}, {3.9523518467363157`*^9, 
   3.95235188181328*^9}, {3.9523519124604053`*^9, 3.952351951147526*^9}, {
   3.9523520404380627`*^9, 3.952352041044033*^9}, 3.952352075940588*^9, {
   3.952352271307838*^9, 3.952352271605424*^9}, {3.9523523162527657`*^9, 
   3.952352317397677*^9}, 3.952352349154324*^9, {3.952352412439107*^9, 
   3.952352422048411*^9}, {3.952353961886963*^9, 3.952354017325903*^9}, {
   3.952354380993462*^9, 3.952354405973917*^9}, {3.952354783058887*^9, 
   3.9523547884405603`*^9}, 3.9523551434590282`*^9, {3.952355773082119*^9, 
   3.95235580297904*^9}, 3.952370544735465*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"e0b2fd3c-104a-4d74-9bb4-102f8b9342c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fuelcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefuellim2350file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thrustcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefullthrust2350file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeReachableSet", "[", 
     RowBox[{"{", 
      RowBox[{
      "tmaxval", ",", " ", "n", ",", " ", "2350", ",", " ", "m0", ",", " ", 
       "fuelpercent", ",", " ", "isp", ",", " ", 
       RowBox[{"Pi", "/", "4"}], ",", " ", 
       RowBox[{"fuelcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"thrustcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"fuelcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "4", ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{
          RowBox[{"fuelcostates", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "//", " ", 
          "Length"}]}], "]"}]}], "}"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.952370307556809*^9, 3.952370311350934*^9}, {
   3.952370396633971*^9, 3.952370467338663*^9}, {3.952370535462865*^9, 
   3.952370555559471*^9}, {3.952370638182638*^9, 3.9523706397519836`*^9}, 
   3.952371596057846*^9, {3.952372344035471*^9, 3.952372347642177*^9}, {
   3.952373032830655*^9, 3.952373052443489*^9}, {3.952373134080411*^9, 
   3.952373137906555*^9}, {3.9524495664451227`*^9, 3.952449573788251*^9}, {
   3.952455845850374*^9, 3.952455849198654*^9}, {3.952456946514131*^9, 
   3.9524569588369303`*^9}, {3.952474014885784*^9, 3.952474020091667*^9}, {
   3.952474080563826*^9, 3.952474085877069*^9}, {3.9524742598974323`*^9, 
   3.952474273189752*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"3c0f2fac-a232-4444-bdf5-aaca84f4c5fd"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Computing Reachable Set: 2350\"\>"], "Print",
 CellChangeTimes->{
  3.952474035159532*^9, 3.9524740927260113`*^9, {3.952474230716332*^9, 
   3.9524742746154823`*^9}},
 CellLabel->
  "During evaluation of \
In[62]:=",ExpressionUUID->"63ebe46c-2a4c-48cc-8350-a7329cdcb222"],

Cell[BoxData[
 RowBox[{"-", "0.7853981633974488`"}]], "Print",
 CellChangeTimes->{
  3.952474035159532*^9, 3.9524740927260113`*^9, {3.952474230716332*^9, 
   3.952474276256564*^9}},
 CellLabel->
  "During evaluation of \
In[62]:=",ExpressionUUID->"52df9cfd-79a0-415d-aa26-f458ce8d0b49"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952474038869822*^9, 
  3.952474040115086*^9}},ExpressionUUID->"58a66034-37b5-44ae-af7f-\
8fcc19d9f212"]
},
WindowSize->{Full, Full},
WindowMargins->{{19, Automatic}, {Automatic, 228}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"16cd1baa-a10e-477f-ab21-705869e11ac4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 220444, 5163, 12257, "Input",ExpressionUUID->"5c101b50-c06f-4166-9a70-caa4dcef817c",
 InitializationCell->True],
Cell[221001, 5185, 1006, 26, 188, "Input",ExpressionUUID->"b9423ae2-e811-4fe1-9b31-5a21383bd0ad",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[222032, 5215, 844, 18, 29, "Input",ExpressionUUID->"59cd509c-5a94-49c5-b826-2fd28b3e5208"],
Cell[CellGroupData[{
Cell[222901, 5237, 2180, 47, 55, "Print",ExpressionUUID->"86849084-d60a-4174-946c-4b38a7ab06e7"],
Cell[225084, 5286, 259, 5, 23, "Print",ExpressionUUID->"4ca879bb-7ff8-4990-ac0d-d6f033bbfe76"]
}, Open  ]],
Cell[225358, 5294, 629, 14, 26, "Message",ExpressionUUID->"21df5297-4b10-4561-9d14-0e7ab14c5fd5"],
Cell[225990, 5310, 259, 5, 23, "Print",ExpressionUUID->"b6ec0625-a689-447a-a1be-4816a45f487b"],
Cell[226252, 5317, 629, 14, 26, "Message",ExpressionUUID->"bce3ac8a-135d-4698-aaa9-c8970c20d4b8"],
Cell[226884, 5333, 652, 15, 26, "Message",ExpressionUUID->"c574d82c-b558-401f-be66-adab44fa8af7"],
Cell[227539, 5350, 515, 12, 26, "Message",ExpressionUUID->"b703e70f-d925-41da-be45-632d56cf1d77"],
Cell[CellGroupData[{
Cell[228079, 5366, 259, 5, 23, "Print",ExpressionUUID->"0615bbb4-8d91-4e9f-afd8-91c7591c95fc"],
Cell[228341, 5373, 259, 5, 23, "Print",ExpressionUUID->"15d4d1db-b636-4825-baaa-bcc8ef415e0b"],
Cell[228603, 5380, 261, 5, 23, "Print",ExpressionUUID->"f594ba67-4f32-40a5-8dae-5fd712952761"],
Cell[228867, 5387, 259, 5, 23, "Print",ExpressionUUID->"3c93a1be-7067-47c3-baf8-be1b97f1ca54"],
Cell[229129, 5394, 259, 5, 23, "Print",ExpressionUUID->"fcba923a-7ee6-4ff5-86e7-d4ebce478376"],
Cell[229391, 5401, 261, 5, 23, "Print",ExpressionUUID->"4f6a2afa-c1c0-4364-bc31-b8ca239d7112"],
Cell[229655, 5408, 259, 5, 23, "Print",ExpressionUUID->"91334acd-ef84-4eb2-881b-cc87701419bd"],
Cell[229917, 5415, 259, 5, 23, "Print",ExpressionUUID->"7cea2953-c7b0-4c5b-8470-04315896a1db"],
Cell[230179, 5422, 259, 5, 23, "Print",ExpressionUUID->"ed784227-56d6-473c-bc18-c95c4be6a4bd"],
Cell[230441, 5429, 259, 5, 23, "Print",ExpressionUUID->"fa21e0f2-df98-450c-9954-e5f6e5cf96a2"],
Cell[230703, 5436, 261, 5, 23, "Print",ExpressionUUID->"51f1ba34-d1e9-4b1e-8275-98125f978927"],
Cell[230967, 5443, 259, 5, 23, "Print",ExpressionUUID->"de26f03c-5847-4fdc-9c66-2e90794e471a"],
Cell[231229, 5450, 261, 5, 23, "Print",ExpressionUUID->"2690c117-f264-451c-91ea-743441e656c8"],
Cell[231493, 5457, 259, 5, 23, "Print",ExpressionUUID->"62cea3d5-c4f3-43bd-b48c-d3a6edcda0d1"],
Cell[231755, 5464, 261, 5, 23, "Print",ExpressionUUID->"04bdc561-82e2-4e7a-80e9-e83e4c24cf2b"],
Cell[232019, 5471, 259, 5, 23, "Print",ExpressionUUID->"8e261510-ab7b-4d84-b5d7-cf22d87a5354"],
Cell[232281, 5478, 261, 5, 23, "Print",ExpressionUUID->"97fb7c18-2dd3-4aa9-8fb2-c777b4462884"],
Cell[232545, 5485, 259, 5, 23, "Print",ExpressionUUID->"492d89f2-86d6-4e54-a6be-00031a7110bd"],
Cell[232807, 5492, 258, 5, 23, "Print",ExpressionUUID->"59756f8b-a1f3-4896-9f64-d92b65cdd94d"],
Cell[233068, 5499, 261, 5, 23, "Print",ExpressionUUID->"bea6fcca-4955-4023-9513-dc692df79a64"],
Cell[233332, 5506, 259, 5, 23, "Print",ExpressionUUID->"bfd488fd-170d-4431-b092-454f42a3aa76"],
Cell[233594, 5513, 261, 5, 23, "Print",ExpressionUUID->"aa40e0a2-33c8-448b-a3e7-47747ed7cbcc"],
Cell[233858, 5520, 261, 5, 23, "Print",ExpressionUUID->"3ee30622-96c6-41fc-87d0-5bf384793187"],
Cell[234122, 5527, 261, 5, 23, "Print",ExpressionUUID->"d672d59d-8ef4-4fc7-9f6f-f2a9394c4749"],
Cell[234386, 5534, 257, 5, 23, "Print",ExpressionUUID->"d7656c39-a84d-4490-9794-d1a84130515d"],
Cell[234646, 5541, 259, 5, 23, "Print",ExpressionUUID->"54dfa515-52f7-4d3c-8197-23308b29508d"],
Cell[234908, 5548, 259, 5, 23, "Print",ExpressionUUID->"c94ca8da-a258-4de3-ad40-4e88a7108a65"],
Cell[235170, 5555, 259, 5, 23, "Print",ExpressionUUID->"943dda5a-d2ff-416d-af2d-b36228d1bc09"],
Cell[235432, 5562, 259, 5, 23, "Print",ExpressionUUID->"e7ad8e4b-2798-4836-aded-a6db2c89b136"],
Cell[235694, 5569, 259, 5, 23, "Print",ExpressionUUID->"7362b163-93d3-467b-afbc-8d7135b2fc5d"],
Cell[235956, 5576, 259, 5, 23, "Print",ExpressionUUID->"07d321b8-a0e8-4e35-8c47-f92ef5632ceb"],
Cell[236218, 5583, 259, 5, 23, "Print",ExpressionUUID->"00764d07-a4d8-4648-9c56-21a621394217"],
Cell[236480, 5590, 261, 5, 23, "Print",ExpressionUUID->"5ab69997-660e-423b-938d-229371bc88fd"],
Cell[236744, 5597, 261, 5, 23, "Print",ExpressionUUID->"0a1811c8-2829-4daa-9947-0d1da9bf234f"],
Cell[237008, 5604, 261, 5, 23, "Print",ExpressionUUID->"a65a57e3-b7fc-4f47-a1c4-c582d3206487"],
Cell[237272, 5611, 259, 5, 23, "Print",ExpressionUUID->"ac7550ba-b63a-4a3f-84f0-300ef0bb7612"],
Cell[237534, 5618, 259, 5, 23, "Print",ExpressionUUID->"c590f372-c590-4673-a3bf-70a8880fdcae"],
Cell[237796, 5625, 259, 5, 23, "Print",ExpressionUUID->"9fcda884-0d3c-4526-ac68-3e2af20c3925"],
Cell[238058, 5632, 261, 5, 23, "Print",ExpressionUUID->"c9832be2-a96c-449e-b56d-2d8cb98e8c87"],
Cell[238322, 5639, 261, 5, 23, "Print",ExpressionUUID->"82b0e42d-a8bc-4dea-93c6-074662a92fb8"],
Cell[238586, 5646, 259, 5, 23, "Print",ExpressionUUID->"d9dbe3b6-9f77-4541-9663-4334cfd2b79b"],
Cell[238848, 5653, 259, 5, 23, "Print",ExpressionUUID->"818f6ea0-6e48-4e5e-9327-16b4a28f5604"],
Cell[239110, 5660, 259, 5, 23, "Print",ExpressionUUID->"f3e0b4ba-202a-4499-a808-6991dcd0ab8d"],
Cell[239372, 5667, 259, 5, 23, "Print",ExpressionUUID->"920dce76-b047-415f-ad4f-b6b9680773e1"],
Cell[239634, 5674, 259, 5, 23, "Print",ExpressionUUID->"bfcbe0e3-5083-4a43-bb19-bc2f0f1f6a94"],
Cell[239896, 5681, 259, 5, 23, "Print",ExpressionUUID->"e17f2b7f-b0e3-4d82-aa22-1dc2d34df3ad"],
Cell[240158, 5688, 261, 5, 23, "Print",ExpressionUUID->"ac062bda-7d1e-4e42-a901-361fb951e523"],
Cell[240422, 5695, 258, 5, 23, "Print",ExpressionUUID->"81d73814-0cfb-486e-b06e-bb747776b12c"],
Cell[240683, 5702, 259, 5, 23, "Print",ExpressionUUID->"c6827c90-aeba-4d32-8e34-e308f2f6b74b"],
Cell[240945, 5709, 258, 5, 23, "Print",ExpressionUUID->"c02bba88-c423-449a-87cc-458b215d47e4"],
Cell[241206, 5716, 261, 5, 23, "Print",ExpressionUUID->"2a52bae0-19ed-4f74-a60e-b9edfdaa03bb"],
Cell[241470, 5723, 261, 5, 23, "Print",ExpressionUUID->"d83420d4-60dd-4b57-900e-ae9caedb12f5"],
Cell[241734, 5730, 259, 5, 23, "Print",ExpressionUUID->"00dd97fb-18d2-4018-865c-dae94ebbadbb"],
Cell[241996, 5737, 261, 5, 23, "Print",ExpressionUUID->"34f2f812-bd0b-43b7-a8a7-80ac35ef86f3"],
Cell[242260, 5744, 259, 5, 23, "Print",ExpressionUUID->"bd203cf9-54bd-4706-beea-443ee001a85a"],
Cell[242522, 5751, 261, 5, 23, "Print",ExpressionUUID->"23f82e6d-82d0-430d-a00e-771625ebd053"],
Cell[242786, 5758, 259, 5, 23, "Print",ExpressionUUID->"cdc7664a-86ac-4eb3-8a8f-744d7160f0ad"],
Cell[243048, 5765, 259, 5, 23, "Print",ExpressionUUID->"3f82b676-4bc4-490e-811f-3acabfbdb582"],
Cell[243310, 5772, 261, 5, 23, "Print",ExpressionUUID->"ccceaf79-5853-40d1-9fa7-0c9d521ea0dc"],
Cell[243574, 5779, 258, 5, 23, "Print",ExpressionUUID->"eca3310a-36d2-4995-af2a-bfbe6e4417c2"],
Cell[243835, 5786, 259, 5, 23, "Print",ExpressionUUID->"6a1a045e-beb1-4582-a83c-379bae46fd97"],
Cell[244097, 5793, 261, 5, 23, "Print",ExpressionUUID->"861cc22d-491d-4ea8-aeec-d12d66474ea2"],
Cell[244361, 5800, 259, 5, 23, "Print",ExpressionUUID->"dae53e32-1a9f-4252-b258-94b36a02450a"],
Cell[244623, 5807, 259, 5, 23, "Print",ExpressionUUID->"9523fffa-d247-4c32-bacb-595136878946"],
Cell[244885, 5814, 259, 5, 23, "Print",ExpressionUUID->"89bf2d67-39b8-4689-84c1-3f1b59770056"],
Cell[245147, 5821, 259, 5, 23, "Print",ExpressionUUID->"8cfdb4da-2f9b-4514-8458-b6d0661a6c81"],
Cell[245409, 5828, 259, 5, 23, "Print",ExpressionUUID->"379657c7-1201-4800-bc74-ab0368f7b834"],
Cell[245671, 5835, 259, 5, 23, "Print",ExpressionUUID->"a23672dd-48c4-4fd8-942a-4b7734ff77cc"],
Cell[245933, 5842, 258, 5, 23, "Print",ExpressionUUID->"43b220c6-b4d2-4eac-9068-384c0fb9c199"],
Cell[246194, 5849, 259, 5, 23, "Print",ExpressionUUID->"9fe2a74d-0930-4db3-99ba-9f4c4861e486"],
Cell[246456, 5856, 259, 5, 23, "Print",ExpressionUUID->"2ffadc05-1194-49ef-bf79-90167d8921dd"],
Cell[246718, 5863, 261, 5, 23, "Print",ExpressionUUID->"7e5635dc-1dbf-4f6c-b485-b83ca3d46907"],
Cell[246982, 5870, 259, 5, 23, "Print",ExpressionUUID->"2da5418a-f23f-4316-aa27-cc9e1f244cdf"],
Cell[247244, 5877, 261, 5, 23, "Print",ExpressionUUID->"9c082caf-e811-43eb-a4b0-5ce889d0789a"],
Cell[247508, 5884, 259, 5, 23, "Print",ExpressionUUID->"4b338ed5-88df-454e-ab43-513c824ddb45"],
Cell[247770, 5891, 259, 5, 23, "Print",ExpressionUUID->"61ff2719-e14d-47d6-b897-5ba8bc2851e6"],
Cell[248032, 5898, 257, 5, 23, "Print",ExpressionUUID->"a50d07b0-98c6-47f2-9119-d5e7cf303671"],
Cell[248292, 5905, 259, 5, 23, "Print",ExpressionUUID->"9df63ac6-2a4a-4803-a822-9f59c5fd9a41"],
Cell[248554, 5912, 259, 5, 23, "Print",ExpressionUUID->"46a285ea-a3cc-44b6-9dcd-2b47df22a49f"],
Cell[248816, 5919, 261, 5, 23, "Print",ExpressionUUID->"57665223-1e0a-4a42-8d85-24083aa0af32"],
Cell[249080, 5926, 259, 5, 23, "Print",ExpressionUUID->"d4afe8c9-eb24-4104-afaa-8a0ffa98b006"],
Cell[249342, 5933, 261, 5, 23, "Print",ExpressionUUID->"dec52ef2-5b3e-4043-b57b-e795941e2fa6"],
Cell[249606, 5940, 261, 5, 23, "Print",ExpressionUUID->"3eb40846-bb56-4f61-ab98-79c24b532811"],
Cell[249870, 5947, 259, 5, 23, "Print",ExpressionUUID->"87987e1c-090c-4e20-b9e8-e58109f505d5"],
Cell[250132, 5954, 261, 5, 23, "Print",ExpressionUUID->"13b8757b-1787-4918-883f-8bb2fa5bada2"],
Cell[250396, 5961, 259, 5, 23, "Print",ExpressionUUID->"aa67e992-d50a-402c-9fe2-5346d57aab00"],
Cell[250658, 5968, 261, 5, 23, "Print",ExpressionUUID->"696e628b-ebdc-4eaf-a052-86f089f0a893"],
Cell[250922, 5975, 259, 5, 23, "Print",ExpressionUUID->"c3769e2f-4b71-473c-a3c6-1985f6691e85"],
Cell[251184, 5982, 259, 5, 23, "Print",ExpressionUUID->"3c5b57cb-f1f7-4033-a0ca-dee1abfc3dad"],
Cell[251446, 5989, 261, 5, 23, "Print",ExpressionUUID->"b28e053b-b2f7-4ac8-bacc-59bd145e5d7d"],
Cell[251710, 5996, 259, 5, 23, "Print",ExpressionUUID->"1bd3ac34-3015-4d69-85e4-b1856f847289"],
Cell[251972, 6003, 259, 5, 23, "Print",ExpressionUUID->"68eb31a0-1002-4dbc-91dd-bd1b7e72d312"],
Cell[252234, 6010, 261, 5, 23, "Print",ExpressionUUID->"0275be72-ee97-4223-8561-ad6003950c68"],
Cell[252498, 6017, 259, 5, 23, "Print",ExpressionUUID->"cb6e75c5-03da-4443-86a3-643082895d19"],
Cell[252760, 6024, 259, 5, 23, "Print",ExpressionUUID->"8ac412ab-4275-4a3d-ae4b-a3a0d8f51511"],
Cell[253022, 6031, 259, 5, 23, "Print",ExpressionUUID->"51b487ab-c5c0-43ce-bbfc-9d1d179d58f0"],
Cell[253284, 6038, 259, 5, 23, "Print",ExpressionUUID->"3f6e0aab-2b46-443a-bee5-8b28d03be500"],
Cell[253546, 6045, 259, 5, 23, "Print",ExpressionUUID->"3d7b111d-d663-444f-8a47-c93e3538e0f6"],
Cell[253808, 6052, 259, 5, 23, "Print",ExpressionUUID->"bf19bc10-1897-4191-9169-3654d86bbd6d"],
Cell[254070, 6059, 261, 5, 23, "Print",ExpressionUUID->"ebab9512-786a-4d0b-a326-0b1e0b0c2c92"],
Cell[254334, 6066, 259, 5, 23, "Print",ExpressionUUID->"b73c530b-7925-40b4-aeb8-e99acc086d1f"],
Cell[254596, 6073, 258, 5, 23, "Print",ExpressionUUID->"35d45994-f2d4-4f22-adbd-d9b0ec20c7a1"],
Cell[254857, 6080, 261, 5, 23, "Print",ExpressionUUID->"ba56eec3-86a0-4bfc-81a9-df1976ea4a6f"],
Cell[255121, 6087, 261, 5, 23, "Print",ExpressionUUID->"68a77f73-1c97-4f8a-8fdc-3ba1b51e5553"],
Cell[255385, 6094, 259, 5, 23, "Print",ExpressionUUID->"2962ce13-790a-4bcc-ba9a-4029c3aed84f"],
Cell[255647, 6101, 258, 5, 23, "Print",ExpressionUUID->"fae62976-1a9e-4efd-81b3-783ae6faae43"],
Cell[255908, 6108, 259, 5, 23, "Print",ExpressionUUID->"1d4f65d6-9868-4370-96cd-4664a64be0d1"],
Cell[256170, 6115, 258, 5, 23, "Print",ExpressionUUID->"5000584c-6fe5-41a7-8f65-9ed06cd9ee89"],
Cell[256431, 6122, 259, 5, 23, "Print",ExpressionUUID->"2e044383-ae24-4ed0-85cc-5170332c9949"],
Cell[256693, 6129, 259, 5, 23, "Print",ExpressionUUID->"533f6c34-a2af-424d-8d59-f93c031b97e4"],
Cell[256955, 6136, 259, 5, 23, "Print",ExpressionUUID->"63e0c8f4-86a8-4506-a64c-89ba23791cf2"],
Cell[257217, 6143, 259, 5, 23, "Print",ExpressionUUID->"10485c7d-b6de-4b66-9af8-975b91649d50"],
Cell[257479, 6150, 259, 5, 23, "Print",ExpressionUUID->"a48df2eb-7cfe-40f2-95cb-a73ded29fa7a"],
Cell[257741, 6157, 259, 5, 23, "Print",ExpressionUUID->"be71dd8b-c61f-4814-9f0a-470d2505c4bd"],
Cell[258003, 6164, 259, 5, 23, "Print",ExpressionUUID->"9a11564f-f12e-48ad-9b86-d5c83c4bd3fd"],
Cell[258265, 6171, 259, 5, 23, "Print",ExpressionUUID->"c8ef5f9d-917b-4ffe-b2b5-73a166f39b9b"],
Cell[258527, 6178, 261, 5, 23, "Print",ExpressionUUID->"003b4e14-f194-4fe6-8862-03a646d0afa5"],
Cell[258791, 6185, 261, 5, 23, "Print",ExpressionUUID->"613a0372-ff68-4444-bae1-31bea8c545a3"],
Cell[259055, 6192, 258, 5, 23, "Print",ExpressionUUID->"ab3b3e13-db52-4b5d-8d0c-26fa195fbc8d"],
Cell[259316, 6199, 261, 5, 23, "Print",ExpressionUUID->"aa4f9d02-e7f2-43ec-90ee-ecbf42ca4491"],
Cell[259580, 6206, 259, 5, 23, "Print",ExpressionUUID->"2a888292-1954-40ad-985c-f8107170e1f3"],
Cell[259842, 6213, 259, 5, 23, "Print",ExpressionUUID->"274b52b1-6857-4f9b-bcf9-4da3786eb7ac"],
Cell[260104, 6220, 259, 5, 23, "Print",ExpressionUUID->"32c20afd-dc77-4dd4-b9f0-70b36ef57808"],
Cell[260366, 6227, 259, 5, 23, "Print",ExpressionUUID->"bade3045-42ba-4276-8ce5-c36cefc648b8"],
Cell[260628, 6234, 259, 5, 23, "Print",ExpressionUUID->"cc29f9da-bd6d-484b-bc50-6af2df8f0114"],
Cell[260890, 6241, 259, 5, 23, "Print",ExpressionUUID->"c20d2226-07c4-4519-954f-be6512841e7c"],
Cell[261152, 6248, 261, 5, 23, "Print",ExpressionUUID->"4066e670-5132-480a-8466-92079477039b"],
Cell[261416, 6255, 261, 5, 23, "Print",ExpressionUUID->"21597442-bca9-4328-a92f-f28fa71c7f2d"],
Cell[261680, 6262, 261, 5, 23, "Print",ExpressionUUID->"479391d9-3ee1-4d59-a2aa-bdf44ed3ba43"],
Cell[261944, 6269, 259, 5, 23, "Print",ExpressionUUID->"e2b7361c-2e7b-43be-adaf-a0c78bf97cfb"],
Cell[262206, 6276, 259, 5, 23, "Print",ExpressionUUID->"a772e97f-b412-45ab-8b30-3420efd6922b"],
Cell[262468, 6283, 259, 5, 23, "Print",ExpressionUUID->"3a6e4126-5b26-4964-af4b-29049b65e69a"],
Cell[262730, 6290, 259, 5, 23, "Print",ExpressionUUID->"96460b01-65cd-4b80-a88a-bf7724c0f4a9"],
Cell[262992, 6297, 261, 5, 23, "Print",ExpressionUUID->"880a179b-da89-435f-85a0-4a23fbea48e5"],
Cell[263256, 6304, 259, 5, 23, "Print",ExpressionUUID->"11736220-b568-45a1-8125-b3e79742641d"],
Cell[263518, 6311, 259, 5, 23, "Print",ExpressionUUID->"6ff48e26-e0a5-4c3b-b420-89c6087d9199"],
Cell[263780, 6318, 259, 5, 23, "Print",ExpressionUUID->"9f56f06f-6254-41d2-a5a4-96a9e0477d17"],
Cell[264042, 6325, 259, 5, 23, "Print",ExpressionUUID->"081703f8-e6bd-466f-adee-0ff4bd015c2a"],
Cell[264304, 6332, 259, 5, 23, "Print",ExpressionUUID->"5a5e366b-296b-47cc-bc84-eb33ee498db4"],
Cell[264566, 6339, 259, 5, 23, "Print",ExpressionUUID->"e899c545-be5a-472e-bc83-ac460f0a116a"],
Cell[264828, 6346, 261, 5, 23, "Print",ExpressionUUID->"bb4ea8bf-263a-426c-a0fc-bc5e9e658ff4"],
Cell[265092, 6353, 259, 5, 23, "Print",ExpressionUUID->"c8ae720c-3e21-4921-af7e-74e482ae7e83"],
Cell[265354, 6360, 261, 5, 23, "Print",ExpressionUUID->"37d4b1b7-2b84-4a94-80b7-469d6fd0e2ba"],
Cell[265618, 6367, 259, 5, 23, "Print",ExpressionUUID->"916c4949-d1b5-4aba-a621-d09f8752f9d0"],
Cell[265880, 6374, 261, 5, 23, "Print",ExpressionUUID->"8cb2c6a1-4336-4bc9-98b7-514498ec14d9"],
Cell[266144, 6381, 259, 5, 23, "Print",ExpressionUUID->"e002f85d-6392-459b-a270-d0878b3947aa"],
Cell[266406, 6388, 259, 5, 23, "Print",ExpressionUUID->"663a1143-c4e8-4e1a-8f3d-f25963810413"],
Cell[266668, 6395, 259, 5, 23, "Print",ExpressionUUID->"d8a7ec04-3ce0-4b1c-95d2-2bf8769cf772"],
Cell[266930, 6402, 261, 5, 23, "Print",ExpressionUUID->"b2f01d98-9037-4ad9-a289-427a9c20f686"],
Cell[267194, 6409, 2171, 47, 55, "Print",ExpressionUUID->"f46b7cea-6b62-4f52-a82e-fb5137cdc2cd"],
Cell[269368, 6458, 259, 5, 23, "Print",ExpressionUUID->"c2585315-7b57-489e-960f-a0fba85df635"],
Cell[269630, 6465, 259, 5, 23, "Print",ExpressionUUID->"da24df35-5af5-49b2-a0ad-28370341c296"],
Cell[269892, 6472, 261, 5, 23, "Print",ExpressionUUID->"828b4505-f44f-45bf-b8fb-839e7bdea09a"],
Cell[270156, 6479, 258, 5, 23, "Print",ExpressionUUID->"802400d3-2ea0-4930-97e4-0d46682b7150"],
Cell[270417, 6486, 259, 5, 23, "Print",ExpressionUUID->"2ddd9627-0f99-425e-bfbe-a95df3e56a9d"],
Cell[270679, 6493, 259, 5, 23, "Print",ExpressionUUID->"ed5a0a28-cbc1-44b3-9575-17fd2227cc4c"],
Cell[270941, 6500, 241, 5, 23, "Print",ExpressionUUID->"ca5bc9d3-e355-4e6a-85ac-e8580ef9dcfc"],
Cell[271185, 6507, 259, 6, 23, "Print",ExpressionUUID->"1bab48f8-d314-475f-9f1a-c6f888a5cb13"],
Cell[271447, 6515, 851, 21, 23, "Print",ExpressionUUID->"11c26bf5-af57-4428-a41b-9be89870fba3"]
}, Open  ]]
}, Open  ]],
Cell[272325, 6540, 24490, 506, 1254, "Input",ExpressionUUID->"b1d81f0c-e233-48f1-91f6-5198c7f2aeab"],
Cell[296818, 7048, 4504, 76, 49, "Input",ExpressionUUID->"00acd85e-6837-4f86-a78c-d542ae1b9523"],
Cell[301325, 7126, 2049, 43, 111, "Input",ExpressionUUID->"e0b2fd3c-104a-4d74-9bb4-102f8b9342c8"],
Cell[CellGroupData[{
Cell[303399, 7173, 2073, 44, 111, "Input",ExpressionUUID->"3c0f2fac-a232-4444-bdf5-aaca84f4c5fd"],
Cell[CellGroupData[{
Cell[305497, 7221, 289, 6, 23, "Print",ExpressionUUID->"63ebe46c-2a4c-48cc-8350-a7329cdcb222"],
Cell[305789, 7229, 286, 7, 23, "Print",ExpressionUUID->"52df9cfd-79a0-415d-aa26-f458ce8d0b49"]
}, Open  ]]
}, Open  ]],
Cell[306102, 7240, 152, 3, 29, "Input",ExpressionUUID->"58a66034-37b5-44ae-af7f-8fcc19d9f212"]
}
]
*)

