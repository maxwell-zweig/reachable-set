(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30558,        744]
NotebookOptionsPosition[     28710,        706]
NotebookOutlinePosition[     29141,        724]
CellTagsIndexPosition[     29098,        721]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"integrates", " ", "state"}], ",", " ", 
    RowBox[{"stm", " ", "and"}], ",", " ", 
    RowBox[{"second", " ", "order", " ", "stt"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"numerPropAndSTM2", "[", 
     RowBox[{
     "vars_", ",", "ics_", ",", "dyn_", ",", "jac_", ",", "jac2_", ",", 
      "time_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"soln", ",", "zeros", ",", "tpzeros"}], "}"}], ",", 
      RowBox[{
       RowBox[{"zeros", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "vars", "]"}]}], "]"}]}], ";", 
       RowBox[{"tpzeros", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{"zeros", ",", "zeros"}], "]"}], ",", "zeros"}], "]"}]}], 
       ";", 
       RowBox[{"soln", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", "vars"}], 
               ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], 
              "\[Equal]", "ics"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Phi", "'"}], "[", "t", "]"}], "==", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"jac", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}], ".", 
              RowBox[{"Phi", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Phi2", "'"}], "[", "t", "]"}], "==", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"jac", "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"vars", "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}], ".", 
               RowBox[{"Phi2", "[", "t", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Phi", "[", "t", "]"}], "]"}], ".", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"(", 
                   RowBox[{"jac2", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}], "]"}]}], "]"}], ".", 
               RowBox[{"Phi", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"Phi", "[", "0", "]"}], "==", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "vars", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Phi2", "[", "0", "]"}], "==", "tpzeros"}]}], "}"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"vars", ",", 
            RowBox[{"{", 
             RowBox[{"Phi", ",", "Phi2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "time", ",", "time"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "time", "]"}], "&"}], "/@", "vars"}], ")"}], "/.", 
          RowBox[{"soln", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Phi", "[", "time", "]"}], "/.", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Phi2", "[", "time", "]"}], "/.", 
           RowBox[{"soln", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "calculate", " ", "the", " ", "initial", " ", "costates", " ", "to", " ", 
     "solve", " ", "relative", " ", "BVP"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getInitCostates", "[", 
     RowBox[{"varMat_", ",", "icsRel_", ",", "fcsRel_"}], "]"}], ":=", 
    RowBox[{"LinearSolve", "[", 
     RowBox[{
      RowBox[{"varMat", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "6"}], ",", 
         RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], ",", 
      RowBox[{"fcsRel", "-", 
       RowBox[{
        RowBox[{"varMat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "6"}], ",", 
           RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], ".", "icsRel"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findEnergyLoss", "[", 
     RowBox[{"stm_", ",", "stt_", ",", "icRel_", ",", "fcRel_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"initCo", ",", "state"}], "}"}], ",", 
      RowBox[{
       RowBox[{"initCo", "=", 
        RowBox[{"getInitCostates", "[", 
         RowBox[{"stm", ",", "icRel", ",", "fcRel"}], "]"}]}], ";", " ", 
       RowBox[{"state", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"icRel", ",", 
          RowBox[{"Join", "[", 
           RowBox[{"initCo", ",", 
            RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"stt", "[", 
          RowBox[{"[", "13", "]"}], "]"}], ".", "state", ".", "state"}], "/", 
        "2"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Constants", ":", " ", "mu1"}], ",", " ", "endTime", ",", " ", 
     "alpha"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mu1", " ", "=", " ", 
     RowBox[{"3.986", " ", 
      RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"endTime", " ", "=", " ", "1600"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"mu1", " ", "/", " ", 
        RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
         " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", 
         "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
         "0", ",", " ", 
         RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
         RowBox[{
          RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", 
         RowBox[{"-", 
          RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
         "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"construct", " ", "eqns", " ", "of", " ", "motion"}], " ", "-", 
      " ", 
      RowBox[{
      "put", " ", "yours", " ", "here", " ", "in", " ", "eqnsStateOpt", " ", 
       "the", " ", "RHS", " ", "of", " ", "the", " ", "state", " ", "ODE", 
       " ", "and", " ", "RHS", " ", "of", " ", "the", " ", "costates", " ", 
       "in", " ", "eqnsOpt"}]}], ",", " ", 
     RowBox[{
     "use", " ", "notation", " ", "from", " ", "vars", " ", "for", " ", 
      "variable", " ", "names"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqnsStateOpt", "=", 
     RowBox[{
      RowBox[{"{", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
         RowBox[{"3", 
          RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
        RowBox[{
         RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "-", " ", 
      RowBox[{"{", 
       RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqnsOpt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
      RowBox[{"{", 
       RowBox[{
       "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
        "lyv", ",", " ", "lzv"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"keep", " ", "as", " ", 
     RowBox[{"is", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqnEn", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lxv", "^", "2"}], "+", 
        RowBox[{"lyv", "^", "2"}], "+", 
        RowBox[{"lzv", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vars", "=", 
     RowBox[{"{", 
      RowBox[{
      "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "lxr", 
       ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", ",", 
       "en"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dyn", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
           "eqnsStateOpt"}], "]"}], ",", "eqnsOpt"}], "]"}], ",", 
       RowBox[{"{", "eqnEn", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jac", "=", 
     RowBox[{"D", "[", 
      RowBox[{"dyn", ",", 
       RowBox[{"{", "vars", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jac2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"jac", ",", 
       RowBox[{"{", "vars", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"reference", " ", "trajectory", " ", "is", " ", "origin"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ics", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "13"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"numerPropAndSTM2", "[", 
      RowBox[{
      "vars", ",", "ics", ",", "dyn", ",", "jac", ",", "jac2", ",", " ", 
       "1600"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "//", " ", "Dimensions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "3", "]"}], "]"}], " ", "//", " ", "Dimensions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"quad", " ", "=", " ", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stm", " ", "=", " ", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"st", "[", 
      RowBox[{"[", "13", "]"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"st", "[", 
     RowBox[{"[", 
      RowBox[{"13", ",", " ", 
       RowBox[{";;", "12"}], ",", " ", 
       RowBox[{";;", " ", "12"}]}], "]"}], "]"}], " ", "//", " ", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "icRel", " ", "and", " ", "fcRel", " ", "have", " ", "the", " ", 
     "initial", " ", "and", " ", "final", " ", "6", " ", "dimensional", " ", 
     "states", " ", "between", " ", "which", " ", "the", " ", "opt", " ", 
     "control", " ", "is", " ", "solved", " ", "and", " ", "energy", " ", 
     "loss", " ", "is", " ", "calculated"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"findEnergyLoss", "[", 
    RowBox[{
     RowBox[{"sol", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "200"}], ",", " ", 
       RowBox[{"-", "200"}], ",", " ", 
       RowBox[{"-", "100"}], ",", " ", 
       RowBox[{"-", "0.02"}], ",", " ", "0.0231", ",", " ", "0.012"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "851.6839"}], ",", " ", "618.3271", ",", " ", "22.9877", 
       ",", " ", 
       RowBox[{"-", "0.5955"}], ",", " ", "1.3289", ",", " ", "0.1422"}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9183421229940166`*^9, 3.9183421484000587`*^9}, {
   3.918481497907954*^9, 3.918481508568465*^9}, {3.918586363868576*^9, 
   3.91858637283851*^9}, {3.918586412155993*^9, 3.918586463523713*^9}, {
   3.918682720289459*^9, 3.9186827486139097`*^9}, {3.918683182802471*^9, 
   3.9186831844413967`*^9}, {3.918684058978427*^9, 3.9186840626027927`*^9}, {
   3.918684320798174*^9, 3.918684344062387*^9}, {3.91868451419635*^9, 
   3.918684514545384*^9}, {3.918685332239911*^9, 3.918685334432818*^9}, 
   3.918689081011511*^9, 3.918691594613243*^9, {3.918691651793515*^9, 
   3.9186916623892727`*^9}, {3.918730237332259*^9, 3.918730237528613*^9}, {
   3.9190150386134*^9, 3.919015045461637*^9}, {3.919015081340674*^9, 
   3.9190150935061274`*^9}, {3.919015644701174*^9, 3.919015651492157*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"3ff4df8b-6537-45fd-94ac-16af9f51247a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.2528521032557483`*^9"}], 
      RowBox[{"-", "8.76190843858119`*^8"}], "0.`", "2.5048227198982136`*^6", 
      "3.018499158748302`*^6", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.76190843858119`*^8"}], 
      RowBox[{"-", "1.577361071697945`*^9"}], "0.`", "28759.191213550414`", 
      "2.031947297334117`*^6", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.82133521310269`*^8"}], "0.`", "0.`", 
      "584963.6715387271`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "2.5048227198982136`*^6", 
      "28759.191213550414`", "0.`", 
      RowBox[{"-", "3840.0312846854385`"}], 
      RowBox[{"-", "2649.4751817025526`"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "3.018499158748302`*^6", 
      "2.031947297334117`*^6", "0.`", 
      RowBox[{"-", "2649.4751817025526`"}], 
      RowBox[{"-", "5080.711742467677`"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "584963.6715387271`", "0.`", "0.`", 
      RowBox[{"-", "853.3229050996538`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.91873023956993*^9, 3.918730253829805*^9}, {
   3.91901499804856*^9, 3.919015050276276*^9}, {3.919015084637969*^9, 
   3.9190150964931498`*^9}, 3.919015654989333*^9},
 CellLabel->
  "Out[428]//MatrixForm=",ExpressionUUID->"0ffa7be6-0b84-47a8-aa24-\
6c9276a31d8c"],

Cell[BoxData[
 RowBox[{"-", "0.000029067762217374427`"}]], "Output",
 CellChangeTimes->{{3.91873023956993*^9, 3.918730253829805*^9}, {
   3.91901499804856*^9, 3.919015050276276*^9}, {3.919015084637969*^9, 
   3.9190150964931498`*^9}, 3.91901565499067*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"fab49d89-c45e-4ffd-856a-080607f4230b"],

Cell[BoxData[
 RowBox[{"(*", "*)"}]], "Input",
 CellChangeTimes->{{3.918342258287554*^9, 3.9183422588922944`*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"e344078d-d581-433f-9d44-117a1f6723e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stmcostatestate", " ", "=", " ", 
  RowBox[{"stm", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "12"}], ",", " ", 
     RowBox[{";;", "12"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.918342733527305*^9, 3.9187302473055153`*^9, {3.919015676566442*^9, 
   3.919015740798867*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"25d2ab30-3f77-4e61-9efa-202d7986846e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3.704208546275383`", ",", "0.`", ",", "0.`", ",", "1081.6317966130184`", 
     ",", "1959.5198634325707`", ",", "0.`", ",", "2.7907094261413443`*^8", 
     ",", "7.671543464272871`*^8", ",", "0.`", ",", 
     RowBox[{"-", "66813.45204580082`"}], ",", 
     RowBox[{"-", "1.640361797907337`*^6"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.8614677541690017`"}], ",", "1.`", ",", "0.`", ",", 
     RowBox[{"-", "1959.5198634325925`"}], ",", 
     RowBox[{"-", "473.4728135478848`"}], ",", "0.`", ",", 
     RowBox[{"-", "7.671543464272724`*^8"}], ",", 
     RowBox[{"-", "8.859523034805603`*^7"}], ",", "0.`", ",", 
     "1.6403617979073338`*^6", ",", "991887.3953581435`", ",", "0.`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.09859715124153699`", ",", "0.`", ",", "0.`", 
     ",", "1081.6317966130232`", ",", "0.`", ",", "0.`", ",", 
     "5.457394552433258`*^8", ",", "0.`", ",", "0.`", ",", 
     RowBox[{"-", "865305.4373120363`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0027466239570275385`", ",", "0.`", ",", "0.`", ",", 
     "0.0985971512415075`", ",", "1.990254859814077`", ",", "0.`", ",", 
     "66813.45204580766`", ",", "1.6403617979073392`*^6", ",", "0.`", ",", 
     "1228.0590901259106`", ",", 
     RowBox[{"-", "2082.4598491574097`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0049758746165085455`"}], ",", "0.`", ",", "0.`", ",", 
     RowBox[{"-", "1.9902548598140355`"}], ",", 
     RowBox[{"-", "2.6056113950338218`"}], ",", "0.`", ",", 
     RowBox[{"-", "1.6403617979073382`*^6"}], ",", 
     RowBox[{"-", "991887.3953581825`"}], ",", "0.`", ",", 
     "2082.4598491574015`", ",", "3491.8179198598914`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", 
     RowBox[{"-", "0.0009155413190091822`"}], ",", "0.`", ",", "0.`", ",", 
     "0.0985971512415379`", ",", "0.`", ",", "0.`", ",", "865305.4373120369`",
      ",", "0.`", ",", "0.`", ",", 
     RowBox[{"-", "619.6936192652408`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "3.704208546275391`", ",", "2.8614677541689706`", ",", "0.`", ",", 
     RowBox[{"-", "0.0027466239570275563`"}], ",", 
     RowBox[{"-", "0.0049758746165085525`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.0985971512415379`", ",", "0.`", ",", "0.`", 
     ",", "0.0009155413190091822`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     RowBox[{"-", "1081.631796613032`"}], ",", 
     RowBox[{"-", "1959.5198634325677`"}], ",", "0.`", ",", 
     "0.09859715124152256`", ",", "1.9902548598140621`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "1959.5198634325802`", ",", "473.47281354790715`", ",", "0.`", ",", 
     RowBox[{"-", "1.9902548598140533`"}], ",", 
     RowBox[{"-", "2.605611395033849`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", 
     RowBox[{"-", "1081.6317966130232`"}], ",", "0.`", ",", "0.`", ",", 
     "0.09859715124153699`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.919015678831645*^9, 3.9190157077878637`*^9}, 
   3.919015905414831*^9},
 CellLabel->
  "Out[483]=",ExpressionUUID->"2c1114d3-33d2-4663-ac66-c9909abd138e"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.918342307706769*^9, {3.9183423569213247`*^9, 3.9183424032884483`*^9}, {
   3.9183425173497906`*^9, 3.918342531853286*^9}, {3.918342598673596*^9, 
   3.918342660850435*^9}, {3.918481372288548*^9, 3.9184813737688713`*^9}, {
   3.9184814769001093`*^9, 3.91848147730199*^9}, {3.9185701186760798`*^9, 
   3.9185702140893383`*^9}, {3.918574827682982*^9, 3.918574851867297*^9}, {
   3.918575044515293*^9, 3.918575068224258*^9}, {3.918575101997463*^9, 
   3.9185751154711847`*^9}, {3.918575420417768*^9, 3.918575429402277*^9}, {
   3.9185772418028507`*^9, 3.9185772434357977`*^9}, {3.9185787475502987`*^9, 
   3.91857875398064*^9}, {3.918584812793387*^9, 3.918584825735227*^9}, {
   3.918584874451873*^9, 3.918584877935906*^9}, {3.9185851152916527`*^9, 
   3.918585119194363*^9}, {3.918585613116358*^9, 3.918585615955546*^9}, 
   3.918585658031188*^9, {3.91858608522964*^9, 3.9185860905319147`*^9}, {
   3.91858642117001*^9, 3.918586422055417*^9}, {3.918586610440102*^9, 
   3.9185866744472322`*^9}, {3.918586726604062*^9, 3.9185867676511497`*^9}, {
   3.918586929366469*^9, 3.918586930090385*^9}, {3.918588051484776*^9, 
   3.918588200016199*^9}, {3.9186554281867037`*^9, 3.918655440761982*^9}, {
   3.918656120802229*^9, 3.9186561208876*^9}, {3.91868249725219*^9, 
   3.9186825073630457`*^9}, {3.9186825803618307`*^9, 3.918682626826777*^9}, {
   3.918682753648385*^9, 3.918682776987589*^9}, {3.918682807546699*^9, 
   3.918682924580152*^9}, {3.9186829595161257`*^9, 3.918683045053298*^9}, {
   3.918683178290132*^9, 3.91868318151821*^9}, {3.91868321735769*^9, 
   3.918683226203425*^9}, {3.918684393403595*^9, 3.9186844001860237`*^9}, {
   3.918684444550261*^9, 3.918684444961341*^9}, {3.9186846084141407`*^9, 
   3.9186846086016407`*^9}, {3.918685831650033*^9, 3.918685835796185*^9}, 
   3.918686706792191*^9, {3.9186868836174994`*^9, 3.918686896902*^9}, 
   3.918691571924728*^9, {3.9187302071995573`*^9, 3.918730235903664*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"deff462b-4f2d-4cb4-a77b-8111a7cbd0f6"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.918342671207361*^9, 3.9183427001273985`*^9}, {
   3.918570231397463*^9, 3.9185702413431807`*^9}, 3.918692167594769*^9, 
   3.918692205887451*^9, 3.918730205712204*^9},
 CellLabel->
  "In[433]:=",ExpressionUUID->"906c5523-38ff-4a2d-9336-c5ede4dea8d1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9186832787253227`*^9, 3.918683278906856*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"ec844800-9b03-4340-be3f-a3b1a5dc53ea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.918683280591416*^9, 3.918683280592408*^9}, {
   3.918684447127932*^9, 3.918684477058208*^9}, 3.91901586947388*^9, 
   3.9190158999176683`*^9},ExpressionUUID->"d7397d2e-4392-4446-8eec-\
d55530c5db79"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.918480922901514*^9, 3.918480923792148*^9}, {
   3.9184812798640833`*^9, 3.918481340082444*^9}, 3.918481377526499*^9, {
   3.9184814832333393`*^9, 3.918481484970873*^9}, 3.9185754730098953`*^9, 
   3.918683203855185*^9, {3.918683242399056*^9, 3.918683273789174*^9}, {
   3.918683723557824*^9, 3.918683727445057*^9}, 3.918683785726232*^9, {
   3.918684405742736*^9, 3.918684413929665*^9}, {3.9186845727463512`*^9, 
   3.918684575461672*^9}, 3.918685030511278*^9, 3.91869015721049*^9, 
   3.918691975940015*^9},
 CellLabel->
  "In[436]:=",ExpressionUUID->"66a05cd1-06bf-4b74-acd3-96a747a72aec"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.9186918907014227`*^9, 3.918691940721127*^9},
 CellLabel->
  "In[437]:=",ExpressionUUID->"c6865418-d4da-490a-b1d8-7cc127b150c5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9186838031247253`*^9, 3.918683803125914*^9}, {
   3.918684935492341*^9, 3.918684954760674*^9}, {3.918685989116385*^9, 
   3.918686084515483*^9}, 3.918690154849564*^9, {3.9186919800619783`*^9, 
   3.918692002245501*^9}, {3.918692180053652*^9, 3.918692204212495*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"243de290-4f8f-488c-a7ab-4bbf641b4b9e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91834270765411*^9, 3.9183427650359097`*^9}, 
   3.918575445148408*^9, {3.9186833184229*^9, 3.918683327235013*^9}, {
   3.918683882588663*^9, 3.918683892216703*^9}, {3.9186839617744617`*^9, 
   3.918684005295824*^9}, {3.918684764939625*^9, 3.9186847792775*^9}, {
   3.9186852081483717`*^9, 3.918685208688642*^9}, 3.918691988293612*^9},
 CellLabel->
  "In[439]:=",ExpressionUUID->"128b8742-3add-4612-9bad-094370216b0d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "look", " ", "at", " ", "findEnergyLoss", " ", "and", " ", "you", " ", 
   "can", " ", "pull", " ", "out", " ", "the", " ", "relevant", " ", 
   "quadratic", " ", "form", " ", 
   RowBox[{"(", 
    RowBox[{"note", " ", "that", " ", "in", " ", "mathematica", " ", 
     RowBox[{"Matrix", ".", "vec", ".", "vec"}], " ", "is", " ", "like", " ", 
     RowBox[{"vec", "^", "T"}], " ", "Matrix", " ", "vec", " ", 
     RowBox[{"(", 
      RowBox[{
      "evaluation", " ", "of", " ", "a", " ", "quadratic", " ", "form", " ", 
       "when", " ", "the", " ", "vecs", " ", "are", " ", "1", "d", " ", "and",
        " ", "not", " ", "wrapped", " ", "to", " ", "be", " ", "2", "d"}], 
      ")"}]}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9183427683073072`*^9, 3.9183428809160395`*^9}},
 CellLabel->
  "In[440]:=",ExpressionUUID->"6f23e589-ac84-495b-8fab-662473e3818f"]
},
CellGrouping->Manual,
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
DockedCells->{},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6074b008-d314-47eb-b0f5-ac77da3ebea0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 15244, 400, 913, "Input",ExpressionUUID->"3ff4df8b-6537-45fd-94ac-16af9f51247a"],
Cell[15827, 424, 2467, 53, 244, "Output",ExpressionUUID->"0ffa7be6-0b84-47a8-aa24-6c9276a31d8c"],
Cell[18297, 479, 338, 6, 34, "Output",ExpressionUUID->"fab49d89-c45e-4ffd-856a-080607f4230b"],
Cell[18638, 487, 197, 4, 30, "Input",ExpressionUUID->"e344078d-d581-433f-9d44-117a1f6723e5"],
Cell[CellGroupData[{
Cell[18860, 495, 405, 11, 30, "Input",ExpressionUUID->"25d2ab30-3f77-4e61-9efa-202d7986846e"],
Cell[19268, 508, 3947, 85, 171, "Output",ExpressionUUID->"2c1114d3-33d2-4663-ac66-c9909abd138e"]
}, Open  ]]
}, Open  ]],
Cell[23242, 597, 2058, 29, 30, "Input",ExpressionUUID->"deff462b-4f2d-4cb4-a77b-8111a7cbd0f6"],
Cell[CellGroupData[{
Cell[25325, 630, 299, 5, 30, "Input",ExpressionUUID->"906c5523-38ff-4a2d-9336-c5ede4dea8d1"],
Cell[25627, 637, 177, 3, 30, "Input",ExpressionUUID->"ec844800-9b03-4340-be3f-a3b1a5dc53ea"],
Cell[25807, 642, 248, 4, 30, "Input",ExpressionUUID->"d7397d2e-4392-4446-8eec-d55530c5db79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26092, 651, 640, 10, 30, "Input",ExpressionUUID->"66a05cd1-06bf-4b74-acd3-96a747a72aec"],
Cell[26735, 663, 175, 3, 30, "Input",ExpressionUUID->"c6865418-d4da-490a-b1d8-7cc127b150c5"],
Cell[26913, 668, 397, 6, 30, "Input",ExpressionUUID->"243de290-4f8f-488c-a7ab-4bbf641b4b9e"]
}, Open  ]],
Cell[27325, 677, 466, 7, 30, "Input",ExpressionUUID->"128b8742-3add-4612-9bad-094370216b0d"],
Cell[27794, 686, 912, 18, 52, "Input",ExpressionUUID->"6f23e589-ac84-495b-8fab-662473e3818f"]
}
]
*)

