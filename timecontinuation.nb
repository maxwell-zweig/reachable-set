(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    277599,       6565]
NotebookOptionsPosition[    274038,       6510]
NotebookOutlinePosition[    274438,       6526]
CellTagsIndexPosition[    274395,       6523]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "This", " ", "is", " ", "code", " ", "modified", " ", 
    "specifically", " ", "for", " ", "the", " ", "2", "d", " ", "case"}], " ",
    "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "the", " ", "directory", " ", "that", " ", "you", " ",
     "want", " ", "your", " ", "plots", " ", "to", " ", "go", " ", "to", " ", 
    "here"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "\"\</users/maxzweig/fuelthrust\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Solve", "::", "svars"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "lstol"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vectoangle", "[", "k_", "]"}], " ", ":=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"k", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "axes", " ", "for", " ", "the", " ", 
     "energy", " ", "limited", " ", "reachable", " ", "set", " ", 
     "associated", " ", "with", " ", "a", " ", "given", " ", "terminal", " ", 
     "time", " ", "and", " ", "thrust"}], " ", "**)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAxes", "[", 
     RowBox[{"terminaltime_", ",", " ", "quadform_", ",", " ", "thrustmax_"}],
      "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ax1", ",", "ax2"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "minimum", " ", "and", " ", "maximum", 
     " ", "ratios", " ", "between", " ", "an", " ", "energy", " ", "limited", 
     " ", "set", " ", "and", " ", "an", " ", "arbitrary", " ", "reachable", " ",
      "set", " ", "given", " ", "as", " ", "set", " ", "of", " ", "points"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reachablestatsoperator", "[", 
      RowBox[{"points_", ",", "axis1_", ",", "axis2_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "[", "points", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"points", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ellipseVecFromUnitVec", "[", 
          RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
           "uv"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ratio", "[", "pos_", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"ellipseVecFromUnitVec", "[", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", "axis1", ",",
              " ", "axis2"}], "]"}], " ", "]"}], "/", " ", 
          RowBox[{"Norm", "[", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminrat", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Max"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Min"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminvec", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Max"}]}], "    ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}], " ", ",", " ", 
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Min"}]}], "   ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rats", " ", "=", " ", 
         RowBox[{"maxminrat", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vecs", " ", "=", " ", 
         RowBox[{"maxminvec", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rats", " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", " ", 
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}]}]}],
       "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "computes", " ", "minimum", " ", "and", " ", "maximum", " ", "ratios", " ",
       "between", " ", "the", " ", "thrust", " ", "limited", " ", "and", " ", 
      
      RowBox[{"thrust", "/", "fuel"}], " ", "limited", " ", "reachable", " ", 
      "sets"}], ",", " ", 
     RowBox[{
     "given", " ", "as", " ", "a", " ", "set", " ", "of", " ", "points", " ", 
      "that", " ", "are", " ", "indexed", " ", "by", " ", "angle", " ", "in", 
      " ", "their", " ", 
      RowBox[{"arrays", ".", "\[IndentingNewLine]", "Assuming"}], " ", 
      "given", " ", "points", " ", "are", " ", "angle", " ", 
      RowBox[{"aligned", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"thrustfuelstats", "[", 
      RowBox[{"thrustpoints_", ",", " ", "fuelpoints_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListRatios", "[", 
          RowBox[{"list1_", ",", " ", "list2_"}], "]"}], " ", ":=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"list1", ",", "list2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ratios", " ", "=", " ", 
         RowBox[{"ListRatios", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "thrustpoints"}], "]"}], ",", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "fuelpoints"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Min"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "maxratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "minratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "maxpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "minpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
          "minpos"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"energyform", "[", 
      RowBox[{"tff_", ",", " ", "na_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c", ",", " ", "r", ",", " ", "sig", ",", " ", "gamma", ",", " ", 
         "nmat"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "n_", "]"}], " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{
              RowBox[{"-", "2"}], "*", " ", "n"}], ",", " ", "0", ",", " ", 
             "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", " ", "*", " ", "n"}], ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "0", " ", ",",
              " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", "0", ",", 
             "0"}], " ", "}"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", 
             "0"}], " ", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", " ", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "MatrixForm"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t_", ",", " ", "h_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"72", " ", "t", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"h", " ", "t"}], "]"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"154", " ", "h", " ", "t"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["h", "3"], " ", 
                 SuperscriptBox["t", "3"]}], "-", 
                RowBox[{"384", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                RowBox[{"27", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
               RowBox[{"4", " ", "h"}]]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "t", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"2", " ", "h", " ", "t"}], "+", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
              RowBox[{"4", " ", "h"}]], ",", "0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"26", " ", "h", " ", "t"}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              RowBox[{"4", " ", 
               SuperscriptBox["h", "3"]}]], ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"14", " ", "h", " ", "t"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "h", " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
               RowBox[{"4", " ", 
                SuperscriptBox["h", "3"]}]]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t", ",", " ", "n"}], "]"}], " ", "//", " ", "MatrixForm"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sig", "[", 
          RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "-", 
              RowBox[{"3", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"], ",", 
             FractionBox[
              RowBox[{"2", "-", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}]}], "n"], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "n"}], " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "1", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], "n"], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "t"}], "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", " ", "n", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", 
             RowBox[{"2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "0", ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}]}], "}"}]}], "}"}]}], ";", " ", 
        RowBox[{"(*", " ", "Good", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"t_", ",", " ", "t0_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"sig", "[", 
           RowBox[{"t", ",", " ", "n"}], "]"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sig", "[", 
             RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nmat", "[", 
          RowBox[{"t0_", ",", " ", "tf_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sig", "[", 
                RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
               "Inverse"}], ",", " ", 
              RowBox[{
               RowBox[{"-", " ", 
                RowBox[{"sig", "[", 
                 RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
               "Inverse"}], ",", " ", "2"}], "]"}], " ", "//", " ", 
            "Transpose"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "Transpose"}], 
           ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"tf", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}], ".", 
          RowBox[{"c", "[", "n", "]"}], ".", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sig", "[", 
              RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
             "Inverse"}], ",", " ", 
            RowBox[{
             RowBox[{"-", " ", 
              RowBox[{"sig", "[", 
               RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
             "Inverse"}], ",", " ", "2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nmat", "[", 
         RowBox[{"0", ",", " ", "tff", ",", " ", "na"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getFinalEnergyPos", "[", 
      RowBox[{
      "tt_", ",", " ", "tmax_", ",", " ", "nt_", ",", " ", "delta_", ",", " ",
        "rho_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "6", "]"}], " ", "-", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",",
             " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis", " ", "=", " ", 
         RowBox[{"Orthogonalize", "[", "udd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"projmat", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
            RowBox[{"basis", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;"}], "]"}], "]"}]}], "]"}], " ", "//", " ", 
          "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"projmatT", " ", "=", " ", 
         RowBox[{"projmat", " ", "//", " ", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"selectionMat", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eformxf", " ", "=", " ", 
         RowBox[{
          RowBox[{"energyform", "[", 
           RowBox[{"tt", ",", " ", "nt"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"7", ";;", "12"}], ",", " ", 
            RowBox[{"7", ";;", "12"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ydir", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eigenvectors", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projmatT", ".", "selectionMat", ".", "projmat"}], ",", 
             " ", 
             RowBox[{"projmatT", ".", "eformxf", ".", "projmat"}]}], "}"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"projmat", ".", "ydir"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmag", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tt", " ", "rho", " ", 
            RowBox[{
             RowBox[{"tmax", "^", "2"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{"xdir", ".", "eformxf", ".", "xdir"}], ")"}]}]}], ")"}],
           " ", "//", " ", "Sqrt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xdir", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"delta", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", "0"}], ",", 
           " ", 
           RowBox[{"-", "xdir"}], ",", " ", "xdir"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<energy computation executed\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "tmag"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostatev2", "[", 
     RowBox[{
     "ics_", ",", " ", "isp_", ",", " ", "tf_", ",", " ", "tmax_", ",", " ", 
      "A_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", ",",
           "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", 
          ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"(*", "-", "*)"}], 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"switchingfunc", "[", 
                 RowBox[{
                 "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                   " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
               "2"}]}], ")"}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{"(*", 
           RowBox[{"(", "-", ")"}], "*)"}], 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", "/",
            " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", "  ", 
        RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], "\[Equal]",
               "ics"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "vars", ",",
           "  ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tf", ",", " ", "tf"}], "}"}], ",", " ", 
          RowBox[{"Method", " ", "->", " ", "\"\<BDF\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "tf", "]"}], "&"}], "/@", "soln"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostateRecoder", "[", 
     RowBox[{
     "ics_", ",", " ", "isp_", ",", " ", "tf_", ",", " ", "tmax_", ",", " ", 
      "A_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", ",",
           "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", 
          ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"(*", "-", "*)"}], 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], " ", "+", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"switchingfunc", "[", 
                 RowBox[{
                 "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                   " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
               "2"}]}], ")"}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{"(*", 
           RowBox[{"(", "-", ")"}], "*)"}], 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", "/",
            " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"switches", " ", "=", "  ", 
        RowBox[{"Reap", "[", 
         RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
               RowBox[{"(", 
                RowBox[{"dyn", "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"vars", "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                    ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], 
               "\[Equal]", "ics"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "vars", ",", "  ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "tf"}], "}"}], ",", " ", 
           RowBox[{"Method", " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<EventLocator\>\"", ",", " ", 
              RowBox[{"\"\<Event\>\"", " ", "->", " ", 
               RowBox[{"switchingfunc", "[", 
                RowBox[{
                 RowBox[{"lxv", "[", "t", "]"}], ",", " ", 
                 RowBox[{"lyv", "[", "t", "]"}], ",", " ", 
                 RowBox[{"lzv", "[", "t", "]"}], " ", ",", " ", 
                 RowBox[{"lm", "[", "t", "]"}], ",", " ", 
                 RowBox[{"m", "[", "t", "]"}], ",", " ", "isp"}], "]"}]}], ",",
               " ", 
              RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
               RowBox[{"Sow", "[", "t", "]"}]}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "switches"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findInitialCostates", "[", 
     RowBox[{
     "icRel_", ",", " ", "fcRel_", ",", " ", "n_", ",", " ", "A_", ",", " ", 
      "td_", ",", " ", "mmax_", ",", " ", "m0_", ",", " ", "tmax_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "-", 
         " ", 
         RowBox[{"{", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{
          "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
           "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getInitCostates", "[", 
         RowBox[{"varMat_", ",", "icsRel_", ",", "fcsRel_"}], "]"}], ":=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{"varMat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "6"}], ",", 
             RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], ",", 
          RowBox[{"fcsRel", "-", 
           RowBox[{
            RowBox[{"varMat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "6"}], ",", 
               RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], ".", "icsRel"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"topLeftMatrix", "=", "A"}], ";", "\[IndentingNewLine]", 
       RowBox[{"topRightMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleRightMatrix", "=", 
        RowBox[{"-", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"bottomRightMatrix", "=", 
        RowBox[{
         RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bottomLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"A", ",", " ", 
            RowBox[{"Join", "[", " ", 
             RowBox[{"topRightMatrix", ",", " ", 
              RowBox[{"Join", "[", 
               RowBox[{
               "middleLeftMatrix", ",", " ", "middleRightMatrix", ",", " ", 
                "2"}], "]"}]}], "]"}], ",", " ", "2"}], "]"}], ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
           "bottomLeftMatrix", ",", " ", "bottomRightMatrix", ",", " ", "2"}],
            " ", "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stm", "[", "tf_", "]"}], " ", ":=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"fullmatrix", " ", "tf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initCo", " ", "=", " ", 
        RowBox[{"getInitCostates", "[", 
         RowBox[{
          RowBox[{"stm", "[", "td", "]"}], ",", " ", "icRel", ",", " ", 
          "fcRel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lambdastm", "[", "ta_", "]"}], " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}], ")"}], " ", 
          "ta"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lma", " ", "=", " ", 
        RowBox[{
         RowBox[{"isp", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lambdastm", "[", 
                 RowBox[{"mmax", " ", 
                  RowBox[{"isp", " ", "/", " ", "tmax"}]}], "]"}], ".", 
                "initCo"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "6"}], "]"}], "]"}], "   ", "//", " ", 
             "Norm"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"m0", " ", "-", " ", "mmax"}], ")"}]}]}], " ", "-", " ", 
         RowBox[{"NIntegrate", "[", "  ", 
          RowBox[{
           RowBox[{"tmax", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"lambdastm", "[", "t", "]"}], ".", "initCo"}], 
                  ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], " ", "//", 
               " ", "Norm"}], ")"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m0", " ", "-", " ", 
                 RowBox[{"tmax", " ", 
                  RowBox[{"t", " ", "/", " ", "isp"}]}]}], ")"}], " ", "^", 
               "2"}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", 
             RowBox[{"mmax", " ", 
              RowBox[{"isp", " ", "/", " ", "tmax"}]}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initCoM", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"initCo", ",", " ", 
          RowBox[{"{", "lma", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "initCoM"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfind", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", 
      "tm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
          "timeLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ly", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cons", "[", 
         RowBox[{
         "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_"}], "]"}],
         " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"udd", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-",
              " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", 
              RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"udd", ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c2", " ", "=", "  ", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"timeLength", " ", 
                RowBox[{"tm", " ", "/", " ", "isp"}]}], "<=", "mmax"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m0", " ", "-", " ", 
                   RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                 RowBox[{"timeLength", " ", 
                  RowBox[{"tm", " ", "/", " ", "isp"}]}]}], ")"}], "}"}], ",",
               " ", 
              RowBox[{"{", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m0", " ", "-", " ", 
                   RowBox[{"xf", "[", 
                    RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                 "mmax"}], ")"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
            "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", "ly", ",", 
                    " ", "0"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", "ly"}]}], "}"}]}]}], " ", "]"}], 
                  ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm", ",", 
              " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "->", "20"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", "ly", ",", " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "2"}], "]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindalt2", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", 
      "tm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
          "timeLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lx", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cons", "[", 
         RowBox[{
         "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_"}], "]"}],
         " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"udd", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-",
              " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], 
               ")"}], ".", 
              RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"udd", ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{"c2", " ", "=", "  ", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"timeLength", " ", 
                RowBox[{"tm", " ", "/", " ", "isp"}]}], "<=", "mmax"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                RowBox[{"timeLength", " ", 
                 RowBox[{"tm", " ", "/", " ", "isp"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"m0", " ", "-", " ", 
                  RowBox[{"xf", "[", 
                   RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
                "mmax"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
            "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lx", " ", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", "lx"}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], " ", "]"}],
                   ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm", ",", 
              " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "->", "20"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"lx", ",", " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "2"}], "]"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindaug", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "fuelpercent_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{"rootfind", "[", 
         RowBox[{"init", ",", "  ", 
          RowBox[{"tm", " ", "fuelpercent", " ", 
           RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ",", " ", 
          "direction", ",", " ", "A", ",", " ", "m0", ",", " ", "isp", ",", 
          " ", "timeLength", ",", " ", "tm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tm", ",", 
          " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"terminalMass", " ", "=", " ", 
        RowBox[{"m0", " ", "-", " ", 
         RowBox[{"out", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"terminalAngle", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
            " ", 
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",", 
          " ", "10000", ",", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"out", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"out", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ", "&&",
             " ", 
            RowBox[{
             RowBox[{"out", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], "  ",
           "||", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"terminalMass", " ", "/", " ", 
              RowBox[{"(", 
               RowBox[{"tm", " ", "fuelpercent", " ", 
                RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ")"}]}], " ", 
             "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||", 
          " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", "-",
              " ", 
             RowBox[{"Mod", "[", 
              RowBox[{"nextAngle", ",", " ", 
               RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ", 
           "0.00125"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"rootfindalt2", "[", 
             RowBox[{"init", ",", "  ", 
              RowBox[{"tm", " ", "fuelpercent", " ", 
               RowBox[{"timeLength", " ", "/", " ", "isp"}]}], ",", " ", 
              "direction", ",", " ", "A", ",", " ", "m0", ",", " ", "isp", ",",
               "timeLength", ",", " ", "tm"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out3", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "timeLength", ",", " ", 
              "tm", ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "res"}], "\[IndentingNewLine]", ")"}], ",", "lxm2"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getReachablePoint", "[", 
     RowBox[{
     "direction_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_", ",",
       " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posf", " ", "=", " ", 
        RowBox[{"getFinalEnergyPos", "[", 
         RowBox[{
         "endTime", ",", " ", "tmax", ",", " ", "n", ",", " ", "direction", ",",
           " ", "fuelpercent"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initCostates", " ", "=", " ", 
        RowBox[{"findInitialCostates", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
           "}"}], ",", " ", "posf", ",", " ", "n", ",", " ", "A", ",", " ", 
          "endTime", ",", " ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",", 
          " ", 
          RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialGuess2", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"initCostates", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<root finding\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{"rootfind", "[", 
         RowBox[{"initialGuess2", ",", "  ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
          RowBox[{"direction", " ", "//", " ", "N"}], ",", " ", "A", ",", " ",
           "m0", ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax", ",",
           " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", "  ", "Norm"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
         "Normalize"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"direction", " ", "//", " ", "N"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "lxm2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveBVPsNested", "[", 
     RowBox[{
     "initialAngle_", ",", " ", "initialGuess_", ",", " ", "endTime_", ",", 
      " ", "tmax_", ",", " ", "n_", ",", " ", "m0_", ",", " ", "A_", ",", " ",
       "fuelpercent_", ",", " ", "isp_", ",", " ", "numPoints_"}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "initialAngle", ",", " ", "\"\< \>\"", ",", "  ", "initialGuess", ",",
          " ", "\"\< \>\"", ",", " ", "endTime", ",", " ", "\"\< \>\"", ",", 
         " ", "tmax", ",", " ", "\"\< \>\"", ",", " ", "n", ",", 
         " ", "\"\< \>\"", ",", " ", "m0", ",", " ", "\"\< \>\"", ",", " ", 
         "A", ",", " ", "\"\< \>\"", ",", " ", "fuelpercent", ",", 
         " ", "\"\< \>\"", ",", " ", "isp", ",", " ", "\"\< \>\"", ",", " ", 
         "numPoints"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevPosition", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{"2", " ", "*", " ", 
              RowBox[{"Pi", " ", "/", " ", "numPoints"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prevCostate", " ", "==", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
              RowBox[{
               RowBox[{"findInitialCostates", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                  "}"}], ",", " ", 
                 RowBox[{"getFinalEnergyPos", "[", 
                  RowBox[{"endTime", ",", " ", "tmax", "  ", 
                   RowBox[{"(*", "*)"}], ",", " ", "n", ",", " ", 
                   "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                 " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                 RowBox[{"tmax", " ", "fuelpercent", " ", 
                  RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0",
                  ",", " ", 
                 RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
               "]"}], ",", " ", "prevCostate"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nextGuess", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lxm2", " ", "=", " ", 
            RowBox[{"rootfind", "[", 
             RowBox[{"nextGuess", ",", "  ", 
              RowBox[{"tmax", " ", "fuelpercent", " ", 
               RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
              "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", "isp",
               ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalMass", " ", "=", " ", 
            RowBox[{"m0", " ", "-", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "retrying", " ", "with", " ", "energy", " ", "optimal", 
             " ", "initial", " ", "guess", " ", "if", " ", "necessary"}], 
            "**)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"nextGuessReturn", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ",
                   "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"nextAngle", ",", " ", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", "<", " ",
                 "0.00125"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"terminalMass", " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                   "-", " ", "1"}], "]"}], " ", "<", " ", "0.01"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "  ", "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rootfind", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"findInitialCostates", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", " ", 
                   RowBox[{"getFinalEnergyPos", "[", 
                    RowBox[{
                    "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ",
                     "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                   " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "m0", ",", " ", 
                   RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
                 "]"}], ",", "  ", 
                RowBox[{"tmax", " ", "fuelpercent", " ", 
                 RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                "isp", ",", " ", "endTime", ",", " ", "tmax"}], " ", "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"out2", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "if", " ", "still", " ", "failure", " ", "to", " ", 
              "perfectly", " ", "satisfy", " ", "constraints"}], ",", " ", 
             RowBox[{
             "retrying", " ", "with", " ", "alternate", " ", "optimization", " ",
               "holding", " ", "x", " ", "constant", " ", "and", " ", 
              "allowing", " ", "changes", " ", "in", " ", "y"}]}], " ", 
            "**)"}], "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ",
                 "&&", " ", 
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], 
              "  ", "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"terminalMass", " ", "/", " ", 
                  RowBox[{"(", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                  "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||",
               " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", 
                 "-", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"nextAngle", ",", " ", 
                   RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ",
                "0.00125"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"res", " ", "=", " ", 
                RowBox[{"rootfindalt2", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], " ", "}"}], ",", "  ", 
                  RowBox[{"tmax", " ", "fuelpercent", " ", 
                   RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                  "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                  "isp", ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"out3", " ", "=", " ", 
                RowBox[{"propStateCostatev2", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                    "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                  "tmax", ",", " ", "A"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nextAngle", ",", " ", "res", " ", ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"{", 
            RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "**)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"initialAngle", ",", " ", "initialGuess", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", " ", "numPoints"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveBVPsNestedAlt", "[", 
     RowBox[{
     "initialGuess_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_",
       ",", " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_", ",", " ", "numPoints_", ",", " ", "lb_", ",", " ", "ub_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "lb", ",", " ", "\"\< \>\"", ",", " ", "ub", ",", " ", "\"\< \>\"", ",",
          "initialGuess", ",", " ", "\"\< \>\"", ",", " ", "endTime", ",", 
         " ", "\"\< \>\"", ",", " ", "tmax", ",", " ", "\"\< \>\"", ",", " ", 
         "n", ",", " ", "\"\< \>\"", ",", " ", "m0", ",", " ", "\"\< \>\"", ",",
          " ", "A", ",", " ", "\"\< \>\"", ",", " ", "fuelpercent", ",", 
         " ", "\"\< \>\"", ",", " ", "isp", ",", " ", "\"\< \>\"", ",", " ", 
         "numPoints"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevPosition", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ub", " ", "-", " ", "lb"}], ")"}], " ", "/", " ", 
              "numPoints"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prevCostate", " ", "==", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
              RowBox[{
               RowBox[{"findInitialCostates", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                  "}"}], ",", " ", 
                 RowBox[{"getFinalEnergyPos", "[", 
                  RowBox[{
                  "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ", 
                   "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                 " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                 RowBox[{"tmax", " ", "fuelpercent", " ", 
                  RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0",
                  ",", " ", 
                 RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
               "]"}], ",", " ", "prevCostate"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nextGuess", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
              RowBox[{"nextCostate", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lxm2", " ", "=", " ", 
            RowBox[{"rootfind", "[", 
             RowBox[{"nextGuess", ",", "  ", 
              RowBox[{"tmax", " ", "fuelpercent", " ", 
               RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
              "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", "isp",
               ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"terminalMass", " ", "=", " ", 
            RowBox[{"m0", " ", "-", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "retrying", " ", "with", " ", "energy", " ", "optimal", 
             " ", "initial", " ", "guess", " ", "if", " ", "necessary"}], 
            "**)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"nextGuessReturn", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ",
                   "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"nextAngle", ",", " ", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", "<", " ",
                 "0.00125"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"terminalMass", " ", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                   "-", " ", "1"}], "]"}], " ", "<", " ", "0.01"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                RowBox[{"lxm2", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "  ", "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"rootfind", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"findInitialCostates", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", " ", 
                   RowBox[{"getFinalEnergyPos", "[", 
                    RowBox[{
                    "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ",
                     "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                   " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "m0", ",", " ", 
                   RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
                 "]"}], ",", "  ", 
                RowBox[{"tmax", " ", "fuelpercent", " ", 
                 RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                "isp", ",", " ", "endTime", ",", " ", "tmax"}], " ", "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"out2", " ", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                    " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "if", " ", "still", " ", "failure", " ", "to", " ", 
              "perfectly", " ", "satisfy", " ", "constraints"}], ",", " ", 
             RowBox[{
             "retrying", " ", "with", " ", "alternate", " ", "optimization", " ",
               "holding", " ", "x", " ", "constant", " ", "and", " ", 
              "allowing", " ", "changes", " ", "in", " ", "y"}]}], " ", 
            "**)"}], "\[IndentingNewLine]", 
           RowBox[{"terminalAngle", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], " ", "&&",
                " ", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "==", " ", "0"}]}], ",",
               " ", "10000", ",", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"out2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"out2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "==", " ", "0"}], "  ",
                 "&&", " ", 
                RowBox[{
                 RowBox[{"out2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}]}], ")"}], 
              "  ", "||", " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"terminalMass", " ", "/", " ", 
                  RowBox[{"(", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}]}], " ",
                  "-", " ", "1"}], "]"}], " ", ">=", " ", "0.001"}], " ", "||",
               " ", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"terminalAngle", " ", "+", " ", "Pi"}], ")"}], " ", 
                 "-", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{"nextAngle", ",", " ", 
                   RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}], " ", ">=", " ",
                "0.00125"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"res", " ", "=", " ", 
                RowBox[{"rootfindalt2", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"nextGuessReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], " ", "}"}], ",", "  ", 
                  RowBox[{"tmax", " ", "fuelpercent", " ", 
                   RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                  "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                  "isp", ",", " ", "endTime", ",", " ", "tmax"}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"out3", " ", "=", " ", 
                RowBox[{"propStateCostatev2", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"res", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                    "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                  "tmax", ",", " ", "A"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nextAngle", ",", " ", "res", " ", ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
                 RowBox[{"out3", "[", 
                  RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"out2", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"{", 
            RowBox[{"nextAngle", ",", " ", "nextGuessReturn", ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out2", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "**)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"lb", ",", " ", "initialGuess", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", " ", "numPoints"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"energyBVPsNested", "[", 
     RowBox[{
     "initialAngle_", ",", " ", "initialGuess_", ",", " ", "endTime_", ",", 
      " ", "tmax_", ",", " ", "n_", ",", " ", "m0_", ",", " ", "A_", ",", " ",
       "fuelpercent_", ",", " ", "isp_", ",", " ", "numPoints_"}], "]"}], " ",
     ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "*", " ", "returns", " ", "the", " ", "direction", " ", "the", " ", 
         "initial", " ", "costate", " ", "was", " ", "computed", " ", "in"}], 
        ",", " ", 
        RowBox[{
        "as", " ", "well", " ", "as", " ", "the", " ", "initial", " ", 
         "costate", " ", "\[IndentingNewLine]", "\t", "initialGuess", " ", 
         "contains", " ", "all", " ", "of", " ", "the", " ", 
         RowBox[{"costates", ".", " ", "\[IndentingNewLine]", "  ", "If"}], " ",
          "prevDirectionCostate", " ", "costate", " ", "is", " ", 
         "identically", " ", "0"}], ",", " ", 
        RowBox[{
        "do", " ", "the", " ", "energy", " ", "computation", " ", "to", " ", 
         "obtain", " ", "an", " ", "initial", " ", 
         RowBox[{"guess", ".", " ", "\[IndentingNewLine]", "  ", "Homotopy"}],
          " ", "from", " ", "delta", " ", "to", " ", "delta", " ", "to", " ", 
         "travese", " ", "the", " ", 
         RowBox[{
          RowBox[{"ring", ".", " ", "If"}], " ", "/", " ", "when"}], " ", 
         "constraint", " ", 
         RowBox[{"isn", "'"}], "t", " ", "satisfied"}], ",", " ", 
        RowBox[{
        "perform", " ", "the", " ", "energy", " ", "computation", " ", "to", " ",
          "obtain", " ", "a", " ", "new", " ", "initial", " ", "guess", " ", 
         "and", " ", "try", " ", 
         RowBox[{"again", "."}]}]}], "\[IndentingNewLine]", "**)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
         " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"prevAngle", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"prevCostate", " ", "=", " ", 
            RowBox[{"prevAngleCostatePosition", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"nextAngle", " ", "=", " ", 
            RowBox[{"prevAngle", " ", "+", " ", 
             RowBox[{"2", " ", "*", " ", 
              RowBox[{"Pi", " ", "/", " ", "numPoints"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextDirection", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
               RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", 
             " ", "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "computing", " ", "the", " ", "next", " ", "energy", " ",
              "optimal", " ", "initial", " ", "costate"}], " ", "**)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"nextCostate", " ", "=", " ", 
            RowBox[{
             RowBox[{"findInitialCostates", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", " ", 
               RowBox[{"getFinalEnergyPos", "[", 
                RowBox[{"endTime", ",", " ", "tmax", " ", 
                 RowBox[{"(*", "*)"}], ",", " ", "n", ",", " ", 
                 "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", " ", 
               "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
               RowBox[{"tmax", " ", "fuelpercent", " ", 
                RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",",
                " ", 
               RowBox[{"tmax", " ", "/", " ", "m0"}]}], " ", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"nextCostate", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
             "nextAngle"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NestList", "[", 
        RowBox[{"bvpNester", ",", " ", 
         RowBox[{"{", 
          RowBox[{"initialGuess", ",", " ", "initialAngle"}], "}"}], ",", " ",
          "numPoints"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computestats", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "fuelpercent", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds2", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "1", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses2", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs2", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augMessRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses2", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rats", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"addRem", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"rats", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
               ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
         "augRemIndices", ",", " ", "removalIndices", ",", " ", 
          "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
          "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"thrustfuelstats", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeStatsAlt", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "lb_", ",", " ", "ub_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num", ",", " ", 
           "lb", ",", " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds2", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "1", ",", " ", "isp", ",", " ", "num", ",", " ", "lb", ",", 
           " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses2", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs2", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"augMessRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses2", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"rats", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"addRem", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"rats", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
               ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
         "augRemIndices", ",", " ", "removalIndices", ",", " ", 
          "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
          "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"thrustfuelstats", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeEnergyFuelStats", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "mo_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "quadform_", ",", " ", "lb_", ",", " ", "ub_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNestedAlt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num", ",", " ", 
           "lb", ",", " ", "ub"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{"removalIndices", ",", " ", "massRemIndices"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reachablestatsoperator", "[", 
        RowBox[{
         RowBox[{"testxfs", "[", 
          RowBox[{"[", "remInds", "]"}], "]"}], ",", "ax1", ",", "ax2"}], " ",
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeMaxMag", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norms", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", "testxfs"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"norms", " ", "//", " ", "Max"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "plots", " ", "the", " ", "thrust", " ", "or", " ", "fuel", " ",
      "limited", " ", "reachable", " ", "set", " ", 
     RowBox[{"alone", "."}]}], "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotthrustfuel", "[", 
      RowBox[{
      "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
        " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ",
      ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
              " ", "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
              "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", " ", 
              RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
             " ", "0", ",", " ", 
             RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
             RowBox[{
              RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", 
             RowBox[{"-", 
              RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
             " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testbounds", " ", "=", " ", 
         RowBox[{
          RowBox[{"solveBVPsNested", "[", 
           RowBox[{
            RowBox[{"Pi", "/", "4"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
             " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
             " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"testbounds2", " ", "=", " ", 
         RowBox[{
          RowBox[{"solveBVPsNested", "[", 
           RowBox[{
            RowBox[{"Pi", "/", "4"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
             " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
             " ", "1", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "testbounds3"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"solveBVPsNested", "[", 
             RowBox[{
              RowBox[{"Pi", "/", "4"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", 
              ",", " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", 
              "A", ",", " ", "0.775", ",", " ", "isp", ",", " ", "num"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"testbounds4", " ", "=", " ", 
           RowBox[{
            RowBox[{"solveBVPsNested", "[", 
             RowBox[{
              RowBox[{"Pi", "/", "4"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", 
              ",", " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", 
              "A", ",", " ", "0.875", ",", " ", "isp", ",", " ", "num"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";"}], " ", 
         "\[IndentingNewLine]", "**)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "code", " ", "to", " ", "compute", " ", "energy", " ", "optimal", " ",
           "costates"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<doing energy costate computation\>\"", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"vals", " ", "=", " ", 
           RowBox[{"energyBVPsNested", "[", 
            RowBox[{
             RowBox[{"Pi", "/", "4"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
              " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", 
             ",", " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"testECostates", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"vals", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"angles", " ", "=", " ", 
           RowBox[{
            RowBox[{"vals", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", "2"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"magnitudes", " ", "=", " ", 
           RowBox[{"Norm", " ", "/@", " ", "testECostates"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eangles", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
            "testECostates"}]}], ";"}], "\[IndentingNewLine]", "**)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"testmasses", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testmasses2", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testxfs", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"testxfs2", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "testmasses3"}], " ", "=", " ", 
           RowBox[{"testbounds3", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"testmasses4", " ", "=", " ", 
           RowBox[{"testbounds4", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"testxfs3", " ", "=", " ", 
           RowBox[{"testbounds3", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"testxfs4", " ", "=", " ", 
           RowBox[{"testbounds4", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Max", "[", 
          RowBox[{"Norm", " ", "/@", " ", 
           RowBox[{"testxfs", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", " ", 
              RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idxmaxfull", " ", "=", " ", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"Norm", " ", "/@", " ", 
             RowBox[{"testxfs", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", "1"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxdirfull", " ", "=", " ", 
         RowBox[{"testxfs", "[", 
          RowBox[{"[", 
           RowBox[{"idxmaxfull", ",", " ", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"idxmaxfull2", " ", "=", " ", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"Norm", " ", "/@", " ", 
             RowBox[{"testxfs2", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", "1"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"maxdirfull2", " ", "=", " ", 
         RowBox[{"testxfs2", "[", 
          RowBox[{"[", 
           RowBox[{"idxmaxfull2", ",", " ", 
            RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"maxdirfull2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"maxdirfull2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", " ", 
         "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"directions", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"directionsfullthrust", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costates", " ", "=", " ", 
         RowBox[{"testbounds", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costatesfullthrust", " ", "=", " ", 
         RowBox[{"testbounds2", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"costatedirections", " ", "=", " ", 
         RowBox[{"costates", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", 
            RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"costatemasses", " ", "=", " ", 
         RowBox[{"costates", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"costateratios", " ", "=", " ", 
         RowBox[{"costatemasses", " ", "/", " ", 
          RowBox[{"(", 
           RowBox[{"Norm", " ", "/@", " ", "costatedirections"}], ")"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"costateangles", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
          "costatedirections"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "directions"}], " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcTan", " ", "@@", " ", "#"}], " ", "&"}], " ", "/@", 
            " ", "directions"}]}], ";"}], "**)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"l1", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directions", " ", "/", " ", 
               RowBox[{"(", 
                RowBox[{"2", " ", "Pi"}], ")"}]}], ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{"costateangles", ",", " ", 
                RowBox[{"2", " ", "Pi"}]}], "]"}]}], " ", "}"}], " ", "//", 
            " ", "Transpose"}], ",", " ", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Target Angle (rads)\>\"", 
              ",", "\"\<Initial Angle (rads) \>\""}], "}"}]}]}], " ", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            
            RowBox[{"\"\<costatedirectiongraph``.png\>\"", ",", " ", 
             "endTime"}], "]"}], " ", "//", " ", "ToString"}], ",", "  ", 
          "l1"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l2", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"directions", ",", " ", "costateratios"}], "}"}], " ", "//",
            " ", "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<costateratiograph''.png\>\"", ",", " ", "endTime"}], 
            "]"}], " ", "//", " ", "ToString"}], ",", " ", "l2"}], "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"l3", " ", "=", " ", 
         RowBox[{"ListLinePlot", "[", "directions", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<directions''.png\>\"", ",", " ", "endTime"}], "]"}], 
           " ", "//", " ", "ToString"}], ",", " ", "l3"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"*", "\[IndentingNewLine]", "l4"}], " ", "=", " ", 
           RowBox[{"ListLinePlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"Mod", "[", 
                    RowBox[{"costateangles", ",", " ", 
                    RowBox[{"2", "Pi"}]}], "]"}], "]"}]}], ")"}], " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"costateangles", ",", 
                    RowBox[{"2", "Pi"}]}], "]"}], " ", "-", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{"eangles", ",", 
                    RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}]}]}], "}"}], 
             " ", "//", " ", "Transpose"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<relerrors``.png\>\"", ",", " ", "endTime"}], "]"}],
              " ", "//", " ", "ToString"}], ",", " ", "l4"}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<maximum departure: \>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"Abs", "[", 
                RowBox[{"Mod", "[", 
                 RowBox[{"costateangles", ",", " ", 
                  RowBox[{"2", "Pi"}]}], "]"}], "]"}]}], ")"}], " ", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"costateangles", ",", 
                 RowBox[{"2", "Pi"}]}], "]"}], " ", "-", " ", 
               RowBox[{"Mod", "[", 
                RowBox[{"eangles", ",", 
                 RowBox[{"2", " ", "Pi"}]}], "]"}]}], "]"}]}], "]"}], "]"}], 
          ";"}], " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"removalIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ",
           "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"augRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Norm", ",", " ", "testxfs2"}], "]"}], ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ",
           "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"massRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"testmasses", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"#", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                  " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
           " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"augMessRemIndices", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"testmasses2", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"#", "/", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], "<=", 
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
           " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"rats", " ", "=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "-", " ", 
              RowBox[{"ArcTan", "[", 
               RowBox[{
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], " ", "&"}],
            ",", " ", 
           RowBox[{"{", 
            RowBox[{"testxfs", ",", " ", "testxfs2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"addRem", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"rats", ",", " ", 
            RowBox[{"_", "?", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", "#", "]"}], " ", "<", " ", "0.01"}], 
                ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//", "Flatten"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"remInds", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{
          "augRemIndices", ",", " ", "removalIndices", ",", " ", 
           "massRemIndices", ",", " ", "augMessRemIndices", ",", " ", 
           "addRem"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
           "minpos"}], "}"}], " ", "=", " ", 
         RowBox[{"thrustfuelstats", "[", 
          RowBox[{
           RowBox[{"testxfs", "[", 
            RowBox[{"[", "remInds", "]"}], "]"}], ",", " ", 
           RowBox[{"testxfs2", "[", 
            RowBox[{"[", "remInds", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "maxratio", ",", " ", "\"\< \>\"", ",", " ", "minratio", ",", 
          " ", "\"\< \>\"", ",", " ", 
          RowBox[{"maxpos", " ", "//", " ", "Normalize"}], ",", " ", 
          RowBox[{"minpos", " ", "//", " ", "Normalize"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"testbounds", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"testxfs", ",", " ", "testxfs2"}], 
          RowBox[{"(*", 
           RowBox[{",", " ", "testxfs3", ",", " ", "testxfs4"}], " ", "*)"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"flipTransformation", "=", 
         RowBox[{"ReflectionTransform", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"plot", " ", "=", "  ", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"GeometricTransformation", "[", 
               RowBox[{
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Point", "[", 
                   RowBox[{"testbounds", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", " ", 
                    RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}],
                   ",", "flipTransformation"}], "]"}], ",", 
                RowBox[{"ScalingTransform", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}],
               "]"}], ",", " ", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Red", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                  " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
             " ", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Red", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                   "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
              "]"}], ",", " ", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                  " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", " ", 
                RowBox[{"GeometricTransformation", "[", 
                 RowBox[{
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                   "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
              "]"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
             RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
             RowBox[{
             "PlotLabel", " ", "->", 
              " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
             RowBox[{"AxesLabel", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
               "}"}]}]}], "]"}], ",", " ", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"LineLegend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
               RowBox[{"{", 
                
                RowBox[{"\"\<Minimum Ratio\>\"", 
                 ",", "\"\<Maximum Ratio\>\""}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
         "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<RRStttb``.png\>\"", ",", " ", "endTime"}], "]"}], 
           " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "directions", ",", " ", "directionsfullthrust", ",", " ", "costates",
           ",", " ", "costatesfullthrust"}], "}"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotenergyfuel", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_", ",", " ", 
      "quadform_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"endTime", " ", "fuelpercent", " ", 
             RowBox[{"thrustmax", " ", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2length", " ", "=", " ", 
        RowBox[{"Norm", "[", "ax2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ellipseVecFromUnitVec", "[", 
         RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
               "2"}], "/", 
             RowBox[{
              RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
          "uv"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", "  ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{
           RowBox[{"Pi", "/", "4"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"removalIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "testxfs"}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "!=", "0"}], ")"}], "&"}], ")"}]}]}], "]"}], " ", 
         "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"massRemIndices", " ", "=", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"testmasses", ",", " ", 
           RowBox[{"_", "?", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "/", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"thrustmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ")"}], " ", "-",
                     " ", "m0"}], ")"}]}], "]"}], " ", "-", " ", "1"}], " ", "<=",
                 " ", "0.001"}], ")"}], " ", "&"}], ")"}]}]}], "]"}], " ", "//",
          " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remInds", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{"removalIndices", ",", " ", "massRemIndices"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"teststats", " ", "=", " ", 
        RowBox[{"reachablestatsoperator", "[", 
         RowBox[{
          RowBox[{"testxfs", "[", 
           RowBox[{"[", "remInds", "]"}], "]"}], ",", "ax1", ",", "ax2"}], 
         " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "teststats", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"ax1length", ",", " ", "ax2length"}], " ", 
                    "}"}]}], "]"}], ",", " ", 
                   RowBox[{"RotationTransform", "[", 
                    RowBox[{"ax1", " ", "//", " ", "vectoangle"}], "]"}]}], 
                  "]"}], ",", " ", "flipTransformation"}], "]"}], ",", " ", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Point", "[", 
                  RowBox[{"testxfs", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", " ", 
                    RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}],
                  ",", "flipTransformation"}], "]"}], ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", 
                    RowBox[{"ellipseVecFromUnitVec", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "/", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"teststats", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", " ", "2"}], "]"}], "]"}], "]"}]}], ",", 
                    "ax1", ",", "ax2"}], "]"}]}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Energy and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"PlotLegends", " ", "->", " ", 
             RowBox[{"{", 
              
              RowBox[{"\"\<Energy Limited\>\"", ",", 
               " ", "\"\<Thrust Limited\>\"", ",", 
               " ", "\"\<Maximum Ratio\>\"", ",", 
               " ", "\"\<Minimum Ratio\>\""}], " ", "}"}]}], ",", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", 
                ",", "\"\<Maximum Ratio\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<energyfuel``.png\>\"", ",", " ", "endTime"}], "]"}], 
          " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9522861895468063`*^9, 3.9522861898199377`*^9}, {
   3.952286798273657*^9, 3.952286805975416*^9}, {3.952286921223054*^9, 
   3.952286942661222*^9}, {3.9522871876648893`*^9, 3.9522872082522383`*^9}, 
   3.952287501825296*^9, {3.952290472087657*^9, 3.9522904742648993`*^9}, {
   3.952293106009499*^9, 3.95229312708536*^9}, 3.9522931914741488`*^9, {
   3.9522932230855503`*^9, 3.952293279043066*^9}, {3.952293337820467*^9, 
   3.952293437471656*^9}, {3.9522935394640617`*^9, 3.952293569761074*^9}, {
   3.952293761093302*^9, 3.952293761321594*^9}, {3.952297554298175*^9, 
   3.9522976029996243`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5c101b50-c06f-4166-9a70-caa4dcef817c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu1", " ", "=", " ", 
   RowBox[{"3.986", " ", 
    RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", "360"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mu1", " ", "/", " ", 
      RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isp", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmaxval", " ", "=", " ", "0.002"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fuelpercent", " ", "=", "0.675"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[27]:=",ExpressionUUID->"b9423ae2-e811-4fe1-9b31-5a21383bd0ad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"directioncostatemap", " ", "=", " ", 
   RowBox[{"plotthrustfuel", "[", 
    RowBox[{"tmaxval", ",", "n", ",", " ", 
     RowBox[{"Pi", " ", "/", " ", "n"}], ",", " ", "m0", ",", " ", 
     "fuelpercent", ",", " ", "isp", ",", "  ", "2000"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9522863106375637`*^9, 3.952286315726931*^9}, {
  3.9522868199792147`*^9, 3.952286839260639*^9}, {3.9522871279822063`*^9, 
  3.952287133017277*^9}, {3.952288121790124*^9, 3.952288124026751*^9}, {
  3.9522936651765757`*^9, 3.952293665370391*^9}, {3.952294365394684*^9, 
  3.9522943664061813`*^9}, {3.952294869023204*^9, 3.9522948785442038`*^9}, {
  3.9522954893023367`*^9, 3.952295489650769*^9}, {3.952295865580637*^9, 
  3.952295874281865*^9}, {3.9522982496156893`*^9, 3.95229825316582*^9}, {
  3.952298665978862*^9, 3.952298680683875*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"59cd509c-5a94-49c5-b826-2fd28b3e5208"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Pi]", "4"], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "3414.684797148121`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "0.002`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "0.0009200242014178264`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "2.5393335935835275`*^-6", ",", "0", ",", "0", ",", "0", ",", 
       "0.0018400484028356528`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.0018400484028356528`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "8.464445311945092`*^-7"}], ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "0.675`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "10000", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2000"}],
  SequenceForm[
  Rational[1, 4] Pi, " ", {0, 0, 0}, " ", 3414.684797148121, " ", 0.002, " ", 
   0.0009200242014178264, " ", 1, 
   " ", {{0, 0, 0, 1, 0, 0}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 1}, {
    2.5393335935835275`*^-6, 0, 0, 0, 0.0018400484028356528`, 0}, {
    0, 0, 0, -0.0018400484028356528`, 0, 0}, {
    0, 0, -8.464445311945092*^-7, 0, 0, 0}}, " ", 0.675, " ", 10000, " ", 
   2000],
  Editable->False]], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522986841366158`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"85650b2d-3f42-4cc5-af04-68bf259c93d7"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298685132627*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"76bf7b75-3402-4f64-bc1d-a2f8e82a20ef"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.0003040313577988872`\\\", \
\\\",\\\", \\\"584.769168224354`\\\"}], \\\"}\\\"}]\\). Try perturbing the \
initial point(s).\"", 2, 43, 7, 30845435296870923255, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952293653242859*^9, 3.952293788863497*^9, 
  3.952294248840259*^9, 3.9522948876548843`*^9, 3.952295517617468*^9, 
  3.952295916057333*^9, 3.952296192354244*^9, 3.952297649152645*^9, 
  3.952297709525482*^9, 3.952298276466758*^9, 3.952298740983185*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"56e4782f-b8cd-4b6e-81b8-94835933af6c"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298742032445*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"06e1a25a-ee4d-4799-8372-a1ed7aca1d6d"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.00022874657314521818`\\\", \
\\\",\\\", \\\"456.6178177899845`\\\"}], \\\"}\\\"}]\\). Try perturbing the \
initial point(s).\"", 2, 43, 8, 30845435296870923255, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952293653242859*^9, 3.952293788863497*^9, 
  3.952294248840259*^9, 3.9522948876548843`*^9, 3.952295517617468*^9, 
  3.952295916057333*^9, 3.952296192354244*^9, 3.952297649152645*^9, 
  3.952297709525482*^9, 3.952298276466758*^9, 3.9522987426765137`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"a4eec124-903e-4e85-accc-366f5a5a3c8a"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522987436778507`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"7969d280-1baf-432e-b67d-e8449dfc82f7"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"l\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.000019573503796947143`\\\", \\\",\\\
\", \\\"242.94700745215226`\\\"}], \\\"}\\\"}]\\). Try perturbing the initial \
point(s).\"", 2, 43, 9, 30845435296870923255, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952293653242859*^9, 3.952293788863497*^9, 
  3.952294248840259*^9, 3.9522948876548843`*^9, 3.952295517617468*^9, 
  3.952295916057333*^9, 3.952296192354244*^9, 3.952297649152645*^9, 
  3.952297709525482*^9, 3.952298276466758*^9, 3.952298743911442*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"e0572b7f-7eec-427f-8965-8f668053d77d"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \
\\\"::\\\", \\\"jsing\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 43, 10, 30845435296870923255, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.952293653242859*^9, 3.952293788863497*^9, 
  3.952294248840259*^9, 3.9522948876548843`*^9, 3.952295517617468*^9, 
  3.952295916057333*^9, 3.952296192354244*^9, 3.952297649152645*^9, 
  3.952297709525482*^9, 3.952298276466758*^9, 3.952298743913591*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"6560e5c1-17f9-47d8-82c2-08591c0f7b1a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298744969692*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"7475067e-6437-433c-9ce0-8af62c0eb1eb"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298746200767*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"0502bd3c-012e-4eb3-b9c4-23b7744202ba"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298748143717*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"91247235-fa88-4fd7-8983-bfb95bff80a2"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298750055941*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"299be395-928d-40bc-8dc7-f0ad7ea9f4a9"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522987844815893`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"c8bed4c5-1fcf-4a8f-8557-31d8b9504e3f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522988676338043`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"4935f589-bee8-4647-8d6f-db9737f3ab13"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298869652912*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"fb013b6d-8cd1-440c-accc-249b8ba4dc0f"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298870970289*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"0cb86ae4-59a3-4d1e-bf91-d09df9716b4e"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522988725801077`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"94ea9f75-f425-4c9b-af08-69678ed94d79"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522989082301083`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"1bfbff1c-a444-4ed9-9975-846ee8e5509f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["\[Pi]", "4"], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "3414.684797148121`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "0.002`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   "0.0009200242014178264`", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "2.5393335935835275`*^-6", ",", "0", ",", "0", ",", "0", ",", 
       "0.0018400484028356528`", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.0018400484028356528`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "8.464445311945092`*^-7"}], ",", "0", ",", "0", ",", 
       "0"}], "}"}]}], "}"}], "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]",
    "1", "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "10000", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2000"}],
  SequenceForm[
  Rational[1, 4] Pi, " ", {0, 0, 0}, " ", 3414.684797148121, " ", 0.002, " ", 
   0.0009200242014178264, " ", 1, 
   " ", {{0, 0, 0, 1, 0, 0}, {0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 0, 1}, {
    2.5393335935835275`*^-6, 0, 0, 0, 0.0018400484028356528`, 0}, {
    0, 0, 0, -0.0018400484028356528`, 0, 0}, {
    0, 0, -8.464445311945092*^-7, 0, 0, 0}}, " ", 1, " ", 10000, " ", 2000],
  Editable->False]], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298932138496*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"5b9cdeb0-d557-4822-8b69-cbb0a4e7c532"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522989331508207`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"32a602bf-836d-4c07-ae34-7ecf96fa86bd"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952298988905053*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"979633a2-4710-4643-bb9d-0d99ba0f9796"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.95229899209284*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"a5cf9393-7645-4fc1-8492-7589bd489273"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522990518003902`*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"2719cce8-bab8-4f12-bcb6-9d67578ebb37"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952299130279291*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"d7f20458-be6d-4099-9be1-41f122c5e985"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.952299132519251*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"44c36d9b-1feb-4fcb-b020-6bada671c2de"],

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.952293632207891*^9, 3.952293767833789*^9, 
  3.9522942278475723`*^9, 3.952294886246811*^9, 3.9522954975610523`*^9, 
  3.952295877738455*^9, 3.952296155903804*^9, 3.952297613643207*^9, 
  3.952297673533197*^9, 3.952298255515773*^9, 3.9522991354343*^9},
 CellLabel->
  "During evaluation of \
In[43]:=",ExpressionUUID->"e6ebab87-a1a8-4c63-be87-f8f29c1a143d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "precondition", " ", "is", " ", "that", " ", "directions", " ", 
    "are", " ", "lined", " ", "up", " ", "with", " ", "the", " ", "costate", " ",
     "directions"}], "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"computeReachableSet", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "initialAngle_", ",", 
      "prevFuelLimCostates_", ",", " ", "prevThrustLimCostates_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", " ", "=", " ", 
        RowBox[{"prevFuelLimCostates", " ", "//", " ", "Length"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"angles", " ", "=", " ", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"initialAngle", ",", " ", 
           RowBox[{"initialAngle", " ", "+", " ", 
            RowBox[{"2", " ", "Pi"}]}], ",", " ", 
           RowBox[{"2", " ", 
            RowBox[{"Pi", " ", "/", " ", "num"}]}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"unitVectors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], " ", "//", " ", "N"}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], " ", "//", " ", "N"}]}], "}"}], 
          "&"}], "/@", "angles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maximumMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"thrustmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "num"}], 
         "]"}]}], ";", 
       RowBox[{"As", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"A", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"initialMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"m0", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"isps", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"isp", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"endTimes", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"endTime", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maximumThrusts", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"thrustmax", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fuelPercents", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"fuelpercent", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fuelLimitedSolutions", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"rootfind", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "prevFuelLimCostates", ",", " ", "maximumMasses", ",", " ", 
            "unitVectors", ",", " ", "As", ",", " ", "initialMasses", ",", 
            " ", "isps", ",", " ", "endTimes", ",", " ", "maximumThrusts"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fuelLimitedSolutions", " ", "//", " ", "Print"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"propogate", "[", "posxposymCostate_", "]"}], " ", ":=", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "thrustmax",
           ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"terminalPositions", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"propogate", ",", " ", "fuelLimitedSolutions"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Point", "[", "terminalPositions", "]"}], ",", 
                 "flipTransformation"}], "]"}], ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"*", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", " ", 
                  RowBox[{"GeometricTransformation", "[", 
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                    " ", "flipTransformation"}], "]"}]}], "}"}], "]"}]}], ",",
               " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Red", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ",", " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                   " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ","}], " ", "**)"}], "\[IndentingNewLine]", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", 
                ",", "\"\<Maximum Ratio\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<RRStimeContinuation``.png\>\"", ",", " ", "endTime"}],
            "]"}], " ", "//", " ", "ToString"}], ",", " ", "plot"}], "]"}], ";",
        "\[IndentingNewLine]", "terminalPositions"}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"computeReachableSet", "[", 
    RowBox[{
    "tmaxval", ",", " ", "n", ",", " ", "60.25", ",", " ", "m0", ",", " ", 
     "fuelpercent", ",", " ", "isp", ",", " ", 
     RowBox[{"Pi", "/", "4"}], ",", " ", 
     RowBox[{"directioncostatemap", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
     RowBox[{"directioncostatemap", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzV1IUwEcBfBLfuDwC1KkB5u6DRur6cxcgjpQkCYtFjIFrUjn5qbUCmOp
5FBuIroeuoGCgRsxkBSpVMgPyqh86c7BGIVaE2YPlUXmy+bUlnbP/+Hwezmc
k2e8VWs+xjDMGSGQG3dLTB3blac6n8hgVnRIDmP7lwqgz1VZDDfXIufh4k6X
Fsqyp/UwOJrCwo7imn5Y9XLTSR4mPIB+1eVh+MvyiNy9Ee+G39MWXsDZsnEf
vFf07iNUK5+u0+9BYYh2Mk+IzIJ9oqlk6JzslcP0BV0JzA2u6uC5itt6uMMf
tcBwgDXBpQtBK3RnHdihw5PaA/nVXAecd8YNUX95i1x+GOBhUkPrBuxSjG1B
zd+fZCx/oLQVu/+ulcNYtrcKRtYmtXCuSKqHg0wZOdUtNcCGdiWp4g4bYZpd
fAV+/c1Z4Eo43wYbeakL5qnkJOvb3oBv/SUh2LQ3I7cIit+IFFCbyZ6Fcf4x
cvhZuAJetGdooGTvTjUcMfSS2sceAzydOEGua3TXITfQTs6NJJtgdwFLqr3N
dshYbWSEU/fAPzIzqch5/wF+SwmQ3lDdLgws8VFocJTXWwVrT94n48XBNhj9
8oM8rtT0wbuxTvK1Z8IFjfuFbtjvfS5pE3xlmyGvGj8r4c1PRyr4H/LrYi0=

  "],
 CellLabel->"In[41]:=",ExpressionUUID->"b1d81f0c-e233-48f1-91f6-5198c7f2aeab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0000357304675295288`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "9.859329576786493`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000031500227449232544`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "9.295021103340053`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000027714569255953132`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.824825120503167`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000024281184577677944`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.431625700525894`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000021129340139979483`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.102603172182265`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000018203608454797466`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.828026123337336`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000015459612158607732`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.600440611665565`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000012861055108486662`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.414111564609188`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000010377595549042882`"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.264633918535801`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.983281344230673`*^-6"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.1486580188484785`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.65536454683389`*^-6"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.063695636651063`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.373372890903266`*^-6"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.007984400531392`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.118352795787198`*^-6"}], ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "6.980396274367662`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1277784810910946`*^-6", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "6.9803809809344095`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.382820114240746`*^-6", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.007938978220407`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.664855539097412`*^-6", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.063621462645577`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.992839760303371`*^-6", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.148557444482676`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000010387247303614599`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.264510351792518`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000012870829377944292`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.413969606078522`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000015469542635371455`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.600286242446219`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000018213734955731172`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "7.827866972780355`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000021139710847659763`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.102448824319023`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000024291858985646805`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.431488609051481`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000027725622434336853`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "8.824720774292675`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000031511756205399674`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "9.294969802320532`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00003574259960952584`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "9.859357816386545`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000040541595462057494`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "10.541147550788864`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00004607822598677589`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "11.372642981432186`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.000052592359358060616`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "12.399925943059852`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00006043576645122725`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "13.690940956413588`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0000701468304246797`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "15.350051567209787`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00008259420820791066`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "17.546038556328654`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00009927721109620687`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "20.570648667999`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0001230267254166447`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "24.975222741351402`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0001599078960504541`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "31.941588482376485`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00022569031982320483`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "44.54331572982029`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.00037820938524628486`", ",", 
     RowBox[{"-", "0.000035633021252005183`"}], ",", "74.05403185446688`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.2133484098092033`*^7", ",", "1.4966320496238672`*^-6", ",", 
     "2.6176517235844214`*^12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004770423063571451`", ",", "1.4966320496238672`*^-6", ",", 
     "9.30383240043761`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.000015872147222171475`", ",", "1.4966320496238672`*^-6", ",", 
     "3.107913042436288`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.474349068723121`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "1.8700229273073206`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.713661767076354`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "1.3411741087051086`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.165534842347187`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "1.048758429887187`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.168495294967863`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.8638516663833815`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.4680581696707`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.7368660157227243`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.9454218067277558`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.644663796295563`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.537657722693527`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.5749999541870493`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.2083036245930435`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.5207898552509025`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.934759003753981`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.4776524973401474`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.702256223360099`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.44273553358488704`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.500724916794395`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.41410433671034924`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.323049472587149`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.39040266576701305`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.1640470308883283`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.3706538369578007`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.0198405233388112`*^-6", ",", "1.4966320496238672`*^-6", ",", 
     "0.3541389678035547`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8.874590626836696`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.3403195977380893`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7.645746242354134`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.3287870198162911`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.493233023621596`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.3192281375684372`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.401806131414879`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.3114020815016362`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.358721643948532`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.30512383090477274`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.3530793351942027`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.3002526961582278`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.375324779021671`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.29668416845035833`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.4168593642828537`*^-7", ",", "1.4966320496238672`*^-6", ",", 
     "0.2943442259254372`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.6972234689956485`*^-8", ",", "1.4966320496238672`*^-6", ",", 
     "0.2931854896491578`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.7368125417724404`*^-8"}], ",", "1.4966320496238672`*^-6",
      ",", "0.29318484734376205`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.420827317812905`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.29434231806717687`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.3793111160295487`*^-7"}], ",", "1.4966320496238672`*^-6",
      ",", "0.2966810530409682`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.357093990959471`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.3002484718898837`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.362775502881103`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.3051186409333524`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.40591144779556`*^-7"}], ",", "1.4966320496238672`*^-6", ",",
      "0.3113961190639226`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.497403948458387`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.31922165385213175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.649999500553253`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.3287803329019611`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.878946455485955`*^-7"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.3403131186756846`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0202888619999744`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.35413320665544085`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.1645112783860582`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.37064945590373544`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.3235336948636748`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.3904005110554509`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.5012344795011485`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.4141055227830673`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.7027983869797208`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.4427415557213196`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.935343885477062`*^-6"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.47766541754825576`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.2089457361429957`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.5208126039066623`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.538378779997842`*^-6"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.575036870410464`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.946255773502781`*^-6"}], ",", "1.4966320496238672`*^-6", 
     ",", "0.6447216186835598`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.4690614146673743`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.7369558551684`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.1697686778566765`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "0.8639933128568402`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.1672783757200065`*^-6"}], ",", "1.4966320496238672`*^-6",
      ",", "1.0489910058974075`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.716334282277234`*^-6"}], ",", "1.4966320496238672`*^-6", 
     ",", "1.3415871951360316`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.479279445574787`*^-6"}], ",", "1.4966320496238672`*^-6", 
     ",", "1.870875709301399`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000015885273477689734`"}], ",", 
     "1.4966320496238672`*^-6", ",", "3.1103631848866504`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.713610346083478`*^6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", 
     "1.6241148315846663`*^12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00004770423063587285`"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "9.303832400603204`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000015872147222161474`"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "3.107913042180811`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.474349068716472`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "1.870022927239014`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.713661766925784`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "1.3411741087257287`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.1655348422473555`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "1.0487584296915353`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.1684952949010915`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.8638516664305268`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.4680581696234985`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.73686601587095`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.945421806696431`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.6446637962884929`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.5376577245763833`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.5749999542448518`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.2083036255555185`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.5207898552442297`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.9347590041757924`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.47765249732871284`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.7022562234849333`*^-6"}], ",", 
     RowBox[{"-", "1.496632049623867`*^-6"}], ",", "0.4427355336326049`"}], 
    "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.952295744320359*^9, 3.95229658930101*^9, 3.95229675434198*^9, 
   3.952296898914817*^9, 3.95229707578318*^9, 3.952297327765942*^9, {
   3.952298336714418*^9, 3.952298385985372*^9}},
 CellLabel->
  "During evaluation of \
In[41]:=",ExpressionUUID->"1a903db3-1b3c-488c-95cb-4932d787ea22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.296007880041402`"}], ",", 
     RowBox[{"-", "2.2960078800411696`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.147195895598489`"}], ",", 
     RowBox[{"-", "2.435515668791326`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.989928392859574`"}], ",", 
     RowBox[{"-", "2.565400225879823`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.8248278414312844`"}], ",", 
     RowBox[{"-", "2.685152627730329`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.652546893095843`"}], ",", 
     RowBox[{"-", "2.7943041930801553`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.4737657888148448`"}], ",", 
     RowBox[{"-", "2.892428219782084`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.289189653812359`"}], ",", 
     RowBox[{"-", "2.979141513956197`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0995457297280518`"}], ",", 
     RowBox[{"-", "3.0541057550857222`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.905580551092947`"}], ",", 
     RowBox[{"-", "3.1170287018547524`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7080570639619971`"}], ",", 
     RowBox[{"-", "3.1676652125723876`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5077517058102751`"}], ",", 
     RowBox[{"-", "3.205818101638477`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.30545145082038616`"}], ",", 
     RowBox[{"-", "3.2313388238120573`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.10195082927710084`"}], ",", 
     RowBox[{"-", "3.244127989512083`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.10195107190170692`", ",", 
     RowBox[{"-", "3.244135709952809`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3054536201006242`", ",", 
     RowBox[{"-", "3.2313617724005526`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5077576527279181`", ",", 
     RowBox[{"-", "3.205855648998862`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7080684908132625`", ",", 
     RowBox[{"-", "3.1677163333664757`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9055989438313672`", ",", 
     RowBox[{"-", "3.11709201007535`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0995722978319162`", ",", 
     RowBox[{"-", "3.0541795508329956`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.289225280185802`", ",", 
     RowBox[{"-", "2.979223841647614`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4738109919799076`", ",", 
     RowBox[{"-", "2.8925169359887835`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6526017997310298`", ",", 
     RowBox[{"-", "2.794397035129555`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8248921770193491`", ",", 
     RowBox[{"-", "2.685247294673305`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9900014856499344`", ",", 
     RowBox[{"-", "2.5654944565405753`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.1472766859139134`", ",", 
     RowBox[{"-", "2.4356073074166185`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.2960949638018597`", ",", 
     RowBox[{"-", "2.2960949638018278`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.4358662644124545`", ",", 
     RowBox[{"-", "2.1475049872166894`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.566035705697334`", ",", 
     RowBox[{"-", "1.9904213215315905`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6860859268803474`", ",", 
     RowBox[{"-", "1.8254621108786935`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.795539195567979`", ",", 
     RowBox[{"-", "1.653277271531677`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.893959475879927`", ",", 
     RowBox[{"-", "1.474546002765839`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.9809542818449466`", ",", 
     RowBox[{"-", "1.2899741085272378`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.056176371812888`", ",", 
     RowBox[{"-", "1.100291197620262`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.119325256623087`", ",", 
     RowBox[{"-", "0.9062477619314082`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.170148515343081`", ",", 
     RowBox[{"-", "0.7086121478962801`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.2084429024094825`", ",", 
     RowBox[{"-", "0.5081674334113431`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.2340552466230457`", ",", 
     RowBox[{"-", "0.3057082283772075`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.162290082672742`", ",", 
     RowBox[{"-", "0.0001227965262090558`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.2468754296609843`", ",", "0.10203717106245346`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"3.234032273738174`", ",", "0.3057060568002692`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.2084052916411228`", ",", "0.508161476450591`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.1700973008914133`", ",", "0.7086007001127711`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.1192618352098047`", ",", "0.9062293363030393`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.0561024608713763`", ",", "1.1002645880382882`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.9808718384916353`", ",", "1.2899384320962195`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.893870653895865`", ",", "1.4745007456997141`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.795446263075766`", ",", "1.6532223126454353`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6859911917880033`", ",", "1.8253977297814312`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.5659414355090577`", ",", "1.990348198520008`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.43577459996936`", ",", "2.147424174304251`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.2960078801318096`", ",", "2.2960078800967114`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.1471958956614765`", ",", "2.435515668698156`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.9899283949293944`", ",", "2.5654002285516815`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.82482783760706`", ",", "2.6851526220957096`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.652546897411224`", ",", "2.794304200387285`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4737657864357097`", ",", "2.8924282149081226`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2891896538819474`", ",", "2.979141513966789`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0995457297381999`", ",", "3.0541057550124733`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9055805511119479`", ",", "3.1170287018606855`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7080570639620587`", ",", "3.167665212545339`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.507751705801067`", ",", "3.205818101572096`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.30545145081553515`", ",", "3.231338823760158`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.10195082927671192`", ",", "3.2441279894993915`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.10195107189821798`"}], ",", "3.24413570984162`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.30545362011071836`"}], ",", "3.231361772514462`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5077576527154845`"}], ",", "3.205855648951123`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7080684908005042`"}], ",", "3.1677163333867857`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9055989438000573`"}], ",", "3.1170920101219157`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0995722977201385`"}], ",", "3.0541795507916234`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2892252800490436`"}], ",", "2.979223841758155`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.4738109920419031`"}], ",", "2.8925169361123344`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.6526017997554383`"}], ",", "2.7943970351743013`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.8248921770018247`"}], ",", "2.685247294651873`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.99000148566533`"}], ",", "2.5654944565664097`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.1472766858806884`"}], ",", "2.435607307386277`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.296094963899335`"}], ",", "2.2960949639085664`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4358662644115237`"}], ",", "2.147504987227306`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.5660357056910965`"}], ",", "1.9904213215410522`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.6860859231573646`"}], ",", "1.8254621134526592`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.7955391955796927`"}], ",", "1.6532772715599848`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.893959475818917`"}], ",", "1.4745460027642427`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9809542817642805`"}], ",", "1.2899741085330068`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.0561763717345016`"}], ",", "1.100291197664493`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.119325256313302`"}], ",", "0.906247762046556`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.1701485153850926`"}], ",", "0.7086121479086813`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.2084429025048253`"}], ",", "0.5081674334286`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.234055246674171`"}], ",", "0.3057082283822154`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.1845932086042925`"}], ",", "0.00012288211503757627`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.246875429648536`"}], ",", 
     RowBox[{"-", "0.10203717106173965`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.234032273800969`"}], ",", 
     RowBox[{"-", "0.30570605680660723`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.208405291668365`"}], ",", 
     RowBox[{"-", "0.5081614764553439`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.170097300859928`"}], ",", 
     RowBox[{"-", "0.708600700121553`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.1192618353293606`"}], ",", 
     RowBox[{"-", "0.9062293363553634`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.056102460816216`"}], ",", 
     RowBox[{"-", "1.1002645880360886`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.9808718383354544`"}], ",", 
     RowBox[{"-", "1.2899384320455802`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.8938706538911845`"}], ",", 
     RowBox[{"-", "1.4745007457129047`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.7954462639096658`"}], ",", 
     RowBox[{"-", "1.6532223119118803`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.6859911923552513`"}], ",", 
     RowBox[{"-", "1.8253977293715433`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.5659414358162986`"}], ",", 
     RowBox[{"-", "1.9903481983247457`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4357746000093052`"}], ",", 
     RowBox[{"-", "2.14742417418205`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.952292407488205*^9, 3.9522924462433777`*^9}, 
   3.9522924966001453`*^9, 3.952292533284134*^9, 3.9522925805923147`*^9, 
   3.952292734202012*^9, 3.952293671099807*^9, 3.952293812088045*^9, 
   3.952294255439624*^9, 3.952294303123735*^9, 3.9522943948752747`*^9, 
   3.952294497356114*^9, 3.952294575366802*^9, 3.952294661790316*^9, 
   3.952294706039583*^9, 3.952294846533628*^9, 3.952295485232367*^9, 
   3.952295746959249*^9, 3.952296594075553*^9, 3.9522967590213203`*^9, 
   3.952296903695999*^9, 3.952297080451762*^9, 3.9522973324684057`*^9, {
   3.952298337013907*^9, 3.952298386275173*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"9c4d3550-b284-4b25-916b-be10d863b1ed"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{352, Automatic}, {16, Automatic}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"16cd1baa-a10e-477f-ab21-705869e11ac4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 213087, 5006, 11848, "Input",ExpressionUUID->"5c101b50-c06f-4166-9a70-caa4dcef817c",
 InitializationCell->True],
Cell[213644, 5028, 1006, 26, 188, "Input",ExpressionUUID->"b9423ae2-e811-4fe1-9b31-5a21383bd0ad",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[214675, 5058, 947, 16, 29, "Input",ExpressionUUID->"59cd509c-5a94-49c5-b826-2fd28b3e5208"],
Cell[CellGroupData[{
Cell[215647, 5078, 2390, 50, 55, "Print",ExpressionUUID->"85650b2d-3f42-4cc5-af04-68bf259c93d7"],
Cell[218040, 5130, 441, 7, 23, "Print",ExpressionUUID->"76bf7b75-3402-4f64-bc1d-a2f8e82a20ef"]
}, Open  ]],
Cell[218496, 5140, 806, 16, 26, "Message",ExpressionUUID->"56e4782f-b8cd-4b6e-81b8-94835933af6c"],
Cell[219305, 5158, 441, 7, 23, "Print",ExpressionUUID->"06e1a25a-ee4d-4799-8372-a1ed7aca1d6d"],
Cell[219749, 5167, 810, 16, 26, "Message",ExpressionUUID->"a4eec124-903e-4e85-accc-366f5a5a3c8a"],
Cell[220562, 5185, 443, 7, 23, "Print",ExpressionUUID->"7969d280-1baf-432e-b67d-e8449dfc82f7"],
Cell[221008, 5194, 810, 16, 26, "Message",ExpressionUUID->"e0572b7f-7eec-427f-8965-8f668053d77d"],
Cell[221821, 5212, 698, 14, 26, "Message",ExpressionUUID->"6560e5c1-17f9-47d8-82c2-08591c0f7b1a"],
Cell[CellGroupData[{
Cell[222544, 5230, 441, 7, 23, "Print",ExpressionUUID->"7475067e-6437-433c-9ce0-8af62c0eb1eb"],
Cell[222988, 5239, 441, 7, 23, "Print",ExpressionUUID->"0502bd3c-012e-4eb3-b9c4-23b7744202ba"],
Cell[223432, 5248, 441, 7, 23, "Print",ExpressionUUID->"91247235-fa88-4fd7-8983-bfb95bff80a2"],
Cell[223876, 5257, 441, 7, 23, "Print",ExpressionUUID->"299be395-928d-40bc-8dc7-f0ad7ea9f4a9"],
Cell[224320, 5266, 443, 7, 23, "Print",ExpressionUUID->"c8bed4c5-1fcf-4a8f-8557-31d8b9504e3f"],
Cell[224766, 5275, 443, 7, 23, "Print",ExpressionUUID->"4935f589-bee8-4647-8d6f-db9737f3ab13"],
Cell[225212, 5284, 441, 7, 23, "Print",ExpressionUUID->"fb013b6d-8cd1-440c-accc-249b8ba4dc0f"],
Cell[225656, 5293, 441, 7, 23, "Print",ExpressionUUID->"0cb86ae4-59a3-4d1e-bf91-d09df9716b4e"],
Cell[226100, 5302, 443, 7, 23, "Print",ExpressionUUID->"94ea9f75-f425-4c9b-af08-69678ed94d79"],
Cell[226546, 5311, 443, 7, 23, "Print",ExpressionUUID->"1bfbff1c-a444-4ed9-9975-846ee8e5509f"],
Cell[226992, 5320, 2375, 49, 55, "Print",ExpressionUUID->"5b9cdeb0-d557-4822-8b69-cbb0a4e7c532"],
Cell[229370, 5371, 443, 7, 23, "Print",ExpressionUUID->"32a602bf-836d-4c07-ae34-7ecf96fa86bd"],
Cell[229816, 5380, 441, 7, 23, "Print",ExpressionUUID->"979633a2-4710-4643-bb9d-0d99ba0f9796"],
Cell[230260, 5389, 440, 7, 23, "Print",ExpressionUUID->"a5cf9393-7645-4fc1-8492-7589bd489273"],
Cell[230703, 5398, 443, 7, 23, "Print",ExpressionUUID->"2719cce8-bab8-4f12-bcb6-9d67578ebb37"],
Cell[231149, 5407, 441, 7, 23, "Print",ExpressionUUID->"d7f20458-be6d-4099-9be1-41f122c5e985"],
Cell[231593, 5416, 441, 7, 23, "Print",ExpressionUUID->"44c36d9b-1feb-4fcb-b020-6bada671c2de"],
Cell[232037, 5425, 439, 7, 23, "Print",ExpressionUUID->"e6ebab87-a1a8-4c63-be87-f8f29c1a143d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232525, 5438, 12868, 292, 785, "Input",ExpressionUUID->"b1d81f0c-e233-48f1-91f6-5198c7f2aeab"],
Cell[245396, 5732, 16216, 435, 478, "Print",ExpressionUUID->"1a903db3-1b3c-488c-95cb-4932d787ea22"],
Cell[261615, 6169, 12407, 338, 278, "Output",ExpressionUUID->"9c4d3550-b284-4b25-916b-be10d863b1ed"]
}, Open  ]]
}
]
*)

