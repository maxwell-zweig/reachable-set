(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    288115,       6020]
NotebookOptionsPosition[    285301,       5974]
NotebookOutlinePosition[    285700,       5990]
CellTagsIndexPosition[    285657,       5987]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "This", " ", "is", " ", "code", " ", "modified", " ", 
    "specifically", " ", "for", " ", "the", " ", "2", "d", " ", "case"}], " ",
    "**)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "the", " ", "directory", " ", "that", " ", "you", " ",
     "want", " ", "your", " ", "plots", " ", "to", " ", "go", " ", "to", " ", 
    "here"}], " ", "**)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", "]"}], ";", 
    RowBox[{"SetDirectory", "[", "\"\</users/maxzweig/fuelthrust\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Solve", "::", "svars"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "lstol"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vectoangle", "[", "k_", "]"}], " ", ":=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"k", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"k", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "axes", " ", "for", " ", "the", " ", 
     "energy", " ", "limited", " ", "reachable", " ", "set", " ", 
     "associated", " ", "with", " ", "a", " ", "given", " ", "terminal", " ", 
     "time", " ", "and", " ", "thrust"}], " ", "**)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getAxes", "[", 
     RowBox[{"terminaltime_", ",", " ", "quadform_", ",", " ", "thrustmax_"}],
      "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"energysetaxes", "[", "quad_", "]"}], " ", ":=", 
        "\[IndentingNewLine]", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"energyseteigenvalues", "[", "quad_", "]"}], " ", ":=", "  ", 
        
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}],
                ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", " ", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                "}"}]}], "}"}]}], "]"}], ",", " ", 
           RowBox[{"quad", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"7", ";;", " ", "12"}], ",", " ", 
              RowBox[{"7", " ", ";;", " ", "12"}]}], "]"}], "]"}]}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vecs", " ", "=", " ", 
        RowBox[{"energysetaxes", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", " ", "=", " ", 
        RowBox[{"energyseteigenvalues", "[", "quadform", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ax1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ax2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"vecs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"terminaltime", " ", 
             RowBox[{"thrustmax", "^", "2"}], "*", " ", 
             RowBox[{"vals", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], " ", "//", " ", 
           "Sqrt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ax1", ",", "ax2"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "gets", " ", "the", " ", "minimum", " ", "and", " ", "maximum", 
     " ", "ratios", " ", "between", " ", "an", " ", "energy", " ", "limited", 
     " ", "set", " ", "and", " ", "an", " ", "arbitrary", " ", "reachable", " ",
      "set", " ", "given", " ", "as", " ", "set", " ", "of", " ", "points"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reachablestatsoperator", "[", 
      RowBox[{"points_", ",", "axis1_", ",", "axis2_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "[", "points", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"points", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ellipseVecFromUnitVec", "[", 
          RowBox[{"uv_", ",", "ax1_", ",", " ", "ax2_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax1", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax1", "]"}], "^", "2"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Normalize", "[", "ax2", "]"}], ".", "uv"}], ")"}], "^",
                "2"}], "/", 
              RowBox[{
               RowBox[{"Norm", "[", "ax2", "]"}], "^", "2"}]}]}], "]"}]}], "*",
           "uv"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ratio", "[", "pos_", "]"}], ":=", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"ellipseVecFromUnitVec", "[", 
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", "axis1", ",",
              " ", "axis2"}], "]"}], " ", "]"}], "/", " ", 
          RowBox[{"Norm", "[", 
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminrat", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Max"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ratio", "/@", "v1s"}], ")"}], "//", " ", "Min"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"maxminvec", "[", " ", "v1s_", "]"}], " ", ":=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Max"}]}], "    ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}], " ", ",", " ", 
           RowBox[{
            RowBox[{"v1s", "[", 
             RowBox[{"[", " ", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ratio", "/@", "v1s"}], ")"}], ",", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ratio", "/@", "v1s"}], ")"}], " ", "//", " ", 
                  "Min"}]}], "   ", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], " ", "//",
             " ", "toq2q1"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rats", " ", "=", " ", 
         RowBox[{"maxminrat", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vecs", " ", "=", " ", 
         RowBox[{"maxminvec", "[", " ", "points", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rats", " ", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", " ", 
            RowBox[{"vecs", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "}"}]}], "}"}]}]}],
       "\[IndentingNewLine]", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "computes", " ", "minimum", " ", "and", " ", "maximum", " ", "ratios", " ",
       "between", " ", "the", " ", "thrust", " ", "limited", " ", "and", " ", 
      
      RowBox[{"thrust", "/", "fuel"}], " ", "limited", " ", "reachable", " ", 
      "sets"}], ",", " ", 
     RowBox[{
     "given", " ", "as", " ", "a", " ", "set", " ", "of", " ", "points", " ", 
      "that", " ", "are", " ", "indexed", " ", "by", " ", "angle", " ", "in", 
      " ", "their", " ", 
      RowBox[{"arrays", ".", "\[IndentingNewLine]", "Assuming"}], " ", 
      "given", " ", "points", " ", "are", " ", "angle", " ", 
      RowBox[{"aligned", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"thrustfuelstats", "[", 
      RowBox[{"thrustpoints_", ",", " ", "fuelpoints_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rats", ",", " ", "vecs"}], "}"}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListRatios", "[", 
          RowBox[{"list1_", ",", " ", "list2_"}], "]"}], " ", ":=", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"list1", ",", "list2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ratios", " ", "=", " ", 
         RowBox[{"ListRatios", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "thrustpoints"}], "]"}], ",", " ", 
           RowBox[{"Map", "[", 
            RowBox[{"Norm", ",", " ", "fuelpoints"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minratio", " ", "=", " ", 
         RowBox[{"ratios", " ", "//", " ", "Min"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toq2q1", "[", "vec_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", "0"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], ")"}],
             " ", "||", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", ">", "0"}], " ", "&&", 
              " ", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "<", " ", "0"}]}], 
             ")"}]}], ",", " ", 
           RowBox[{"-", "vec"}], ",", " ", "vec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "maxratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ratios", ",", " ", "minratio"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"maxpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "maxpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"minpos", " ", "=", " ", 
         RowBox[{
          RowBox[{"fuelpoints", "[", 
           RowBox[{"[", "minpos", "]"}], "]"}], " ", "//", " ", "toq2q1"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
          "minpos"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"energyform", "[", 
      RowBox[{"tff_", ",", " ", "na_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "c", ",", " ", "r", ",", " ", "sig", ",", " ", "gamma", ",", " ", 
         "nmat"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "n_", "]"}], " ", "=", " ", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{
              RowBox[{"-", "2"}], "*", " ", "n"}], ",", " ", "0", ",", " ", 
             "1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", " ", "*", " ", "n"}], ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "1", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "0", " ", ",",
              " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", "0", ",", 
             "0"}], " ", "}"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "0", ",", " ", 
             "0"}], " ", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", " ", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "MatrixForm"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t_", ",", " ", "h_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"72", " ", "t", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"h", " ", "t"}], "]"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"154", " ", "h", " ", "t"}], "+", 
                RowBox[{"48", " ", 
                 SuperscriptBox["h", "3"], " ", 
                 SuperscriptBox["t", "3"]}], "-", 
                RowBox[{"384", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], "-", 
                RowBox[{"27", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
               RowBox[{"4", " ", "h"}]]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "h", " ", 
               SuperscriptBox["t", "2"]}], "+", 
              FractionBox[
               RowBox[{"6", "-", 
                RowBox[{"6", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], "h"]}], ",", "t", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"2", " ", "h", " ", "t"}], "+", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
              RowBox[{"4", " ", "h"}]], ",", "0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"8", "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["h", "2"], " ", 
                SuperscriptBox["t", "2"]}], "-", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}], "2"]}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "h"}], " ", "t"}], "+", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}], ")"}]}], 
              SuperscriptBox["h", "2"]], ",", "0", ",", 
             FractionBox[
              RowBox[{
               RowBox[{"26", " ", "h", " ", "t"}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "+", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              RowBox[{"4", " ", 
               SuperscriptBox["h", "3"]}]], ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"23", " ", "h", " ", "t"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"42", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"56", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{
                FractionBox["9", "2"], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "2"]], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"3", " ", 
                 SuperscriptBox["t", "2"]}], "2"]}], "+", 
              FractionBox[
               RowBox[{"4", "-", 
                RowBox[{"4", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"h", " ", "t"}], "]"}]}]}], 
               SuperscriptBox["h", "2"]]}], ",", "0", ",", 
             FractionBox[
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "h"}], " ", "t"}], "+", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"h", " ", "t"}], "]"}]}], ")"}], "2"]}], 
              SuperscriptBox["h", "3"]], ",", 
             FractionBox[
              RowBox[{
               RowBox[{"14", " ", "h", " ", "t"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["h", "3"], " ", 
                SuperscriptBox["t", "3"]}], "+", 
               RowBox[{"24", " ", "h", " ", "t", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"32", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"h", " ", "t"}], "]"}]}], "-", 
               RowBox[{"3", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}]}], 
              SuperscriptBox["h", "3"]], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                RowBox[{"h", " ", "t"}], "]"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["h", "2"]}]], ",", "0", ",", "0", ",", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "h", " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "h", " ", "t"}], "]"}]}], 
               RowBox[{"4", " ", 
                SuperscriptBox["h", "3"]}]]}]}], "}"}]}], "}"}]}], ";", 
        RowBox[{"(*", "Good", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"t", ",", " ", "n"}], "]"}], " ", "//", " ", "MatrixForm"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sig", "[", 
          RowBox[{"t_", ",", " ", "n_"}], "]"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "-", 
              RowBox[{"3", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"], ",", 
             FractionBox[
              RowBox[{"2", "-", 
               RowBox[{"2", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}]}], "n"], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "n"}], " ", "t"}], "+", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "1", ",", 
             "0", ",", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], "n"], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "t"}], "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], "n"]}], ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", "0", ",", "0", ",", 
             FractionBox[
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}], "n"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"3", " ", "n", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}], ",", 
             RowBox[{"2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"6", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"n", " ", "t"}], "]"}]}], ")"}]}], ",", "0", ",", 
             "0", ",", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"4", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"n", " ", "t"}], "]"}]}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"n", " ", "t"}], "]"}]}], ",", "0", ",", "0", ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"n", " ", "t"}], "]"}]}], "}"}]}], "}"}]}], ";", " ", 
        RowBox[{"(*", " ", "Good", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"t_", ",", " ", "t0_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"sig", "[", 
           RowBox[{"t", ",", " ", "n"}], "]"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sig", "[", 
             RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nmat", "[", 
          RowBox[{"t0_", ",", " ", "tf_", ",", " ", "n_"}], "]"}], " ", "=", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sig", "[", 
                RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
               "Inverse"}], ",", " ", 
              RowBox[{
               RowBox[{"-", " ", 
                RowBox[{"sig", "[", 
                 RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
               "Inverse"}], ",", " ", "2"}], "]"}], " ", "//", " ", 
            "Transpose"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "[", "n", "]"}], " ", "//", " ", "Transpose"}], 
           ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"tf", ",", " ", "n"}], "]"}], " ", "//", " ", 
            "Inverse"}], ")"}], ".", 
          RowBox[{"c", "[", "n", "]"}], ".", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sig", "[", 
              RowBox[{"t0", ",", " ", "n"}], "]"}], " ", "//", " ", 
             "Inverse"}], ",", " ", 
            RowBox[{
             RowBox[{"-", " ", 
              RowBox[{"sig", "[", 
               RowBox[{"tf", ",", " ", "n"}], "]"}]}], " ", "//", " ", 
             "Inverse"}], ",", " ", "2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nmat", "[", 
         RowBox[{"0", ",", " ", "tff", ",", " ", "na"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getFinalEnergyPos", "[", 
      RowBox[{
      "tt_", ",", " ", "tmax_", ",", " ", "nt_", ",", " ", "delta_", ",", " ",
        "rho_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "6", "]"}], " ", "-", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",",
             " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"-", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis", " ", "=", " ", 
         RowBox[{"Orthogonalize", "[", "udd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"projmat", " ", "=", " ", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
            RowBox[{"basis", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;"}], "]"}], "]"}]}], "]"}], " ", "//", " ", 
          "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"projmatT", " ", "=", " ", 
         RowBox[{"projmat", " ", "//", " ", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"selectionMat", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eformxf", " ", "=", " ", 
         RowBox[{
          RowBox[{"energyform", "[", 
           RowBox[{"tt", ",", " ", "nt"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"7", ";;", "12"}], ",", " ", 
            RowBox[{"7", ";;", "12"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ydir", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eigenvectors", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"projmatT", ".", "selectionMat", ".", "projmat"}], ",", 
             " ", 
             RowBox[{"projmatT", ".", "eformxf", ".", "projmat"}]}], "}"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"projmat", ".", "ydir"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmag", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tt", " ", "rho", " ", 
            RowBox[{
             RowBox[{"tmax", "^", "2"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{"xdir", ".", "eformxf", ".", "xdir"}], ")"}]}]}], ")"}],
           " ", "//", " ", "Sqrt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xdir", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"delta", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], " ", "<", " ", "0"}], ",", 
           " ", 
           RowBox[{"-", "xdir"}], ",", " ", "xdir"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<energy computation executed\>\"", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"xdir", " ", "tmag"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"propStateCostatev2", "[", 
     RowBox[{
     "ics_", ",", " ", "isp_", ",", " ", "tf_", ",", " ", "tmax_", ",", " ", 
      "A_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"lxv_", ",", " ", "lyv_", ",", " ", "lzv_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lxv", " ", "^", " ", "2"}], "+", " ", 
           RowBox[{"lyv", " ", "^", "2"}], " ", "+", " ", 
           RowBox[{"lzv", " ", "^", "2"}]}], ")"}], " ", "//", " ", 
         "Sqrt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"switchingfunc", " ", "[", 
         RowBox[{
         "lxv_", ",", " ", "lyv_", ",", " ", "lzv_", ",", " ", "lmag_", ",", 
          " ", "mas_", ",", " ", "c_"}], "]"}], " ", ":=", 
        RowBox[{
         RowBox[{"mag", "[", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"lmag", " ", 
          RowBox[{"mas", " ", "/", "c"}]}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "y", ",", "z", ",", "vx", ",", "vy", ",", "vz", ",", "m", ",",
           "lxr", ",", "lyr", ",", "lzr", ",", "lxv", ",", "lyv", ",", "lzv", 
          ",", "lm"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", 
             " ", "lyv", ",", " ", "lzv"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"1", "/", "2"}], " ", "+", 
               RowBox[{
                RowBox[{"Sign", "[", 
                 RowBox[{"switchingfunc", "[", 
                  RowBox[{
                  "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",",
                    " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
                "2"}]}], ")"}]}], "tmax", " ", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}], "  ", 
             "/", " ", 
             RowBox[{"(", 
              RowBox[{"m", " ", "^", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "+", 
         " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "m"}], ")"}], 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", 
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"switchingfunc", "[", 
               RowBox[{
               "lxv", ",", " ", "lyv", ",", " ", "lzv", ",", " ", "lm", ",", 
                " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ", "/", " ", 
             "2"}]}], ")"}], " ", "tmax", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}], " ", "/",
            " ", 
           RowBox[{"mag", "[", 
            RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "]"}]}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"eqnsStateOpt", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", " ", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"1", "/", "2"}], " ", "+", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"switchingfunc", "[", 
                    RowBox[{
                    "lxv", ",", " ", "lyv", ",", " ", "lzv", " ", ",", " ", 
                    "lm", ",", " ", "m", ",", " ", "isp"}], "]"}], "]"}], " ",
                     "/", " ", "2"}]}], ")"}]}], 
                RowBox[{"tmax", "/", "isp"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "eqnsOpt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", "  ", 
        RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "'"}], "[", "t", "]"}], "&"}], "/@", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "14"}], "]"}], "]"}]}], ")"}], "==", 
              RowBox[{"(", 
               RowBox[{"dyn", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"vars", "->", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "vars"}], 
                   ")"}]}], "]"}]}], ")"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "0", "]"}], "&"}], "/@", "vars"}], ")"}], "\[Equal]",
               "ics"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "vars", ",",
           "  ", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", "tf", ",", " ", "tf"}], "}"}], ",", " ", 
          RowBox[{"Method", " ", "->", " ", "\"\<BDF\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "tf", "]"}], "&"}], "/@", "soln"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cons", "[", 
      RowBox[{
      "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_", ",", " ", 
       "tl_", ",", " ", "maxthrust_", ",", " ", "cval_", ",", " ", 
       "initmass_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], ")"}], 
           ".", 
           RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c1", " ", "=", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"udd", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xf", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"xf", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], " ", ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c2", " ", "=", "  ", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tl", " ", 
             RowBox[{"maxthrust", " ", "/", " ", "cval"}]}], "<=", "mmax"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"initmass", " ", "-", " ", 
                RowBox[{"xf", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
              RowBox[{"tl", " ", 
               RowBox[{"maxthrust", " ", "/", " ", "cval"}]}]}], ")"}], "}"}],
            ",", " ", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"initmass", " ", "-", " ", 
                RowBox[{"xf", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", "mmax"}], 
             ")"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"c1", ",", " ", "c2"}], "]"}], " ", "//", " ", 
         "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"consaug", "[", 
      RowBox[{
      "dey_", ",", " ", "lf_", ",", " ", "xf_", ",", " ", "mmax_", ",", " ", 
       "tl_", ",", " ", "maxthrust_", ",", " ", "cval_", ",", " ", 
       "initmass_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"udd", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], ")"}], 
           ".", 
           RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c1", " ", "=", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"udd", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xf", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"xf", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], " ", ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c2", " ", "=", "  ", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tl", " ", 
             RowBox[{"maxthrust", " ", "/", " ", "cval"}]}], "<=", "mmax"}], ",",
            " ", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"initmass", " ", "-", " ", 
                RowBox[{"xf", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", 
              RowBox[{"tl", " ", 
               RowBox[{"maxthrust", " ", "/", " ", "cval"}]}]}], ")"}], "}"}],
            ",", " ", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"initmass", " ", "-", " ", 
                RowBox[{"xf", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], " ", "-", "mmax"}], 
             ")"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c3", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"lf", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
              "Transpose"}], ")"}], ".", "dey"}], " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"xf", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
             "Norm"}], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"c1", ",", " ", "c2"}], "]"}], ",", " ", "c3"}], "]"}], 
         " ", "//", " ", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"findInitialCostates", "[", 
     RowBox[{
     "icRel_", ",", " ", "fcRel_", ",", " ", "n_", ",", " ", "A_", ",", " ", 
      "td_", ",", " ", "mmax_", ",", " ", "m0_", ",", " ", "tmax_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vars", ",", " ", "dyn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsStateOpt", "=", 
        RowBox[{
         RowBox[{"{", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "vy", " ", "n"}], " ", "+", " ", 
            RowBox[{"3", 
             RowBox[{"n", "^", "2"}], " ", "x"}]}], ",", "    ", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "n", " ", "vx"}], ",", " ", 
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"n", "^", "2"}]}], " ", "z"}]}], "  ", "}"}], " ", "-", 
         " ", 
         RowBox[{"{", 
          RowBox[{"lxv", ",", " ", "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsOpt", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "A"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{
          "lxr", ",", " ", "lyr", ",", " ", "lzr", ",", " ", "lxv", ",", " ", 
           "lyv", ",", " ", "lzv"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"getInitCostates", "[", 
         RowBox[{"varMat_", ",", "icsRel_", ",", "fcsRel_"}], "]"}], ":=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{
          RowBox[{"varMat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "6"}], ",", 
             RowBox[{"7", ";;", "12"}]}], "]"}], "]"}], ",", 
          RowBox[{"fcsRel", "-", 
           RowBox[{
            RowBox[{"varMat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "6"}], ",", 
               RowBox[{"1", ";;", "6"}]}], "]"}], "]"}], ".", "icsRel"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"topLeftMatrix", "=", "A"}], ";", "\[IndentingNewLine]", 
       RowBox[{"topRightMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"middleRightMatrix", "=", 
        RowBox[{"-", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ";", "\n", "     ", 
       RowBox[{"bottomRightMatrix", "=", 
        RowBox[{
         RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bottomLeftMatrix", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"A", ",", " ", 
            RowBox[{"Join", "[", " ", 
             RowBox[{"topRightMatrix", ",", " ", 
              RowBox[{"Join", "[", 
               RowBox[{
               "middleLeftMatrix", ",", " ", "middleRightMatrix", ",", " ", 
                "2"}], "]"}]}], "]"}], ",", " ", "2"}], "]"}], ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
           "bottomLeftMatrix", ",", " ", "bottomRightMatrix", ",", " ", "2"}],
            " ", "]"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stm", "[", "tf_", "]"}], " ", ":=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"fullmatrix", " ", "tf"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initCo", " ", "=", " ", 
        RowBox[{"getInitCostates", "[", 
         RowBox[{
          RowBox[{"stm", "[", "td", "]"}], ",", " ", "icRel", ",", " ", 
          "fcRel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lambdastm", "[", "ta_", "]"}], " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "A"}], " ", "//", " ", "Transpose"}], ")"}], " ", 
          "ta"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{"lma", " ", "=", " ", 
        RowBox[{
         RowBox[{"isp", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lambdastm", "[", 
                 RowBox[{"mmax", " ", 
                  RowBox[{"isp", " ", "/", " ", "tmax"}]}], "]"}], ".", 
                "initCo"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "6"}], "]"}], "]"}], "   ", "//", " ", 
             "Norm"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"m0", " ", "-", " ", "mmax"}], ")"}]}]}], " ", "+", " ", 
         RowBox[{"NIntegrate", "[", "  ", 
          RowBox[{
           RowBox[{"tmax", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"lambdastm", "[", "t", "]"}], ".", "initCo"}], 
                  ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"4", ";;", "6"}], "]"}], "]"}], ")"}], " ", "//", 
               " ", "Norm"}], ")"}], " ", "/", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m0", " ", "-", " ", 
                 RowBox[{"tmax", " ", 
                  RowBox[{"t", " ", "/", " ", "isp"}]}]}], ")"}], " ", "^", 
               "2"}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", 
             RowBox[{"mmax", " ", 
              RowBox[{"isp", " ", "/", " ", "tmax"}]}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initCoM", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"initCo", ",", " ", 
          RowBox[{"{", "lma", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "initCoM"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "fm", " ", "is", " ", "fixed", " ", "magnitude", " ", "for", " ", 
     "direction", " ", "on", " ", "the", " ", "unit", " ", 
     RowBox[{"circle", ".", " ", "performs"}], " ", "root", " ", "finding", " ",
      "in", " ", "angle", " ", "and", " ", "ratio", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfind", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "fm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initAngle", " ", "=", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"init", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"init", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
          "timeLength"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"fm", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Cos"}], 
                    " ", ",", " ", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Sin"}], ",",
                     " ", "0"}], "}"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"(", 
                    RowBox[{"fm", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Cos"}], 
                    ")"}]}], ")"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"(", 
                    RowBox[{"fm", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Sin"}], 
                    ")"}]}], ")"}]}]}], "}"}]}]}], " ", "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "*", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"fm", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Cos"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "//", " ", "Sin"}]}],
                     "}"}]}], ")"}], " ", "//", " ", "Norm"}], ")"}]}]}], 
                   "}"}]}], "]"}]}], "]"}], ",", " ", "isp", ",", " ", 
              "timeLength", ",", " ", "tm", ",", " ", "A"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
              " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
             "m0"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{"initAngle", ",", "  ", 
               RowBox[{
                RowBox[{"init", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"fm", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"initAngle", " ", "//", " ", "Cos"}], ",", " ", 
                    RowBox[{"initAngle", " ", "//", " ", "Sin"}]}], "}"}]}], 
                   ")"}], "   ", "//", " ", "Norm"}], ")"}]}]}], "}"}]}], " ",
             "}"}], "}"}], ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"PrecisionGoal", "->", "20"}], ",", 
          RowBox[{"Method", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<Newton\>\"", ",", 
             RowBox[{"\"\<LinearSolver\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"LinearSolve", ",", 
                RowBox[{"\"\<Method\>\"", "->", "\"\<Krylov\>\""}]}], 
               "}"}]}]}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"poss", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], " ", 
            "//", " ", "Cos"}], ")"}]}], ",", " ", 
         RowBox[{"fm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"poss", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], " ", 
            "//", " ", "Sin"}], ")"}]}], ",", " ", 
         RowBox[{
          RowBox[{"poss", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "2", ",", " ", "2"}], "]"}], "]"}], " ", "*",
           " ", "fm"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindnomass", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "s_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lmguess", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], " ", "]"}],
                   ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "lmguess"}], "}"}]}], "]"}]}], 
               "]"}], ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm",
               ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
              " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
             "m0"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"MaxIterations", "->", "100"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", " ", "2", ",", " ", "1"}], "]"}], "]"}], ",", 
         " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", "lmguess"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindym", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "s_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xguess", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xguess", " ", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", "xguess"}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}]}], " ", "]"}],
                   ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm", ",", 
              " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
              " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
             "m0"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"MaxIterations", "->", "100"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"xguess", ",", " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindxm", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "s_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"yguess", " ", "=", " ", 
        RowBox[{"init", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", "yguess", ",",
                     " ", "0"}], "}"}], ",", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", "yguess"}]}], "}"}]}]}], " ", 
                   "]"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm", ",", 
              " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"cons", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
              " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
             "m0"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"MaxIterations", "->", "100"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", " ", 
         "yguess", ",", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rootfindall", "[", 
     RowBox[{
     "init_", ",", " ", "mm_", ",", " ", "direction_", ",", " ", "A_", ",", 
      " ", "m0_", ",", " ", "isp_", ",", " ", "timeLength_", ",", " ", "tm_", 
      ",", " ", "s_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falt", "[", "joint_", "]"}], ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", " ", 
            RowBox[{"propStateCostatev2", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "m0"}], "}"}], ",", "   ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], " ", "]"}],
                   ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"joint", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
               ",", " ", "isp", ",", " ", "timeLength", ",", " ", "tm", ",", 
              " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"joint", " ", "//", " ", "Print"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"consaug", "[", 
             RowBox[{"direction", ",", " ", 
              RowBox[{"out", "[", 
               RowBox[{"[", 
                RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
              RowBox[{"out", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
               " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
              "m0"}], "]"}], " ", "//", " ", "Print"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"consaug", "[", 
            RowBox[{"direction", ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
             RowBox[{"out", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", " ", "mm", ",",
              " ", "timeLength", ",", " ", "tm", ",", " ", "isp", ",", " ", 
             "m0"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"poss", " ", "=", " ", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"falt", "[", "l", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"init", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
               RowBox[{"init", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], " ", "}"}], "}"}], 
          ",", " ", 
          RowBox[{"Evaluated", "\[Rule]", "False"}], ",", " ", 
          RowBox[{"MaxIterations", "->", "100"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "*", " ", "if", " ", "poss", " ", "does", " ", "not", " ", "satisfy",
           " ", "the", " ", "directional", " ", "and", " ", "mass", " ", 
          "constraints", " ", "within", " ", "satisfaction"}], ",", " ", 
         RowBox[{
         "try", " ", "again", " ", "with", " ", "the", " ", "two", " ", 
          "other", " ", "possible", " ", "values", " ", "for", " ", "lambda", 
          " ", "y"}], ",", " ", 
         RowBox[{"and", " ", "pick", " ", "the", " ", "best"}]}], " ", 
        "**)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], ",", " ", 
         RowBox[{"poss", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2", ",", "3"}], "]"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getReachablePoint", "[", 
     RowBox[{
     "direction_", ",", " ", "endTime_", ",", " ", "tmax_", ",", " ", "n_", ",",
       " ", "m0_", ",", " ", "A_", ",", " ", "fuelpercent_", ",", " ", 
      "isp_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posf", " ", "=", " ", 
        RowBox[{"getFinalEnergyPos", "[", 
         RowBox[{
         "endTime", ",", " ", "tmax", ",", " ", "n", ",", " ", "direction", ",",
           " ", "fuelpercent"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initCostates", " ", "=", " ", 
        RowBox[{"findInitialCostates", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
           "}"}], ",", " ", "posf", ",", " ", "n", ",", " ", "A", ",", " ", 
          "endTime", ",", " ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", ",", 
          " ", "tmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialGuess2", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"initCostates", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"initCostates", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<root finding\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lxm2", " ", "=", " ", 
        RowBox[{"rootfindxm", "[", 
         RowBox[{"initialGuess2", " ", 
          RowBox[{"(*", 
           RowBox[{"/", 
            RowBox[{"(", 
             RowBox[{"7.24", " ", "*", " ", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{"-", "7"}], ")"}]}], " ", "/", " ", 
               RowBox[{"(", 
                RowBox[{"28496.1", " ", "/", " ", 
                 RowBox[{"(", 
                  RowBox[{"-", "0.704"}], ")"}]}], ")"}]}]}], ")"}]}], "*)"}],
           " ", ",", "  ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
          RowBox[{"direction", " ", "//", " ", "N"}], ",", " ", "A", ",", " ",
           "m0", ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax", ",", 
          "s"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", " ", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"lxm2", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax", ",",
           " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lxm2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "  ", "//", " ", "Print"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"out", "[", 
            RowBox[{"[", 
             RowBox[{"8", ";;", "9"}], "]"}], "]"}], " ", "//", " ", 
           "Normalize"}], ")"}], ".", "direction"}], " ", "//", " ", 
        "Print"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", "Norm"}], 
        " ", "//", " ", "Print"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"8", ";;", "9"}], "]"}], "]"}], " ", "//", " ", "Norm"}], 
        " ", "//", " ", "Print"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"consaug", "[", 
         RowBox[{"direction", ",", " ", 
          RowBox[{"out", "[", 
           RowBox[{"[", 
            RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
          RowBox[{"out", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "7"}], "]"}], "]"}], ",", " ", 
          RowBox[{"tmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "endTime", ",",
           " ", "tmax", ",", " ", "isp", ",", " ", "m0"}], "]"}], " ", "//", 
        " ", "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
         "Normalize"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"direction", " ", "//", " ", "N"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"out", ",", " ", "lxm2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9522861895468063`*^9, 3.9522861898199377`*^9}, {
   3.952286798273657*^9, 3.952286805975416*^9}, {3.952286921223054*^9, 
   3.952286942661222*^9}, {3.9522871876648893`*^9, 3.9522872082522383`*^9}, 
   3.952287501825296*^9, {3.952290472087657*^9, 3.9522904742648993`*^9}, {
   3.952293106009499*^9, 3.95229312708536*^9}, 3.9522931914741488`*^9, {
   3.9522932230855503`*^9, 3.952293279043066*^9}, {3.952293337820467*^9, 
   3.952293437471656*^9}, {3.9522935394640617`*^9, 3.952293569761074*^9}, {
   3.952293761093302*^9, 3.952293761321594*^9}, {3.952297554298175*^9, 
   3.9522976029996243`*^9}, {3.952342743207121*^9, 3.952342746333531*^9}, {
   3.952342785153657*^9, 3.9523427899516287`*^9}, {3.9523432507805977`*^9, 
   3.9523432698635807`*^9}, {3.952343314283102*^9, 3.9523433249908457`*^9}, {
   3.952343406507234*^9, 3.9523434215335283`*^9}, {3.952345615189752*^9, 
   3.952345631747403*^9}, {3.9523457448751907`*^9, 3.952345768122336*^9}, {
   3.952345808276223*^9, 3.952345838706813*^9}, {3.952346110208201*^9, 
   3.952346111204088*^9}, {3.9523660244985943`*^9, 3.952366200204225*^9}, {
   3.952368366840674*^9, 3.952368440432873*^9}, {3.9523691088083553`*^9, 
   3.952369131110515*^9}, {3.9523692756190166`*^9, 3.952369286930372*^9}, {
   3.952369330354649*^9, 3.952369337097043*^9}, 3.952370958397942*^9, {
   3.952454966562893*^9, 3.952455008201264*^9}, {3.952899822202219*^9, 
   3.952899838090053*^9}, {3.9528999598818913`*^9, 3.9528999897451963`*^9}, 
   3.952900044475627*^9, {3.9529000940072613`*^9, 3.952900262382045*^9}, {
   3.9529003059444857`*^9, 3.95290031180359*^9}, {3.952900404539404*^9, 
   3.952900528063849*^9}, {3.952901090199501*^9, 3.952901098516623*^9}, {
   3.952901150897871*^9, 3.9529011716809893`*^9}, {3.952901212074098*^9, 
   3.9529012930671377`*^9}, {3.9529020203964777`*^9, 3.952902035836121*^9}, {
   3.9530723353608522`*^9, 3.9530723643505383`*^9}, {3.95307256928831*^9, 
   3.953072569663443*^9}, {3.953073154759439*^9, 3.953073156018839*^9}, 
   3.953073469339456*^9, {3.953238845049008*^9, 3.953238849801834*^9}, {
   3.953238897015877*^9, 3.953238899284683*^9}, {3.953240945754616*^9, 
   3.953241036937277*^9}, {3.953241100467914*^9, 3.953241100542523*^9}, {
   3.953241131843143*^9, 3.953241136461337*^9}, {3.953241174439218*^9, 
   3.953241182068922*^9}, {3.953241228956056*^9, 3.9532412307691183`*^9}, {
   3.953241263602892*^9, 3.953241276539073*^9}, {3.9532413589515457`*^9, 
   3.953241360441743*^9}, {3.9532413906228113`*^9, 3.953241391023758*^9}, {
   3.953241526890616*^9, 3.953241530613055*^9}, {3.953241716187561*^9, 
   3.953241718185549*^9}, {3.95324186162784*^9, 3.953241874789899*^9}, {
   3.9532419239574633`*^9, 3.953242018775745*^9}, {3.953242062261344*^9, 
   3.9532420645139093`*^9}, {3.9532428918547907`*^9, 
   3.9532429008134193`*^9}, {3.9532460917066107`*^9, 3.953246106153384*^9}, {
   3.953247673141028*^9, 3.953247698274508*^9}, {3.953247812324787*^9, 
   3.95324787644486*^9}, {3.953248208390069*^9, 3.9532482121485767`*^9}, {
   3.953249396530427*^9, 3.95324939793887*^9}, {3.953420206769869*^9, 
   3.953420221194186*^9}, {3.9534202953461123`*^9, 3.9534202965915813`*^9}, {
   3.95342034346915*^9, 3.953420353009055*^9}, {3.953420388857719*^9, 
   3.953420428109112*^9}, {3.953420505816608*^9, 3.953420508315679*^9}, {
   3.9534207364984426`*^9, 3.953420751809957*^9}, {3.953420930541477*^9, 
   3.953420931824958*^9}, {3.953420964674275*^9, 3.9534209822637177`*^9}, {
   3.953557272389435*^9, 3.9535572799725847`*^9}, {3.953755314074774*^9, 
   3.953755319544126*^9}, {3.9537558357202272`*^9, 3.953755954124145*^9}, {
   3.953756238491393*^9, 3.953756241404359*^9}, {3.953756335794127*^9, 
   3.953756338411992*^9}, {3.9537565485689*^9, 3.953756548739768*^9}, {
   3.9537566997315187`*^9, 3.953756713487565*^9}, 3.9537567938843937`*^9, {
   3.9537568676771803`*^9, 3.953756870626419*^9}, {3.953756919550783*^9, 
   3.953757048425983*^9}, {3.953758611869567*^9, 3.953758614571252*^9}, {
   3.9537659073507433`*^9, 3.953765911035673*^9}, {3.9537661041206408`*^9, 
   3.953766107909835*^9}, {3.953766163445509*^9, 3.953766200508175*^9}, {
   3.953766370613573*^9, 3.953766392184218*^9}, {3.953810739476536*^9, 
   3.953810741325593*^9}, {3.953810876736455*^9, 3.953810886373407*^9}, {
   3.9538112987331753`*^9, 3.953811302910439*^9}, {3.95381133514288*^9, 
   3.953811359417729*^9}, {3.953812847824155*^9, 3.953812887951309*^9}, {
   3.954105891117484*^9, 3.954105910289761*^9}, {3.9541072196521606`*^9, 
   3.954107233594841*^9}, {3.954107271158557*^9, 3.95410727274585*^9}, {
   3.9541074043984127`*^9, 3.954107405410844*^9}, {3.954107457481263*^9, 
   3.954107488718667*^9}, {3.954107628872036*^9, 3.954107629774729*^9}, {
   3.954107673945853*^9, 3.9541076751735353`*^9}, {3.954107706161664*^9, 
   3.954107707137967*^9}, {3.954107759858828*^9, 3.954107793114513*^9}, {
   3.954107862170251*^9, 3.954107862605736*^9}, {3.954163835891556*^9, 
   3.954163918916589*^9}, {3.954163959888249*^9, 3.954163965413522*^9}, {
   3.954164106203271*^9, 3.954164282416133*^9}, {3.954164436649363*^9, 
   3.954164553354854*^9}, {3.9541646291961117`*^9, 3.95416465904543*^9}, {
   3.954164690616124*^9, 3.954164691092448*^9}, {3.9541647229652977`*^9, 
   3.9541647243579893`*^9}, {3.9541648026793623`*^9, 3.954164873311146*^9}, {
   3.95416491759573*^9, 3.95416492246097*^9}, {3.9541650058246193`*^9, 
   3.954165006033298*^9}, {3.954165120952338*^9, 3.95416531086403*^9}, 
   3.954165411084741*^9, {3.95416563262613*^9, 3.954165685139414*^9}, {
   3.9541657348684196`*^9, 3.95416595952966*^9}, {3.954165995867111*^9, 
   3.9541660171604033`*^9}, {3.9541660950352583`*^9, 3.954166098905279*^9}, {
   3.954166139529359*^9, 3.9541662006656437`*^9}, {3.954166250512227*^9, 
   3.9541662529231043`*^9}, {3.9541663514878187`*^9, 3.954166429662941*^9}, {
   3.954166492716241*^9, 3.95416660852588*^9}, {3.954166686495265*^9, 
   3.954166732307219*^9}, {3.954166789409828*^9, 3.954166836768796*^9}, {
   3.954166956145462*^9, 3.954166978743422*^9}, {3.954167071821563*^9, 
   3.954167074414653*^9}, {3.9541671055664387`*^9, 3.954167203404813*^9}, {
   3.954167260397629*^9, 3.954167268442148*^9}, {3.954167305167473*^9, 
   3.954167312605775*^9}, {3.954167344037733*^9, 3.954167346257613*^9}, {
   3.954167390230323*^9, 3.954167392523485*^9}, {3.95416749091637*^9, 
   3.9541675165725727`*^9}, {3.954167562925186*^9, 3.95416756389677*^9}, {
   3.954167612027432*^9, 3.954167613384617*^9}, {3.9541676676002502`*^9, 
   3.954167670038355*^9}, {3.954167727364522*^9, 3.95416772930744*^9}, {
   3.954167791267799*^9, 3.9541677987644863`*^9}, {3.954167836342848*^9, 
   3.954167844847267*^9}, {3.9541678760707073`*^9, 3.954167894661744*^9}, {
   3.954167928993951*^9, 3.954167931202574*^9}, {3.954168019594975*^9, 
   3.9541680200502577`*^9}, {3.9541680520717382`*^9, 3.95416805515219*^9}, {
   3.9541680933732033`*^9, 3.9541680951374807`*^9}, {3.954168210896049*^9, 
   3.954168217797778*^9}, {3.954168281169986*^9, 3.954168281947998*^9}, {
   3.954168333000429*^9, 3.954168337725257*^9}, {3.954168437739764*^9, 
   3.954168540652954*^9}, {3.954168627105318*^9, 3.954168627210064*^9}, {
   3.954168682220626*^9, 3.954168685891818*^9}, {3.954168722392322*^9, 
   3.954168855719338*^9}, {3.954168899707891*^9, 3.954168906576539*^9}, {
   3.954168944271119*^9, 3.954168962159608*^9}, {3.954168997566407*^9, 
   3.9541690222435293`*^9}, {3.9541690812453423`*^9, 
   3.9541690924959183`*^9}, {3.954169132229919*^9, 3.9541691408150177`*^9}, 
   3.954169208705476*^9, {3.9541692428430853`*^9, 3.9541692874727*^9}, {
   3.954169336463397*^9, 3.954169448309972*^9}, {3.954169574817325*^9, 
   3.9541695968387547`*^9}, {3.954169678744761*^9, 3.954169696075747*^9}, {
   3.95416978662029*^9, 3.954169813290388*^9}, {3.954169930519487*^9, 
   3.954169941964587*^9}, {3.954170034400527*^9, 3.954170037651689*^9}, {
   3.9541700705027437`*^9, 3.954170073387662*^9}, {3.954170132276342*^9, 
   3.954170175970788*^9}, {3.9541702242911787`*^9, 3.95417027127693*^9}, 
   3.9541703538839827`*^9, {3.954263421778676*^9, 3.954263455306785*^9}, {
   3.954263544132971*^9, 3.954263566904787*^9}, {3.954263604444192*^9, 
   3.9542636348006487`*^9}, {3.954263714766315*^9, 3.9542638723468447`*^9}, {
   3.9542640152271233`*^9, 3.954264019603799*^9}, {3.954264115979011*^9, 
   3.9542641278739862`*^9}, {3.9542642283625307`*^9, 3.954264290508336*^9}, {
   3.954264430550748*^9, 3.954264430726807*^9}, {3.954266215649693*^9, 
   3.9542662231562757`*^9}, {3.954266299313772*^9, 3.954266301625218*^9}, 
   3.954267150152554*^9, {3.954267994537332*^9, 3.954267994712349*^9}, {
   3.9542681397428207`*^9, 3.954268144241683*^9}, {3.9542682220347853`*^9, 
   3.954268240734536*^9}, {3.95426831652308*^9, 3.9542683523646173`*^9}, {
   3.954268512325409*^9, 3.954268519658062*^9}, {3.954268638931696*^9, 
   3.954268639001267*^9}, {3.954268793863655*^9, 3.954268803383669*^9}, {
   3.954269257874892*^9, 3.95426929211106*^9}, 3.954269815485959*^9, {
   3.954269936449998*^9, 3.954269936953341*^9}, {3.9542700291813*^9, 
   3.954270031317697*^9}, {3.954270074398252*^9, 3.954270078631843*^9}, {
   3.954282110107883*^9, 3.954282111988474*^9}, 3.95428218581553*^9, {
   3.954284468793827*^9, 3.954284521194305*^9}, {3.954284592652287*^9, 
   3.954284609967596*^9}, {3.9542846491600924`*^9, 3.9542847066892233`*^9}, {
   3.954284774624577*^9, 3.954284801656589*^9}, {3.954285273135934*^9, 
   3.954285296733758*^9}, {3.9542853411353617`*^9, 3.954285408580018*^9}, {
   3.954285443116262*^9, 3.954285469012586*^9}, {3.954285509504367*^9, 
   3.954285512496724*^9}, {3.954285557249592*^9, 3.954285560390607*^9}, {
   3.954285888778235*^9, 3.954285920319046*^9}, {3.954285994081153*^9, 
   3.954285994194243*^9}, {3.954286421516883*^9, 3.954286474513172*^9}, {
   3.954286874968114*^9, 3.954286917718732*^9}, {3.9542869837284327`*^9, 
   3.954286989778636*^9}, {3.9542870569105797`*^9, 3.954287066273809*^9}, {
   3.954287270664263*^9, 3.954287318817733*^9}, {3.954287722181919*^9, 
   3.954287722226667*^9}, {3.9542878846816053`*^9, 3.954287886855114*^9}, {
   3.954287967731928*^9, 3.954287971153306*^9}, {3.95428808987687*^9, 
   3.954288102757855*^9}, 3.9543609356447*^9, {3.954361129683123*^9, 
   3.954361161246748*^9}, {3.9543617432008*^9, 3.9543617579116793`*^9}, {
   3.954361877845327*^9, 3.954361879818369*^9}, {3.954361917329094*^9, 
   3.954361933644614*^9}, {3.954362152875846*^9, 3.954362159933543*^9}, {
   3.954362204954403*^9, 3.95436221631249*^9}, {3.9543622543098583`*^9, 
   3.9543622845370092`*^9}, {3.954363057411014*^9, 3.954363058210026*^9}, {
   3.954363088244832*^9, 3.954363131813496*^9}, {3.954363201481937*^9, 
   3.954363218049272*^9}, {3.9543633575349817`*^9, 3.954363358539702*^9}, {
   3.954363416282095*^9, 3.954363426574451*^9}, {3.954363532047118*^9, 
   3.954363532094507*^9}, {3.9543635890053797`*^9, 3.954363624057859*^9}, {
   3.954363753899168*^9, 3.9543637562681828`*^9}, 3.9543681658872337`*^9, {
   3.954368317921144*^9, 3.954368359378334*^9}, {3.954368477143304*^9, 
   3.9543684813336763`*^9}, {3.954512656852289*^9, 3.954512741957398*^9}, {
   3.954512811236536*^9, 3.954512812940991*^9}, {3.954512951592369*^9, 
   3.954512964551206*^9}, {3.954513118894232*^9, 3.954513127630007*^9}, {
   3.95451315847336*^9, 3.954513159345458*^9}, {3.9545131996871567`*^9, 
   3.954513292446636*^9}, 3.954513389106822*^9, {3.9548571755454817`*^9, 
   3.954857283251363*^9}, {3.954857625793347*^9, 3.9548576288533697`*^9}, {
   3.954857878414812*^9, 3.954857878454473*^9}, {3.954861166492044*^9, 
   3.954861245378293*^9}, {3.9548612929217176`*^9, 3.954861293467443*^9}, {
   3.954861359443074*^9, 3.954861359519393*^9}, {3.954861398423347*^9, 
   3.9548614263688183`*^9}, {3.954883955382243*^9, 3.954883985067711*^9}, 
   3.954884019439012*^9, {3.954884445838155*^9, 3.9548845098165627`*^9}, {
   3.954884721232733*^9, 3.95488480526893*^9}, {3.955029489915367*^9, 
   3.9550294925666847`*^9}, {3.955029543990609*^9, 3.9550295448283453`*^9}, {
   3.955030907111039*^9, 3.955030983682229*^9}, {3.9550310540744953`*^9, 
   3.955031054915983*^9}, {3.955031094834914*^9, 3.955031094912015*^9}, {
   3.95503112666365*^9, 3.9550311614224463`*^9}, {3.955031207805414*^9, 
   3.95503122023706*^9}, {3.955031283870407*^9, 3.955031312537524*^9}, {
   3.955031354358995*^9, 3.955031359020844*^9}, {3.955107295464868*^9, 
   3.95510729934134*^9}, 3.955228584990591*^9, {3.955228800869669*^9, 
   3.955228808499107*^9}, {3.9552288765721407`*^9, 3.955228876851252*^9}, {
   3.955238599451826*^9, 3.955238631429912*^9}, {3.955279146428945*^9, 
   3.9552791762702017`*^9}, {3.955279223178965*^9, 3.9552792409306927`*^9}, {
   3.9552792853543673`*^9, 3.9552793183653917`*^9}, {3.955279356598674*^9, 
   3.955279362067861*^9}, {3.955302838391342*^9, 3.955302841199052*^9}, {
   3.955302873034342*^9, 3.955302886539719*^9}, {3.955302918495644*^9, 
   3.955302927964731*^9}, 3.955443323567855*^9, 3.955443384586752*^9, {
   3.955443942330531*^9, 3.9554439426200027`*^9}, {3.955444018117655*^9, 
   3.955444022130452*^9}, {3.955444490156994*^9, 3.955444490354575*^9}, {
   3.955444544564455*^9, 3.955444583518971*^9}, {3.955444648472198*^9, 
   3.955444680740613*^9}, {3.955444862151491*^9, 3.955444887386422*^9}, {
   3.955454320259951*^9, 3.9554544731574183`*^9}, {3.955454505486744*^9, 
   3.95545450787576*^9}, {3.955454692670321*^9, 3.9554547035419493`*^9}, {
   3.955455126587257*^9, 3.95545513955516*^9}, {3.955455243026523*^9, 
   3.9554552628008823`*^9}, {3.9554557627673283`*^9, 3.955455836655319*^9}, {
   3.9554558973909197`*^9, 3.955455973636466*^9}, {3.955456007062151*^9, 
   3.95545600786362*^9}, {3.955456039033113*^9, 3.955456041857984*^9}, {
   3.955456120564139*^9, 3.9554561222389402`*^9}, {3.955456622141324*^9, 
   3.955456624189872*^9}, {3.955456842426929*^9, 3.955456845853086*^9}, {
   3.955456909582726*^9, 3.955456910030492*^9}, {3.955456954306814*^9, 
   3.955456975314733*^9}, {3.955457341929142*^9, 3.9554573427384453`*^9}, {
   3.955457376379375*^9, 3.955457425470601*^9}, {3.955457505784536*^9, 
   3.955457505853354*^9}, {3.9554575525093117`*^9, 3.955457552691449*^9}, {
   3.955457617145595*^9, 3.955457629483148*^9}, {3.955457737326392*^9, 
   3.955457754646772*^9}, {3.955457787266108*^9, 3.9554577938272247`*^9}, {
   3.955457886608873*^9, 3.955457890824586*^9}, {3.955457933948121*^9, 
   3.955457943116786*^9}, {3.955457975721233*^9, 3.9554579809841757`*^9}, {
   3.955458033187394*^9, 3.9554580411135263`*^9}, {3.9554616717075977`*^9, 
   3.955461679954783*^9}, {3.955461729017889*^9, 3.955461729973432*^9}, {
   3.955461820876165*^9, 3.9554618209911613`*^9}, {3.9554619016800623`*^9, 
   3.9554619082636223`*^9}, {3.9554620555852222`*^9, 
   3.9554620590243464`*^9}, {3.955462227921424*^9, 3.9554622281296577`*^9}, {
   3.955462593510379*^9, 3.9554625941065083`*^9}, {3.9554626609923477`*^9, 
   3.955462717600729*^9}, {3.955462835343655*^9, 3.955462837635798*^9}, 
   3.955483944480236*^9, {3.9554840273685417`*^9, 3.955484042077289*^9}, {
   3.9554841760093937`*^9, 3.95548420289219*^9}, {3.955568143638234*^9, 
   3.955568156022978*^9}, {3.955568205537204*^9, 3.955568239983692*^9}, {
   3.955568294107402*^9, 3.955568297327401*^9}, {3.9555683300065002`*^9, 
   3.955568357938641*^9}, {3.9555683924476213`*^9, 3.9555683935844393`*^9}, {
   3.955568481805903*^9, 3.955568500435581*^9}, {3.9555685356507673`*^9, 
   3.955568544467382*^9}, {3.955568623054965*^9, 3.955568625779748*^9}, {
   3.955616356799931*^9, 3.955616385660356*^9}, {3.955616449400972*^9, 
   3.955616450333695*^9}, {3.955616546490088*^9, 3.95561655019094*^9}, 
   3.955616603904134*^9, {3.955616663848483*^9, 3.9556167405841503`*^9}, {
   3.9556168161992826`*^9, 3.9556168534209747`*^9}, {3.955649968794354*^9, 
   3.955649970960248*^9}, {3.9556500120409203`*^9, 3.9556500121028976`*^9}, {
   3.9556501274363813`*^9, 3.9556501552935057`*^9}, {3.95565030212468*^9, 
   3.9556503021657257`*^9}, {3.9556505943432198`*^9, 
   3.9556506420406437`*^9}, {3.955650704276524*^9, 3.955650706966317*^9}, {
   3.9556507379476223`*^9, 3.9556507434243917`*^9}, {3.955650800304386*^9, 
   3.955650803371419*^9}, {3.955650838146626*^9, 3.9556508496541443`*^9}, {
   3.9556509675960007`*^9, 3.955650987376719*^9}, {3.9556510196071167`*^9, 
   3.955651019937009*^9}, {3.955651052545938*^9, 3.9556510540186377`*^9}, {
   3.9556567488394613`*^9, 3.955656752245385*^9}, {3.955656928871076*^9, 
   3.955656928933936*^9}, {3.955657550976803*^9, 3.955657561579533*^9}, 
   3.955657609243981*^9, {3.9556576574565372`*^9, 3.9556576574992323`*^9}, {
   3.9556576974326687`*^9, 3.955657726721758*^9}, {3.955657983938758*^9, 
   3.9556580079299994`*^9}, {3.955658105943643*^9, 3.9556581072889137`*^9}, {
   3.9556583782489634`*^9, 3.955658409200173*^9}, {3.955658473582017*^9, 
   3.955658517300696*^9}, 3.955658812980413*^9, {3.955658942620058*^9, 
   3.955658942851325*^9}, {3.955658973437456*^9, 3.955658985967032*^9}, {
   3.955659043577859*^9, 3.955659044045043*^9}, {3.955659084456415*^9, 
   3.955659127592431*^9}, {3.955659178942419*^9, 3.955659243651422*^9}, {
   3.95565929180513*^9, 3.9556592926466217`*^9}, {3.9556593308126097`*^9, 
   3.9556593312552156`*^9}, {3.9556594200347033`*^9, 
   3.9556594202364492`*^9}, {3.955659842434519*^9, 3.955659843037038*^9}, {
   3.9556622084962187`*^9, 3.955662256927369*^9}, {3.955662297398673*^9, 
   3.955662307187667*^9}, {3.955662427649548*^9, 3.955662475291297*^9}, {
   3.95566254556629*^9, 3.9556625496684847`*^9}, {3.955662943356765*^9, 
   3.955662943866405*^9}, {3.95566300875415*^9, 3.955663009197047*^9}, {
   3.95566304817655*^9, 3.9556630505254993`*^9}, {3.955665941299055*^9, 
   3.9556659538534737`*^9}, 3.955666303854393*^9, {3.955666377577166*^9, 
   3.9556663827562428`*^9}, {3.955666629380919*^9, 3.955666653177936*^9}, {
   3.955666697540186*^9, 3.955666749777439*^9}, {3.955666790246716*^9, 
   3.9556667911432333`*^9}, {3.955666829584898*^9, 3.9556668297091627`*^9}, {
   3.955710782296977*^9, 3.955710798592277*^9}, {3.955742697719655*^9, 
   3.955742707059959*^9}, {3.9557427478838177`*^9, 3.9557427520530777`*^9}, {
   3.955742797752036*^9, 3.95574280315068*^9}, {3.9557428365264397`*^9, 
   3.955742837517458*^9}, {3.955742869324209*^9, 3.9557429429271584`*^9}, 
   3.955742977174272*^9, {3.9557430173033524`*^9, 3.955743018168193*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"de278eee-eaf1-408d-9535-e92a4ec67043"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedPointIterator", "[", 
   RowBox[{
   "x0_", ",", " ", "t_", ",", " ", "dey_", ",", " ", "fuelperc_", ",", " ", 
    "tm_", ",", " ", "is_", ",", " ", "n_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"chw", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
           " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
           "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
          "0", ",", " ", 
          RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", 
          RowBox[{"-", 
           RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
          "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"chw", " ", "//", "Transpose"}], ")"}]}], " ", "t"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
           "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"udd", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", "//", " ", "IdentityMatrix"}], ")"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "dey", "}"}], " ", "//", " ", "Transpose"}], ")"}], ".", 
        RowBox[{"{", "dey", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cons", "[", "lfxf_", "]"}], " ", ":=", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c1", " ", "=", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"udd", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"lfxf", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"lfxf", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], " ", "//", " ", 
               "Normalize"}], " ", ")"}]}], ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c2", " ", "=", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m0", " ", "-", " ", 
             RowBox[{"lfxf", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}], " ", "-", 
           RowBox[{"tm", " ", "fuelperc", " ", 
            RowBox[{"t", " ", "/", " ", "is"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"c1", ",", " ", "\[IndentingNewLine]", "c2"}], "]"}], " ", "//",
          " ", "Flatten"}]}], "\[IndentingNewLine]", ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cons3", "[", "lfxf_", "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c1", " ", "=", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"udd", ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lfxf", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"lfxf", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], " ", "//", " ", 
                "Normalize"}], " ", ")"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m0", " ", "-", " ", 
              RowBox[{"lfxf", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ")"}], " ", "-", 
            RowBox[{"tm", " ", "fuelperc", " ", 
             RowBox[{"t", " ", "/", " ", "is"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c3", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lfxf", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ";;", "5"}], "]"}], "]"}], " ", "//", " ", 
               "Transpose"}], ")"}], ".", "dey"}], " ", "+", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"lfxf", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", 
              "Norm"}], ")"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"c1", ",", " ", "c2"}], "]"}], ",", " ", "c3"}], "]"}], 
          " ", "//", " ", "Flatten"}]}]}], "\[IndentingNewLine]", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"funcProp", "[", 
       RowBox[{
        RowBox[{"lxx_", "?", "NumericQ"}], ",", 
        RowBox[{"lyy_", "?", "NumericQ"}], ",", 
        RowBox[{"lmm_", "?", "NumericQ"}]}], "]"}], ":=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"state", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"lxx", ",", "lyy", ",", "0"}], "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                 "subs"}], " ", ")"}], " ", "/.", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"v1", "->", "lxx"}], ",", " ", 
                 RowBox[{"v2", " ", "->", "lyy"}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "lmm"}], "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"cons", "[", 
         RowBox[{
          RowBox[{"propStateCostatev2", "[", 
           RowBox[{"state", ",", "is", ",", "t", ",", "tm", ",", "chw"}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "7", ",", "8", ",", "9"}], "}"}], 
           "]"}], "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jac", "[", 
       RowBox[{"lx_", ",", " ", "ly_", ",", " ", "lm_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"grad", "[", 
          RowBox[{"f_", ",", 
           RowBox[{"x", ":", 
            RowBox[{"{", 
             RowBox[{"__", "?", "NumericQ"}], "}"}]}], ",", 
           RowBox[{"h_", ":", 
            RowBox[{"10", "^", 
             RowBox[{"-", "12"}]}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "@@", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"i", "->", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "h"}]}]}], "]"}]}], "-", 
                RowBox[{"f", "@@", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"i", "->", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "h"}]}]}], "]"}]}]}],
                ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "h"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], ")"}], 
          " ", "//", " ", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"grad", "[", 
         RowBox[{"funcProp", ",", " ", 
          RowBox[{"{", 
           RowBox[{"lx", ",", " ", "ly", ",", " ", "lm"}], "}"}], ",", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "12"}]}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"JacobianElement", "[", 
       RowBox[{
        RowBox[{"x", ":", 
         RowBox[{"{", 
          RowBox[{"__", "?", "NumericQ"}], "}"}]}], ",", " ", "i_", " ", ",", 
        "j_"}], "]"}], " ", ":=", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"hFunc", "[", 
          RowBox[{"k_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"funcProp", "@@", " ", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"i", " ", "->", "#"}]}], "]"}]}], ")"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ")"}], "&"}], "[", "k", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ND", "[", 
         RowBox[{
          RowBox[{"hFunc", "[", "k", "]"}], ",", "k", ",", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
          RowBox[{"Terms", "->", "10"}], ",", " ", 
          RowBox[{"WorkingPrecision", "->", "20"}], ",", " ", 
          RowBox[{"Scale", "->", 
           RowBox[{"10", "^", 
            RowBox[{"-", "12"}]}]}]}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jacMathematicaVersion", "[", 
       RowBox[{"lx_", ",", " ", "ly_", ",", " ", "lm_"}], "]"}], " ", ":=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"JacobianElement", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lx", ",", " ", "ly", ",", " ", "lm"}], "}"}], ",", " ", 
           "i", ",", " ", "j"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", "3"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", "2"}], "}"}]}], "]"}], " ", "//", 
       " ", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NewtonExtended", "[", 
       RowBox[{
        RowBox[{"eps_", ":", 
         RowBox[{"10", "^", 
          RowBox[{"-", "20"}]}]}], ",", 
        RowBox[{"num_", ":", "1000"}]}], "]"}], ":=", 
      RowBox[{"FixedPointList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"j", " ", "=", 
              RowBox[{"jac", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ",", " ", 
             RowBox[{"fv", " ", "=", " ", 
              RowBox[{"funcProp", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
           RowBox[{"(", 
            RowBox[{"#", "-", 
             RowBox[{"LeastSquares", "[", 
              RowBox[{"j", ",", "fv"}], "]"}]}], ")"}]}], "]"}], "&"}], ",", 
        "x0", ",", "num", ",", 
        RowBox[{"SameTest", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "-", "#2"}], ")"}], ".", 
               RowBox[{"(", 
                RowBox[{"#1", "-", "#2"}], ")"}]}], "]"}], "]"}], "<", 
            "eps"}], "&"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"retval", " ", "=", " ", 
      RowBox[{
       RowBox[{"NewtonExtended", "[", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"-", "12"}]}], ",", " ", "100"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"funcProp", "[", 
       RowBox[{
        RowBox[{"retval", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"retval", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
        RowBox[{"retval", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], " ", "//", " ", "Print"}], ";",
      "\[IndentingNewLine]", "retval"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9522861895468063`*^9, 3.9522861898199377`*^9}, {
   3.952286798273657*^9, 3.952286805975416*^9}, {3.952286921223054*^9, 
   3.952286942661222*^9}, {3.9522871876648893`*^9, 3.9522872082522383`*^9}, 
   3.952287501825296*^9, {3.952290472087657*^9, 3.9522904742648993`*^9}, {
   3.952293106009499*^9, 3.95229312708536*^9}, 3.9522931914741488`*^9, {
   3.9522932230855503`*^9, 3.952293279043066*^9}, {3.952293337820467*^9, 
   3.952293437471656*^9}, {3.9522935394640617`*^9, 3.952293569761074*^9}, {
   3.952293761093302*^9, 3.952293761321594*^9}, {3.952297554298175*^9, 
   3.9522976029996243`*^9}, {3.952342743207121*^9, 3.952342746333531*^9}, {
   3.952342785153657*^9, 3.9523427899516287`*^9}, {3.9523432507805977`*^9, 
   3.9523432698635807`*^9}, {3.952343314283102*^9, 3.9523433249908457`*^9}, {
   3.952343406507234*^9, 3.9523434215335283`*^9}, {3.952345615189752*^9, 
   3.952345631747403*^9}, {3.9523457448751907`*^9, 3.952345768122336*^9}, {
   3.952345808276223*^9, 3.952345838706813*^9}, {3.952346110208201*^9, 
   3.952346111204088*^9}, {3.9523660244985943`*^9, 3.952366200204225*^9}, {
   3.952368366840674*^9, 3.952368440432873*^9}, {3.9523691088083553`*^9, 
   3.952369131110515*^9}, {3.9523692756190166`*^9, 3.952369286930372*^9}, {
   3.952369330354649*^9, 3.952369337097043*^9}, 3.952370958397942*^9, {
   3.952454966562893*^9, 3.952455008201264*^9}, {3.952899822202219*^9, 
   3.952899838090053*^9}, {3.9528999598818913`*^9, 3.9528999897451963`*^9}, 
   3.952900044475627*^9, {3.9529000940072613`*^9, 3.952900262382045*^9}, {
   3.9529003059444857`*^9, 3.95290031180359*^9}, {3.952900404539404*^9, 
   3.952900528063849*^9}, {3.952901090199501*^9, 3.952901098516623*^9}, {
   3.952901150897871*^9, 3.9529011716809893`*^9}, {3.952901212074098*^9, 
   3.9529012930671377`*^9}, {3.9529020203964777`*^9, 3.952902035836121*^9}, {
   3.9530723353608522`*^9, 3.9530723643505383`*^9}, {3.95307256928831*^9, 
   3.953072569663443*^9}, {3.953073154759439*^9, 3.953073156018839*^9}, 
   3.953073469339456*^9, {3.953238845049008*^9, 3.953238849801834*^9}, {
   3.953238897015877*^9, 3.953238899284683*^9}, {3.953240945754616*^9, 
   3.953241036937277*^9}, {3.953241100467914*^9, 3.953241100542523*^9}, {
   3.953241131843143*^9, 3.953241136461337*^9}, {3.953241174439218*^9, 
   3.953241182068922*^9}, {3.953241228956056*^9, 3.9532412307691183`*^9}, {
   3.953241263602892*^9, 3.953241276539073*^9}, {3.9532413589515457`*^9, 
   3.953241360441743*^9}, {3.9532413906228113`*^9, 3.953241391023758*^9}, {
   3.953241526890616*^9, 3.953241530613055*^9}, {3.953241716187561*^9, 
   3.953241718185549*^9}, {3.95324186162784*^9, 3.953241874789899*^9}, {
   3.9532419239574633`*^9, 3.953242018775745*^9}, {3.953242062261344*^9, 
   3.9532420645139093`*^9}, {3.9532428918547907`*^9, 
   3.9532429008134193`*^9}, {3.9532460917066107`*^9, 3.953246106153384*^9}, {
   3.953247673141028*^9, 3.953247698274508*^9}, {3.953247812324787*^9, 
   3.95324787644486*^9}, {3.953248208390069*^9, 3.9532482121485767`*^9}, {
   3.953249396530427*^9, 3.95324939793887*^9}, {3.953420206769869*^9, 
   3.953420221194186*^9}, {3.9534202953461123`*^9, 3.9534202965915813`*^9}, {
   3.95342034346915*^9, 3.953420353009055*^9}, {3.953420388857719*^9, 
   3.953420428109112*^9}, {3.953420505816608*^9, 3.953420508315679*^9}, {
   3.9534207364984426`*^9, 3.953420751809957*^9}, {3.953420930541477*^9, 
   3.953420931824958*^9}, {3.953420964674275*^9, 3.9534209822637177`*^9}, {
   3.953557272389435*^9, 3.9535572799725847`*^9}, {3.953755314074774*^9, 
   3.953755319544126*^9}, {3.9537558357202272`*^9, 3.953755954124145*^9}, {
   3.953756238491393*^9, 3.953756241404359*^9}, {3.953756335794127*^9, 
   3.953756338411992*^9}, {3.9537565485689*^9, 3.953756548739768*^9}, {
   3.9537566997315187`*^9, 3.953756713487565*^9}, 3.9537567938843937`*^9, {
   3.9537568676771803`*^9, 3.953756870626419*^9}, {3.953756919550783*^9, 
   3.953757048425983*^9}, {3.953758611869567*^9, 3.953758614571252*^9}, {
   3.9537659073507433`*^9, 3.953765911035673*^9}, {3.9537661041206408`*^9, 
   3.953766107909835*^9}, {3.953766163445509*^9, 3.953766200508175*^9}, {
   3.953766370613573*^9, 3.953766392184218*^9}, {3.953810739476536*^9, 
   3.953810741325593*^9}, {3.953810876736455*^9, 3.953810886373407*^9}, {
   3.9538112987331753`*^9, 3.953811302910439*^9}, {3.95381133514288*^9, 
   3.953811359417729*^9}, {3.953812847824155*^9, 3.953812887951309*^9}, {
   3.954105891117484*^9, 3.954105910289761*^9}, {3.9541072196521606`*^9, 
   3.954107233594841*^9}, {3.954107271158557*^9, 3.95410727274585*^9}, {
   3.9541074043984127`*^9, 3.954107405410844*^9}, {3.954107457481263*^9, 
   3.954107488718667*^9}, {3.954107628872036*^9, 3.954107629774729*^9}, {
   3.954107673945853*^9, 3.9541076751735353`*^9}, {3.954107706161664*^9, 
   3.954107707137967*^9}, {3.954107759858828*^9, 3.954107793114513*^9}, {
   3.954107862170251*^9, 3.954107862605736*^9}, {3.954163835891556*^9, 
   3.954163918916589*^9}, {3.954163959888249*^9, 3.954163965413522*^9}, {
   3.954164106203271*^9, 3.954164282416133*^9}, {3.954164436649363*^9, 
   3.954164553354854*^9}, {3.9541646291961117`*^9, 3.95416465904543*^9}, {
   3.954164690616124*^9, 3.954164691092448*^9}, {3.9541647229652977`*^9, 
   3.9541647243579893`*^9}, {3.9541648026793623`*^9, 3.954164873311146*^9}, {
   3.95416491759573*^9, 3.95416492246097*^9}, {3.9541650058246193`*^9, 
   3.954165006033298*^9}, {3.954165120952338*^9, 3.95416531086403*^9}, 
   3.954165411084741*^9, {3.95416563262613*^9, 3.954165685139414*^9}, {
   3.9541657348684196`*^9, 3.95416595952966*^9}, {3.954165995867111*^9, 
   3.9541660171604033`*^9}, {3.9541660950352583`*^9, 3.954166098905279*^9}, {
   3.954166139529359*^9, 3.9541662006656437`*^9}, {3.954166250512227*^9, 
   3.9541662529231043`*^9}, {3.9541663514878187`*^9, 3.954166429662941*^9}, {
   3.954166492716241*^9, 3.95416660852588*^9}, {3.954166686495265*^9, 
   3.954166732307219*^9}, {3.954166789409828*^9, 3.954166836768796*^9}, {
   3.954166956145462*^9, 3.954166978743422*^9}, {3.954167071821563*^9, 
   3.954167074414653*^9}, {3.9541671055664387`*^9, 3.954167203404813*^9}, {
   3.954167260397629*^9, 3.954167268442148*^9}, {3.954167305167473*^9, 
   3.954167312605775*^9}, {3.954167344037733*^9, 3.954167346257613*^9}, {
   3.954167390230323*^9, 3.954167392523485*^9}, {3.95416749091637*^9, 
   3.9541675165725727`*^9}, {3.954167562925186*^9, 3.95416756389677*^9}, {
   3.954167612027432*^9, 3.954167613384617*^9}, {3.9541676676002502`*^9, 
   3.954167670038355*^9}, {3.954167727364522*^9, 3.95416772930744*^9}, {
   3.954167791267799*^9, 3.9541677987644863`*^9}, {3.954167836342848*^9, 
   3.954167844847267*^9}, {3.9541678760707073`*^9, 3.954167894661744*^9}, {
   3.954167928993951*^9, 3.954167931202574*^9}, {3.954168019594975*^9, 
   3.9541680200502577`*^9}, {3.9541680520717382`*^9, 3.95416805515219*^9}, {
   3.9541680933732033`*^9, 3.9541680951374807`*^9}, {3.954168210896049*^9, 
   3.954168217797778*^9}, {3.954168281169986*^9, 3.954168281947998*^9}, {
   3.954168333000429*^9, 3.954168337725257*^9}, {3.954168437739764*^9, 
   3.954168540652954*^9}, {3.954168627105318*^9, 3.954168627210064*^9}, {
   3.954168682220626*^9, 3.954168685891818*^9}, {3.954168722392322*^9, 
   3.954168855719338*^9}, {3.954168899707891*^9, 3.954168906576539*^9}, {
   3.954168944271119*^9, 3.954168962159608*^9}, {3.954168997566407*^9, 
   3.9541690222435293`*^9}, {3.9541690812453423`*^9, 
   3.9541690924959183`*^9}, {3.954169132229919*^9, 3.9541691408150177`*^9}, 
   3.954169208705476*^9, {3.9541692428430853`*^9, 3.9541692874727*^9}, {
   3.954169336463397*^9, 3.954169448309972*^9}, {3.954169574817325*^9, 
   3.9541695968387547`*^9}, {3.954169678744761*^9, 3.954169696075747*^9}, {
   3.95416978662029*^9, 3.954169813290388*^9}, {3.954169930519487*^9, 
   3.954169941964587*^9}, {3.954170034400527*^9, 3.954170037651689*^9}, {
   3.9541700705027437`*^9, 3.954170073387662*^9}, {3.954170132276342*^9, 
   3.954170175970788*^9}, {3.9541702242911787`*^9, 3.95417027127693*^9}, 
   3.9541703538839827`*^9, {3.954263421778676*^9, 3.954263455306785*^9}, {
   3.954263544132971*^9, 3.954263566904787*^9}, {3.954263604444192*^9, 
   3.9542636348006487`*^9}, {3.954263714766315*^9, 3.9542638723468447`*^9}, {
   3.9542640152271233`*^9, 3.954264019603799*^9}, {3.954264115979011*^9, 
   3.9542641278739862`*^9}, {3.9542642283625307`*^9, 3.954264290508336*^9}, {
   3.954264430550748*^9, 3.954264430726807*^9}, {3.954266215649693*^9, 
   3.9542662231562757`*^9}, {3.954266299313772*^9, 3.954266301625218*^9}, 
   3.954267150152554*^9, {3.954267994537332*^9, 3.954267994712349*^9}, {
   3.9542681397428207`*^9, 3.954268144241683*^9}, {3.9542682220347853`*^9, 
   3.954268240734536*^9}, {3.95426831652308*^9, 3.9542683523646173`*^9}, {
   3.954268512325409*^9, 3.954268519658062*^9}, {3.954268638931696*^9, 
   3.954268639001267*^9}, {3.954268793863655*^9, 3.954268803383669*^9}, {
   3.954269257874892*^9, 3.95426929211106*^9}, 3.954269815485959*^9, {
   3.954269936449998*^9, 3.954269936953341*^9}, {3.9542700291813*^9, 
   3.954270031317697*^9}, {3.954270074398252*^9, 3.954270078631843*^9}, {
   3.954282110107883*^9, 3.954282111988474*^9}, 3.95428218581553*^9, {
   3.954284468793827*^9, 3.954284521194305*^9}, {3.954284592652287*^9, 
   3.954284609967596*^9}, {3.9542846491600924`*^9, 3.9542847066892233`*^9}, {
   3.954284774624577*^9, 3.954284801656589*^9}, {3.954285273135934*^9, 
   3.954285296733758*^9}, {3.9542853411353617`*^9, 3.954285408580018*^9}, {
   3.954285443116262*^9, 3.954285469012586*^9}, {3.954285509504367*^9, 
   3.954285512496724*^9}, {3.954285557249592*^9, 3.954285560390607*^9}, {
   3.954285888778235*^9, 3.954285920319046*^9}, {3.954285994081153*^9, 
   3.954285994194243*^9}, {3.954286421516883*^9, 3.954286474513172*^9}, {
   3.954286874968114*^9, 3.954286917718732*^9}, {3.9542869837284327`*^9, 
   3.954286989778636*^9}, {3.9542870569105797`*^9, 3.954287066273809*^9}, {
   3.954287270664263*^9, 3.954287318817733*^9}, {3.954287722181919*^9, 
   3.954287722226667*^9}, {3.9542878846816053`*^9, 3.954287886855114*^9}, {
   3.954287967731928*^9, 3.954287971153306*^9}, {3.95428808987687*^9, 
   3.954288102757855*^9}, 3.9543609356447*^9, {3.954361129683123*^9, 
   3.954361161246748*^9}, {3.9543617432008*^9, 3.9543617579116793`*^9}, {
   3.954361877845327*^9, 3.954361879818369*^9}, {3.954361917329094*^9, 
   3.954361933644614*^9}, {3.954362152875846*^9, 3.954362159933543*^9}, {
   3.954362204954403*^9, 3.95436221631249*^9}, {3.9543622543098583`*^9, 
   3.9543622845370092`*^9}, {3.954363057411014*^9, 3.954363058210026*^9}, {
   3.954363088244832*^9, 3.954363131813496*^9}, {3.954363201481937*^9, 
   3.954363218049272*^9}, {3.9543633575349817`*^9, 3.954363358539702*^9}, {
   3.954363416282095*^9, 3.954363426574451*^9}, {3.954363532047118*^9, 
   3.954363532094507*^9}, {3.9543635890053797`*^9, 3.954363624057859*^9}, {
   3.954363753899168*^9, 3.9543637562681828`*^9}, 3.9543681658872337`*^9, {
   3.954368317921144*^9, 3.954368359378334*^9}, {3.954368477143304*^9, 
   3.9543684813336763`*^9}, {3.954512656852289*^9, 3.954512741957398*^9}, {
   3.954512811236536*^9, 3.954512812940991*^9}, {3.954512951592369*^9, 
   3.954512964551206*^9}, {3.954513118894232*^9, 3.954513127630007*^9}, {
   3.95451315847336*^9, 3.954513159345458*^9}, {3.9545131996871567`*^9, 
   3.954513292446636*^9}, {3.954513389106822*^9, 3.954513395161384*^9}, {
   3.9545134363177834`*^9, 3.954513445610811*^9}, {3.95451368063762*^9, 
   3.954513680886351*^9}, {3.9545137298937407`*^9, 3.954513730049397*^9}, {
   3.954513885791719*^9, 3.9545138896403847`*^9}, {3.954514277954359*^9, 
   3.9545144013677883`*^9}, {3.954514564966465*^9, 3.954514578249979*^9}, {
   3.954514701255743*^9, 3.954514740984934*^9}, {3.954514780881577*^9, 
   3.9545147841912394`*^9}, 3.954514885089588*^9, {3.954515014867198*^9, 
   3.954515014930691*^9}, {3.954515146643896*^9, 3.954515148178409*^9}, {
   3.954862372174358*^9, 3.9548623722381887`*^9}, {3.954883426193501*^9, 
   3.954883426485364*^9}, {3.955463187920223*^9, 3.9554631881970243`*^9}, {
   3.9554633587574673`*^9, 3.95546343824039*^9}, {3.955465787670021*^9, 
   3.955465788067731*^9}, {3.9554658262152033`*^9, 3.955465829259117*^9}, {
   3.955465874248748*^9, 3.955465888372176*^9}, {3.955465935211783*^9, 
   3.955465936086953*^9}, {3.9554661254178133`*^9, 3.95546612571101*^9}, 
   3.955466231081017*^9, 3.955663482833137*^9, {3.9556636749796333`*^9, 
   3.955663675103278*^9}, {3.955663919185198*^9, 3.9556639204579372`*^9}, 
   3.9556640101893873`*^9, 3.9556650845683937`*^9, {3.9557121324292727`*^9, 
   3.955712191667498*^9}, {3.955712423097426*^9, 3.955712479456259*^9}, {
   3.955712550707869*^9, 3.955712551704151*^9}, {3.9557126033154297`*^9, 
   3.955712606105701*^9}, {3.955712651847266*^9, 3.9557126526144238`*^9}, 
   3.955712692435362*^9, {3.955712965126562*^9, 3.9557129675635767`*^9}, {
   3.955713032714851*^9, 3.955713056616107*^9}, {3.955713110067994*^9, 
   3.9557131310926237`*^9}, {3.955718467868616*^9, 3.955718473141139*^9}, {
   3.9557185306149387`*^9, 3.955718582068124*^9}, {3.955810115792675*^9, 
   3.955810124537738*^9}, 3.955810162126183*^9, 3.955810260441592*^9, 
   3.955810348938428*^9, {3.95581052123778*^9, 3.955810526339746*^9}, {
   3.955810589108436*^9, 3.955810592361526*^9}, {3.95581065733183*^9, 
   3.955810700328597*^9}, {3.9558107452475777`*^9, 3.955810751194097*^9}, {
   3.955810783709159*^9, 3.955810788661717*^9}, 3.955810885587811*^9, {
   3.955810919095271*^9, 3.9558109338840313`*^9}, {3.9558110488652983`*^9, 
   3.95581108384732*^9}, {3.955822323342314*^9, 3.955822328492199*^9}, {
   3.955822471442882*^9, 3.95582247430543*^9}, {3.955880786896141*^9, 
   3.955880796333807*^9}, {3.955906634635602*^9, 3.955906642421452*^9}, {
   3.955907130750716*^9, 3.9559071327398357`*^9}, {3.9559072833833103`*^9, 
   3.955907284950944*^9}, {3.955907386147338*^9, 3.955907392687684*^9}, {
   3.955907446853839*^9, 3.955907452770844*^9}, {3.955907499104254*^9, 
   3.9559075059207907`*^9}, {3.955907590002439*^9, 3.9559075959383*^9}, {
   3.9559076395076723`*^9, 3.9559077405512342`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"d80171dd-62e9-482e-bf57-84241c87d12f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solveBVPsNested", "[", 
    RowBox[{
    "initialAngle_", ",", " ", "initialGuess_", ",", " ", "endTime_", ",", 
     " ", "tmax_", ",", " ", "n_", ",", " ", "m0_", ",", " ", "A_", ",", " ", 
     "fuelpercent_", ",", " ", "isp_", ",", " ", "numPoints_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
       "initialAngle", ",", " ", "\"\< \>\"", ",", "  ", "initialGuess", ",", 
        " ", "\"\< \>\"", ",", " ", "endTime", ",", " ", "\"\< \>\"", ",", 
        " ", "tmax", ",", " ", "\"\< \>\"", ",", " ", "n", ",", 
        " ", "\"\< \>\"", ",", " ", "m0", ",", " ", "\"\< \>\"", ",", " ", 
        "A", ",", " ", "\"\< \>\"", ",", " ", "fuelpercent", ",", 
        " ", "\"\< \>\"", ",", " ", "isp", ",", " ", "\"\< \>\"", ",", " ", 
        "numPoints"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bvpNester", "[", "prevAngleCostatePosition_", "]"}], " ", ":=",
        " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prevAngle", " ", "=", " ", 
           RowBox[{"prevAngleCostatePosition", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"prevCostate", " ", "=", " ", 
           RowBox[{"prevAngleCostatePosition", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"prevPosition", " ", "=", " ", 
           RowBox[{"prevAngleCostatePosition", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"prevMethod", " ", "=", " ", 
           RowBox[{"prevAngleCostatePosition", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"nextAngle", " ", "=", " ", 
           RowBox[{"prevAngle", " ", "+", " ", 
            RowBox[{"2", " ", "*", " ", 
             RowBox[{"Pi", " ", "/", " ", "numPoints"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nextDirection", " ", "=", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "nextAngle", "]"}], ",", " ", 
              RowBox[{"Sin", "[", "nextAngle", "]"}]}], "}"}], " ", "//", " ",
             "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"nextCostate", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"prevCostate", " ", "==", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
             RowBox[{
              RowBox[{"findInitialCostates", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                 "}"}], ",", " ", 
                RowBox[{"getFinalEnergyPos", "[", 
                 RowBox[{
                 "endTime", ",", " ", "tmax", ",", " ", "n", ",", " ", 
                  "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", " ",
                 "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                RowBox[{"tmax", " ", "fuelpercent", " ", 
                 RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "m0", 
                ",", " ", "tmax"}], " ", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
              "]"}], ",", " ", "prevCostate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"nextGuess", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nextCostate", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"nextCostate", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
             RowBox[{"nextCostate", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sres", " ", "=", " ", 
           RowBox[{"MatrixExp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", 
             "endTime"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rootFindingRoutine", "[", 
            RowBox[{"v_", ",", " ", "g_"}], "]"}], " ", ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"rootfindwrapper", "[", 
                RowBox[{"val_", ",", " ", "guess_"}], "]"}], " ", ":=", " ", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"val", "==", "0"}], ",", 
                 RowBox[{"rootfindym", "[", 
                  RowBox[{"guess", ",", "  ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                   "isp", ",", " ", "endTime", ",", " ", "tmax", ",", " ", 
                   "sres"}], "]"}], ",", " ", 
                 RowBox[{"val", " ", "==", "1"}], ",", 
                 RowBox[{"rootfindxm", "[", 
                  RowBox[{"guess", ",", "  ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                   "isp", ",", " ", "endTime", ",", " ", "tmax", ",", " ", 
                   "sres"}], "]"}], ",", " ", 
                 RowBox[{"val", " ", "==", "2"}], ",", 
                 RowBox[{"rootfindnomass", "[", 
                  RowBox[{"guess", ",", "  ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "nextDirection", ",", " ", "A", ",", " ", "m0", ",", " ", 
                   "isp", ",", " ", "endTime", ",", " ", "tmax", ",", " ", 
                   "sres"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"next", "[", "val_", "]"}], ":=", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"val", " ", "==", "0"}], ",", " ", "1", ",", " ", 
                 RowBox[{"val", "==", "1"}], ",", " ", "2", ",", " ", 
                 RowBox[{"val", " ", "==", "2"}], ",", " ", "0"}], "]"}]}], ";",
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "*", "trying", " ", "with", " ", "previous", " ", "method"}], 
               "**)"}], "\[IndentingNewLine]", 
              RowBox[{"lxm2", " ", "=", 
               RowBox[{"rootfindwrapper", "[", 
                RowBox[{"v", ",", " ", "g"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"out", "=", " ", 
               RowBox[{"propStateCostatev2", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                   RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                   "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                 "tmax", ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"curSatisfaction", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Abs", " ", "/@", " ", 
                  RowBox[{"cons", "[", 
                   RowBox[{"nextDirection", ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                    "endTime", ",", " ", "tmax", ",", " ", "isp", ",", " ", 
                    "m0"}], "]"}]}], ")"}], " ", "//", " ", "Total"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"curSatisfaction", " ", "<=", "1*^-4"}], ",", " ", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", 
                  RowBox[{
                  "lxm2", ",", " ", "v", ",", " ", "curSatisfaction"}], "}"}],
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              
              RowBox[{"\"\<one switch attempted\>\"", " ", "//", " ", 
               "Print"}], ";", "\[IndentingNewLine]", 
              RowBox[{"lxm3", " ", "=", " ", 
               RowBox[{"rootfindwrapper", "[", 
                RowBox[{
                 RowBox[{"v", " ", "//", " ", "next"}], ",", " ", "g"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"out", "=", " ", 
               RowBox[{"propStateCostatev2", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                   RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                   "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                 "tmax", ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"nextSatisfaction", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Abs", " ", "/@", " ", 
                  RowBox[{"cons", "[", 
                   RowBox[{"nextDirection", ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                    "endTime", ",", " ", "tmax", ",", " ", "isp", ",", " ", 
                    "m0"}], "]"}]}], ")"}], " ", "//", " ", "Total"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nextSatisfaction", " ", "<=", "1*^-4"}], ",", " ", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", 
                  RowBox[{"lxm3", ",", " ", 
                   RowBox[{"next", "[", "v", "]"}], ",", " ", 
                   "nextSatisfaction"}], "}"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              
              RowBox[{"\"\<two switches attempted\>\"", " ", "//", " ", 
               "Print"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"*", " ", "next", " ", "switch", " ", "attempted"}], 
               " ", "**)"}], "\[IndentingNewLine]", 
              RowBox[{"lxm4", " ", "=", " ", 
               RowBox[{"rootfindwrapper", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"v", " ", "//", " ", "next"}], " ", "//", " ", 
                  "next"}], ",", " ", "g"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"out", "=", " ", 
               RowBox[{"propStateCostatev2", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
                     "m0"}], "}"}], ",", "   ", 
                   RowBox[{"Join", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"lxm4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"lxm4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                     " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"lxm4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"lxm4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"lxm4", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                   "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", 
                 "tmax", ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"nextnextSatisfaction", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Abs", " ", "/@", " ", 
                  RowBox[{"cons", "[", 
                   RowBox[{"nextDirection", ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ";;", "14"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"out", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "7"}], "]"}], "]"}], " ", ",", 
                    RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                    "endTime", ",", " ", "tmax", ",", " ", "isp", ",", " ", 
                    "m0"}], "]"}]}], ")"}], " ", "//", " ", "Total"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"idx", " ", "=", " ", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "curSatisfaction", ",", " ", "nextSatisfaction", ",", " ", 
                    "nextnextSatisfaction"}], "}"}], ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "curSatisfaction", ",", " ", "nextSatisfaction", ",", " ",
                     "nextnextSatisfaction"}], "}"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nextnextSatisfaction", " ", "<=", "1*^-4"}], ",", 
                " ", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", 
                  RowBox[{"lxm2", ",", " ", 
                   RowBox[{
                    RowBox[{"v", " ", "//", " ", "next"}], " ", "//", " ", 
                    "next"}], ",", " ", "nextnextSatisfaction"}], "}"}], 
                 "]"}], ",", " ", 
                RowBox[{"Return", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lxm2", ",", " ", "lxm3", ",", " ", "lxm4"}], 
                    "}"}], "[", 
                    RowBox[{"[", "idx", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v", ",", " ", 
                    RowBox[{"v", "//", "next"}], ",", " ", 
                    RowBox[{
                    RowBox[{"v", "//", "next"}], "//", "next"}]}], "}"}], "[", 
                    RowBox[{"[", "idx", "]"}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "curSatisfaction", ",", " ", "nextSatisfaction", ",", " ",
                     "nextnextSatisfaction"}], "}"}], "[", 
                    RowBox[{"[", "idx", "]"}], "]"}]}], "}"}], "]"}]}], "]"}],
               ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"res", ",", " ", "methodUsed", ",", " ", "satisfaction"}],
             "}"}], " ", "=", " ", 
           RowBox[{"rootFindingRoutine", "[", 
            RowBox[{"prevMethod", ",", " ", "nextGuess"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "costateReturn", ",", " ", "methodUsed", ",", " ", 
             "satisfaction"}], "}"}], " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"satisfaction", " ", "<=", " ", "30"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"res", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", ",", " ", 
                 RowBox[{"res", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", ",", " ", 
                 RowBox[{"res", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
               "methodUsed", ",", " ", "satisfaction"}], "}"}], ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ecs", " ", "=", " ", 
                RowBox[{
                 RowBox[{"findInitialCostates", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                    "}"}], ",", " ", 
                   RowBox[{"getFinalEnergyPos", "[", 
                    RowBox[{
                    "endTime", ",", " ", "tmax", " ", ",", " ", "n", ",", " ",
                     "nextDirection", ",", " ", "fuelpercent"}], "]"}], ",", 
                   " ", "n", ",", " ", "A", ",", " ", "endTime", ",", " ", 
                   RowBox[{"tmax", " ", "fuelpercent", " ", 
                    RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", 
                   "m0", ",", " ", "tmax"}], " ", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
               "Print", 
                "[", "\"\<retrying with energy optimal initial guess\>\"", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}], "=", 
                RowBox[{"rootFindingRoutine", "[", 
                 RowBox[{"prevMethod", ",", " ", "ecs"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"x3", " ", "//", " ", "Print"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"x1", ",", " ", "x2", ",", "x3"}], "}"}]}], 
              "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"out2", " ", "=", " ", 
           RowBox[{"propStateCostatev2", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                 "m0"}], "}"}], ",", "   ", 
               RowBox[{"Join", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"costateReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"costateReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                   " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                    "subs"}], " ", ")"}], " ", "/.", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "->", 
                    RowBox[{"costateReturn", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                    RowBox[{"v2", " ", "->", 
                    RowBox[{"costateReturn", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", 
                    RowBox[{"costateReturn", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
               "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "tmax", 
             ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"nextAngle", ",", 
               RowBox[{"Pi", "/", "100"}]}], "]"}], "<", "0.005"}], ",", " ", 
            
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"prevAngle", ",", " ", "Pi"}], "]"}], " ", "//", " ",
                 "N"}], "]"}], ";", " ", 
              RowBox[{"Print", "[", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"ArcTan", "[", 
                  RowBox[{
                   RowBox[{"prevPosition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                   RowBox[{"prevPosition", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", " ", "Pi"}],
                 "]"}], "]"}], ";", " ", 
              RowBox[{"Print", "[", "satisfaction", "]"}], ";", " ", 
              RowBox[{"Print", "[", "methodUsed", "]"}]}], ")"}], ",", " ", 
            RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nextAngle", ",", " ", "costateReturn", ",", " ", 
            RowBox[{"out2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", " ", 
            RowBox[{"out2", "[", 
             RowBox[{"[", "7", "]"}], "]"}], ",", " ", "methodUsed"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NestList", "[", 
       RowBox[{"bvpNester", ",", " ", 
        RowBox[{"{", 
         RowBox[{"initialAngle", ",", " ", "initialGuess", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
           "}"}], ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
        "numPoints"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotthrustfuel", "[", 
     RowBox[{
     "thrustmax_", ",", " ", "n_", ",", " ", "endTime_", ",", " ", "m0_", ",",
       " ", "fuelpercent_", ",", " ", "isp_", ",", " ", "num_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"testbounds", ",", " ", "teststats"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{"Pi", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "fuelpercent", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"testbounds2", " ", "=", " ", 
        RowBox[{
         RowBox[{"solveBVPsNested", "[", 
          RowBox[{"Pi", ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", "endTime", ",",
            " ", "thrustmax", ",", " ", "n", ",", " ", "m0", ",", " ", "A", ",",
            " ", "0.99", ",", " ", "isp", ",", " ", "num"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testmasses", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testmasses2", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"testxfs2", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Max", "[", 
         RowBox[{"Norm", " ", "/@", " ", 
          RowBox[{"testxfs", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", " ", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idxmaxfull", " ", "=", " ", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{
           RowBox[{"Norm", " ", "/@", " ", 
            RowBox[{"testxfs", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxdirfull", " ", "=", " ", 
        RowBox[{"testxfs", "[", 
         RowBox[{"[", 
          RowBox[{"idxmaxfull", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"idxmaxfull2", " ", "=", " ", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{
           RowBox[{"Norm", " ", "/@", " ", 
            RowBox[{"testxfs2", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxdirfull2", " ", "=", " ", 
        RowBox[{"testxfs2", "[", 
         RowBox[{"[", 
          RowBox[{"idxmaxfull2", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"maxdirfull2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"maxdirfull2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", " ", "Print"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"directions", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"directionsfullthrust", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costates", " ", "=", " ", 
        RowBox[{"testbounds", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costatesfullthrust", " ", "=", " ", 
        RowBox[{"testbounds2", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"costates", ",", " ", "directions"}], "}"}], " ", ">>", " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<costatefuellim``file\>\"", ",", " ", "endTime"}], 
           "]"}], " ", "//", " ", "ToString"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"costatesfullthrust", ",", " ", "directionsfullthrust"}], 
         "}"}], " ", ">>", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<costatefullthrust``file\>\"", ",", " ", "endTime"}], 
           "]"}], " ", "//", " ", "ToString"}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costatedirections", " ", "=", " ", 
        RowBox[{"costates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costatemasses", " ", "=", " ", 
        RowBox[{"costates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costateratios", " ", "=", " ", 
        RowBox[{"costatemasses", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"Norm", " ", "/@", " ", "costatedirections"}], ")"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"costateangles", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
         "costatedirections"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "directions"}], " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ArcTan", " ", "@@", " ", "#"}], " ", "&"}], " ", "/@", 
           " ", "directions"}]}], ";"}], "**)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"directions", " ", ",", " ", 
             RowBox[{"Mod", "[", 
              RowBox[{"costateangles", ",", " ", 
               RowBox[{"2", " ", "Pi"}]}], "]"}]}], "}"}], " ", "//", " ", 
           "Transpose"}], ",", " ", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            
            RowBox[{"\"\<Target Angle (rads)\>\"", 
             ",", "\"\<Initial Angle (rads) \>\""}], "}"}]}]}], " ", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           
           RowBox[{"\"\<costatedirectiongraph``.png\>\"", ",", " ", 
            "endTime"}], "]"}], " ", "//", " ", "ToString"}], ",", "  ", 
         "l1"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"directions", ",", " ", "costateratios"}], "}"}], " ", "//",
           " ", "Transpose"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<costateratiograph``.png\>\"", ",", " ", "endTime"}], 
           "]"}], " ", "//", " ", "ToString"}], ",", " ", "l2"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"l3", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", "directions", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<directions``.png\>\"", ",", " ", "endTime"}], "]"}], 
          " ", "//", " ", "ToString"}], ",", " ", "l3"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "maxratio", ",", " ", "minratio", ",", " ", "maxpos", ",", " ", 
          "minpos"}], "}"}], " ", "=", " ", 
        RowBox[{"thrustfuelstats", "[", 
         RowBox[{"testxfs", ",", " ", "testxfs2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "maxratio", ",", " ", "\"\< \>\"", ",", " ", "minratio", ",", 
         " ", "\"\< \>\"", ",", " ", 
         RowBox[{"maxpos", " ", "//", " ", "Normalize"}], ",", " ", 
         RowBox[{"minpos", " ", "//", " ", "Normalize"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"testbounds", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"testxfs", ",", " ", "testxfs2"}], "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"Point", "[", 
                RowBox[{"testbounds", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", " ", 
                   RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}], "]"}], 
               ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.1", " ", "0.001", "maxdirfull2"}]}], "}"}], " ", 
                "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], " ", "0.001", "maxdirfull2"}]}], 
                 "}"}], " ", "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                  "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
             "]"}], ",", " ", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                 " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                  "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
             "]"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red", ",", " ", "Green"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\"", 
                ",", " ", "\"\<Maximum Direction\>\""}], "}"}]}], "]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<RRStttb``.png\>\"", ",", " ", "endTime"}], "]"}], " ",
           "//", " ", "ToString"}], ",", " ", "plot"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "directions", ",", " ", "directionsfullthrust", ",", " ", "costates", 
         ",", " ", "costatesfullthrust"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.9522861895468063`*^9, 3.9522861898199377`*^9}, {
   3.952286798273657*^9, 3.952286805975416*^9}, {3.952286921223054*^9, 
   3.952286942661222*^9}, {3.9522871876648893`*^9, 3.9522872082522383`*^9}, 
   3.952287501825296*^9, {3.952290472087657*^9, 3.9522904742648993`*^9}, {
   3.952293106009499*^9, 3.95229312708536*^9}, 3.9522931914741488`*^9, {
   3.9522932230855503`*^9, 3.952293279043066*^9}, {3.952293337820467*^9, 
   3.952293437471656*^9}, {3.9522935394640617`*^9, 3.952293569761074*^9}, {
   3.952293761093302*^9, 3.952293761321594*^9}, {3.952297554298175*^9, 
   3.9522976029996243`*^9}, {3.952342743207121*^9, 3.952342746333531*^9}, {
   3.952342785153657*^9, 3.9523427899516287`*^9}, {3.9523432507805977`*^9, 
   3.9523432698635807`*^9}, {3.952343314283102*^9, 3.9523433249908457`*^9}, {
   3.952343406507234*^9, 3.9523434215335283`*^9}, {3.952345615189752*^9, 
   3.952345631747403*^9}, {3.9523457448751907`*^9, 3.952345768122336*^9}, {
   3.952345808276223*^9, 3.952345838706813*^9}, {3.952346110208201*^9, 
   3.952346111204088*^9}, {3.9523660244985943`*^9, 3.952366200204225*^9}, {
   3.952368366840674*^9, 3.952368440432873*^9}, {3.9523691088083553`*^9, 
   3.952369131110515*^9}, {3.9523692756190166`*^9, 3.952369286930372*^9}, {
   3.952369330354649*^9, 3.952369337097043*^9}, 3.952370958397942*^9, {
   3.952454966562893*^9, 3.952455008201264*^9}, {3.952899822202219*^9, 
   3.952899838090053*^9}, {3.9528999598818913`*^9, 3.9528999897451963`*^9}, 
   3.952900044475627*^9, {3.9529000940072613`*^9, 3.952900262382045*^9}, {
   3.9529003059444857`*^9, 3.95290031180359*^9}, {3.952900404539404*^9, 
   3.952900528063849*^9}, {3.952901090199501*^9, 3.952901098516623*^9}, {
   3.952901150897871*^9, 3.9529011716809893`*^9}, {3.952901212074098*^9, 
   3.9529012930671377`*^9}, {3.9529020203964777`*^9, 3.952902035836121*^9}, {
   3.9530723353608522`*^9, 3.9530723643505383`*^9}, {3.95307256928831*^9, 
   3.953072569663443*^9}, {3.953073154759439*^9, 3.953073156018839*^9}, 
   3.953073469339456*^9, {3.953238845049008*^9, 3.953238849801834*^9}, {
   3.953238897015877*^9, 3.953238899284683*^9}, {3.953240945754616*^9, 
   3.953241036937277*^9}, {3.953241100467914*^9, 3.953241100542523*^9}, {
   3.953241131843143*^9, 3.953241136461337*^9}, {3.953241174439218*^9, 
   3.953241182068922*^9}, {3.953241228956056*^9, 3.9532412307691183`*^9}, {
   3.953241263602892*^9, 3.953241276539073*^9}, {3.9532413589515457`*^9, 
   3.953241360441743*^9}, {3.9532413906228113`*^9, 3.953241391023758*^9}, {
   3.953241526890616*^9, 3.953241530613055*^9}, {3.953241716187561*^9, 
   3.953241718185549*^9}, {3.95324186162784*^9, 3.953241874789899*^9}, {
   3.9532419239574633`*^9, 3.953242018775745*^9}, {3.953242062261344*^9, 
   3.9532420645139093`*^9}, {3.9532428918547907`*^9, 
   3.9532429008134193`*^9}, {3.9532460917066107`*^9, 3.953246106153384*^9}, {
   3.953247673141028*^9, 3.953247698274508*^9}, {3.953247812324787*^9, 
   3.95324787644486*^9}, {3.953248208390069*^9, 3.9532482121485767`*^9}, {
   3.953249396530427*^9, 3.95324939793887*^9}, {3.953420206769869*^9, 
   3.953420221194186*^9}, {3.9534202953461123`*^9, 3.9534202965915813`*^9}, {
   3.95342034346915*^9, 3.953420353009055*^9}, {3.953420388857719*^9, 
   3.953420428109112*^9}, {3.953420505816608*^9, 3.953420508315679*^9}, {
   3.9534207364984426`*^9, 3.953420751809957*^9}, {3.953420930541477*^9, 
   3.953420931824958*^9}, {3.953420964674275*^9, 3.9534209822637177`*^9}, {
   3.953557272389435*^9, 3.9535572799725847`*^9}, {3.953755314074774*^9, 
   3.953755319544126*^9}, {3.9537558357202272`*^9, 3.953755954124145*^9}, {
   3.953756238491393*^9, 3.953756241404359*^9}, {3.953756335794127*^9, 
   3.953756338411992*^9}, {3.9537565485689*^9, 3.953756548739768*^9}, {
   3.9537566997315187`*^9, 3.953756713487565*^9}, 3.9537567938843937`*^9, {
   3.9537568676771803`*^9, 3.953756870626419*^9}, {3.953756919550783*^9, 
   3.953757048425983*^9}, {3.953758611869567*^9, 3.953758614571252*^9}, {
   3.9537659073507433`*^9, 3.953765911035673*^9}, {3.9537661041206408`*^9, 
   3.953766107909835*^9}, {3.953766163445509*^9, 3.953766200508175*^9}, {
   3.953766370613573*^9, 3.953766392184218*^9}, {3.953810739476536*^9, 
   3.953810741325593*^9}, {3.953810876736455*^9, 3.953810886373407*^9}, {
   3.9538112987331753`*^9, 3.953811302910439*^9}, {3.95381133514288*^9, 
   3.953811359417729*^9}, {3.953812847824155*^9, 3.953812887951309*^9}, {
   3.954105891117484*^9, 3.954105910289761*^9}, {3.9541072196521606`*^9, 
   3.954107233594841*^9}, {3.954107271158557*^9, 3.95410727274585*^9}, {
   3.9541074043984127`*^9, 3.954107405410844*^9}, {3.954107457481263*^9, 
   3.954107488718667*^9}, {3.954107628872036*^9, 3.954107629774729*^9}, {
   3.954107673945853*^9, 3.9541076751735353`*^9}, {3.954107706161664*^9, 
   3.954107707137967*^9}, {3.954107759858828*^9, 3.954107793114513*^9}, {
   3.954107862170251*^9, 3.954107862605736*^9}, {3.954163835891556*^9, 
   3.954163918916589*^9}, {3.954163959888249*^9, 3.954163965413522*^9}, {
   3.954164106203271*^9, 3.954164282416133*^9}, {3.954164436649363*^9, 
   3.954164553354854*^9}, {3.9541646291961117`*^9, 3.95416465904543*^9}, {
   3.954164690616124*^9, 3.954164691092448*^9}, {3.9541647229652977`*^9, 
   3.9541647243579893`*^9}, {3.9541648026793623`*^9, 3.954164873311146*^9}, {
   3.95416491759573*^9, 3.95416492246097*^9}, {3.9541650058246193`*^9, 
   3.954165006033298*^9}, {3.954165120952338*^9, 3.95416531086403*^9}, 
   3.954165411084741*^9, {3.95416563262613*^9, 3.954165685139414*^9}, {
   3.9541657348684196`*^9, 3.95416595952966*^9}, {3.954165995867111*^9, 
   3.9541660171604033`*^9}, {3.9541660950352583`*^9, 3.954166098905279*^9}, {
   3.954166139529359*^9, 3.9541662006656437`*^9}, {3.954166250512227*^9, 
   3.9541662529231043`*^9}, {3.9541663514878187`*^9, 3.954166429662941*^9}, {
   3.954166492716241*^9, 3.95416660852588*^9}, {3.954166686495265*^9, 
   3.954166732307219*^9}, {3.954166789409828*^9, 3.954166836768796*^9}, {
   3.954166956145462*^9, 3.954166978743422*^9}, {3.954167071821563*^9, 
   3.954167074414653*^9}, {3.9541671055664387`*^9, 3.954167203404813*^9}, {
   3.954167260397629*^9, 3.954167268442148*^9}, {3.954167305167473*^9, 
   3.954167312605775*^9}, {3.954167344037733*^9, 3.954167346257613*^9}, {
   3.954167390230323*^9, 3.954167392523485*^9}, {3.95416749091637*^9, 
   3.9541675165725727`*^9}, {3.954167562925186*^9, 3.95416756389677*^9}, {
   3.954167612027432*^9, 3.954167613384617*^9}, {3.9541676676002502`*^9, 
   3.954167670038355*^9}, {3.954167727364522*^9, 3.95416772930744*^9}, {
   3.954167791267799*^9, 3.9541677987644863`*^9}, {3.954167836342848*^9, 
   3.954167844847267*^9}, {3.9541678760707073`*^9, 3.954167894661744*^9}, {
   3.954167928993951*^9, 3.954167931202574*^9}, {3.954168019594975*^9, 
   3.9541680200502577`*^9}, {3.9541680520717382`*^9, 3.95416805515219*^9}, {
   3.9541680933732033`*^9, 3.9541680951374807`*^9}, {3.954168210896049*^9, 
   3.954168217797778*^9}, {3.954168281169986*^9, 3.954168281947998*^9}, {
   3.954168333000429*^9, 3.954168337725257*^9}, {3.954168437739764*^9, 
   3.954168540652954*^9}, {3.954168627105318*^9, 3.954168627210064*^9}, {
   3.954168682220626*^9, 3.954168685891818*^9}, {3.954168722392322*^9, 
   3.954168855719338*^9}, {3.954168899707891*^9, 3.954168906576539*^9}, {
   3.954168944271119*^9, 3.954168962159608*^9}, {3.954168997566407*^9, 
   3.9541690222435293`*^9}, {3.9541690812453423`*^9, 
   3.9541690924959183`*^9}, {3.954169132229919*^9, 3.9541691408150177`*^9}, 
   3.954169208705476*^9, {3.9541692428430853`*^9, 3.9541692874727*^9}, {
   3.954169336463397*^9, 3.954169448309972*^9}, {3.954169574817325*^9, 
   3.9541695968387547`*^9}, {3.954169678744761*^9, 3.954169696075747*^9}, {
   3.95416978662029*^9, 3.954169813290388*^9}, {3.954169930519487*^9, 
   3.954169941964587*^9}, {3.954170034400527*^9, 3.954170037651689*^9}, {
   3.9541700705027437`*^9, 3.954170073387662*^9}, {3.954170132276342*^9, 
   3.954170175970788*^9}, {3.9541702242911787`*^9, 3.95417027127693*^9}, 
   3.9541703538839827`*^9, {3.954263421778676*^9, 3.954263455306785*^9}, {
   3.954263544132971*^9, 3.954263566904787*^9}, {3.954263604444192*^9, 
   3.9542636348006487`*^9}, {3.954263714766315*^9, 3.9542638723468447`*^9}, {
   3.9542640152271233`*^9, 3.954264019603799*^9}, {3.954264115979011*^9, 
   3.9542641278739862`*^9}, {3.9542642283625307`*^9, 3.954264290508336*^9}, {
   3.954264430550748*^9, 3.954264430726807*^9}, {3.954266215649693*^9, 
   3.9542662231562757`*^9}, {3.954266299313772*^9, 3.954266301625218*^9}, 
   3.954267150152554*^9, {3.954267994537332*^9, 3.954267994712349*^9}, {
   3.9542681397428207`*^9, 3.954268144241683*^9}, {3.9542682220347853`*^9, 
   3.954268240734536*^9}, {3.95426831652308*^9, 3.9542683523646173`*^9}, {
   3.954268512325409*^9, 3.954268519658062*^9}, {3.954268638931696*^9, 
   3.954268639001267*^9}, {3.954268793863655*^9, 3.954268803383669*^9}, {
   3.954269257874892*^9, 3.95426929211106*^9}, 3.954269815485959*^9, {
   3.954269936449998*^9, 3.954269936953341*^9}, {3.9542700291813*^9, 
   3.954270031317697*^9}, {3.954270074398252*^9, 3.954270078631843*^9}, {
   3.954282110107883*^9, 3.954282111988474*^9}, 3.95428218581553*^9, {
   3.954284468793827*^9, 3.954284521194305*^9}, {3.954284592652287*^9, 
   3.954284609967596*^9}, {3.9542846491600924`*^9, 3.9542847066892233`*^9}, {
   3.954284774624577*^9, 3.954284801656589*^9}, {3.954285273135934*^9, 
   3.954285296733758*^9}, {3.9542853411353617`*^9, 3.954285408580018*^9}, {
   3.954285443116262*^9, 3.954285469012586*^9}, {3.954285509504367*^9, 
   3.954285512496724*^9}, {3.954285557249592*^9, 3.954285560390607*^9}, {
   3.954285888778235*^9, 3.954285920319046*^9}, {3.954285994081153*^9, 
   3.954285994194243*^9}, {3.954286421516883*^9, 3.954286474513172*^9}, {
   3.954286874968114*^9, 3.954286917718732*^9}, {3.9542869837284327`*^9, 
   3.954286989778636*^9}, {3.9542870569105797`*^9, 3.954287066273809*^9}, {
   3.954287270664263*^9, 3.954287318817733*^9}, {3.954287722181919*^9, 
   3.954287722226667*^9}, {3.9542878846816053`*^9, 3.954287886855114*^9}, {
   3.954287967731928*^9, 3.954287971153306*^9}, {3.95428808987687*^9, 
   3.954288102757855*^9}, 3.9543609356447*^9, {3.954361129683123*^9, 
   3.954361161246748*^9}, {3.9543617432008*^9, 3.9543617579116793`*^9}, {
   3.954361877845327*^9, 3.954361879818369*^9}, {3.954361917329094*^9, 
   3.954361933644614*^9}, {3.954362152875846*^9, 3.954362159933543*^9}, {
   3.954362204954403*^9, 3.95436221631249*^9}, {3.9543622543098583`*^9, 
   3.9543622845370092`*^9}, {3.954363057411014*^9, 3.954363058210026*^9}, {
   3.954363088244832*^9, 3.954363131813496*^9}, {3.954363201481937*^9, 
   3.954363218049272*^9}, {3.9543633575349817`*^9, 3.954363358539702*^9}, {
   3.954363416282095*^9, 3.954363426574451*^9}, {3.954363532047118*^9, 
   3.954363532094507*^9}, {3.9543635890053797`*^9, 3.954363624057859*^9}, {
   3.954363753899168*^9, 3.9543637562681828`*^9}, 3.9543681658872337`*^9, {
   3.954368317921144*^9, 3.954368359378334*^9}, {3.954368477143304*^9, 
   3.9543684813336763`*^9}, {3.954512656852289*^9, 3.954512741957398*^9}, {
   3.954512811236536*^9, 3.954512812940991*^9}, {3.954512951592369*^9, 
   3.954512964551206*^9}, {3.954513118894232*^9, 3.954513127630007*^9}, {
   3.95451315847336*^9, 3.954513159345458*^9}, {3.9545131996871567`*^9, 
   3.954513292446636*^9}, {3.954513389106822*^9, 3.954513395161384*^9}, {
   3.954857356934939*^9, 3.954857421636758*^9}, {3.954857555204797*^9, 
   3.954857561376718*^9}, {3.95485810926937*^9, 3.9548581400739803`*^9}, {
   3.954858412930109*^9, 3.954858493071331*^9}, {3.954858523375064*^9, 
   3.954858523978466*^9}, {3.954860372582569*^9, 3.9548603740725307`*^9}, {
   3.954860546946431*^9, 3.954860582619183*^9}, {3.954860908674766*^9, 
   3.954860913332704*^9}, {3.954861319757197*^9, 3.954861319947267*^9}, {
   3.954883399371975*^9, 3.954883400028668*^9}, {3.9548852399019117`*^9, 
   3.954885285632373*^9}, {3.954886627563491*^9, 3.954886628243444*^9}, {
   3.9548867369601707`*^9, 3.95488683505241*^9}, {3.954886887087062*^9, 
   3.954886915673122*^9}, {3.954886962086566*^9, 3.954886968112585*^9}, {
   3.954887010353766*^9, 3.95488701934788*^9}, {3.954887184012093*^9, 
   3.954887188555148*^9}, {3.9549690530736237`*^9, 3.954969105599469*^9}, {
   3.9549691374844646`*^9, 3.954969138708539*^9}, {3.954969216884848*^9, 
   3.9549692325086317`*^9}, {3.954969394847714*^9, 3.954969420383854*^9}, {
   3.9549694683090363`*^9, 3.954969523091275*^9}, {3.954969701930451*^9, 
   3.9549698016650753`*^9}, {3.954969855148443*^9, 3.954969867220677*^9}, {
   3.954970316892345*^9, 3.954970398675674*^9}, {3.954970481777423*^9, 
   3.954970526043315*^9}, {3.954970562835744*^9, 3.954970606638835*^9}, {
   3.954970637017111*^9, 3.95497067522184*^9}, {3.954970739636883*^9, 
   3.954970842918301*^9}, {3.954971481779147*^9, 3.954971484600912*^9}, {
   3.954971523079111*^9, 3.9549717102729387`*^9}, {3.954971761171832*^9, 
   3.954971764750646*^9}, {3.954971989934864*^9, 3.954972008793326*^9}, {
   3.954972175495632*^9, 3.954972187806291*^9}, {3.954972403225762*^9, 
   3.9549724277893476`*^9}, {3.9549724925733013`*^9, 
   3.9549725131136417`*^9}, {3.954972853217411*^9, 3.954973241391213*^9}, {
   3.954973278160118*^9, 3.9549732811278143`*^9}, {3.9549733182370996`*^9, 
   3.9549733671006107`*^9}, {3.954973435558012*^9, 3.9549734374000998`*^9}, {
   3.95497347778279*^9, 3.954973500480447*^9}, {3.954973641586976*^9, 
   3.954973682546968*^9}, {3.9549737241466303`*^9, 3.954973729285968*^9}, {
   3.9549737697450657`*^9, 3.954973787520241*^9}, {3.9549738203320932`*^9, 
   3.954973879916398*^9}, {3.954973917789494*^9, 3.954973946602462*^9}, {
   3.954974003946295*^9, 3.9549740040102053`*^9}, {3.954974074124372*^9, 
   3.954974096654146*^9}, {3.954974156331066*^9, 3.954974158984434*^9}, {
   3.954974265277878*^9, 3.954974300045497*^9}, {3.954974366005155*^9, 
   3.95497436833928*^9}, {3.954974440196645*^9, 3.9549744427488194`*^9}, {
   3.954974506720319*^9, 3.954974506787945*^9}, {3.9549745847931623`*^9, 
   3.9549746027805347`*^9}, {3.954974716799629*^9, 3.9549747334340773`*^9}, {
   3.954974875329459*^9, 3.954974878424623*^9}, {3.954975023882635*^9, 
   3.95497503251693*^9}, 3.9549751077746363`*^9, {3.954975161461772*^9, 
   3.9549751745031557`*^9}, {3.9549752623884487`*^9, 3.954975265390291*^9}, {
   3.954975372600444*^9, 3.9549753796120777`*^9}, {3.9549754148316603`*^9, 
   3.954975415017399*^9}, {3.954975457621976*^9, 3.9549754668270206`*^9}, 
   3.954975506464479*^9, 3.9550105808947697`*^9, {3.955010712203638*^9, 
   3.955010745019587*^9}, {3.955011679343618*^9, 3.9550116965787077`*^9}, {
   3.9550120768608847`*^9, 3.955012088257917*^9}, {3.955012909063485*^9, 
   3.9550129627534513`*^9}, {3.955013115373522*^9, 3.955013124641436*^9}, 
   3.9550132705219088`*^9, {3.955013801358569*^9, 3.955013819039826*^9}, {
   3.9550138538746643`*^9, 3.955013881428143*^9}, {3.95501409570737*^9, 
   3.955014099620058*^9}, {3.9550141934277363`*^9, 3.955014233081196*^9}, {
   3.9550148619309483`*^9, 3.955014884867894*^9}, {3.9550150026118717`*^9, 
   3.9550150083515377`*^9}, {3.955015371851953*^9, 3.955015484147493*^9}, {
   3.955015880226179*^9, 3.955015880418952*^9}, {3.955015924320216*^9, 
   3.955015932977251*^9}, {3.955021837315387*^9, 3.955021842231701*^9}, {
   3.955021885858623*^9, 3.955021889663468*^9}, {3.955022189063878*^9, 
   3.955022204324512*^9}, {3.955022373254418*^9, 3.955022373476269*^9}, {
   3.9550224042826567`*^9, 3.955022416404248*^9}, 3.955022522942315*^9, {
   3.955022704827938*^9, 3.955022719024995*^9}, {3.955023229478426*^9, 
   3.955023278745865*^9}, {3.955023456465361*^9, 3.955023456651496*^9}, {
   3.955023564352066*^9, 3.955023616971159*^9}, {3.9550297334274693`*^9, 
   3.9550297414380703`*^9}, 3.955029833615707*^9, {3.9550299290443497`*^9, 
   3.955030010930717*^9}, {3.9550303381390953`*^9, 3.955030355794339*^9}, {
   3.955030534752516*^9, 3.955030538393299*^9}, {3.955031479042563*^9, 
   3.955031513701993*^9}, {3.955031856333843*^9, 3.955031883806436*^9}, {
   3.9550319184221907`*^9, 3.955031923372531*^9}, {3.955031987265115*^9, 
   3.955032040256433*^9}, {3.955032113798771*^9, 3.955032120477805*^9}, {
   3.955032405641515*^9, 3.955032408605735*^9}, {3.95503253209604*^9, 
   3.95503253299944*^9}, {3.9550334330650587`*^9, 3.955033433746831*^9}, {
   3.955050963324456*^9, 3.955050997809409*^9}, {3.955053445565625*^9, 
   3.9550534566854143`*^9}, {3.955057791463006*^9, 3.95505779269062*^9}, {
   3.955059696963985*^9, 3.955059697047242*^9}, 3.955059756676374*^9, {
   3.955061971182618*^9, 3.9550619746589746`*^9}, {3.9550623756017017`*^9, 
   3.955062376869569*^9}, {3.955064990334643*^9, 3.955064990391271*^9}, {
   3.9551060836940193`*^9, 3.955106083760819*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"2dfd0ff6-9fae-412c-9bf8-d3ccb98da28e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu1", " ", "=", " ", 
   RowBox[{"3.986", " ", 
    RowBox[{"10", "^", "14"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"endTime", " ", "=", " ", "360"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alpha", " ", "=", " ", "7780000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"mu1", " ", "/", " ", 
      RowBox[{"alpha", "^", "3"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isp", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmaxval", " ", "=", " ", "0.002"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fuelpercent", " ", "=", "0.675"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", 
       " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", 
       "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0", ",", " ", 
       RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9541675534926453`*^9, 3.954167553613661*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"adc51be3-de05-47e4-b9a4-a50f94ddf43f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"directioncostatemap", " ", "=", " ", 
   RowBox[{"plotthrustfuel", "[", 
    RowBox[{
    "tmaxval", ",", "n", ",", " ", "2001", ",", " ", "m0", ",", " ", 
     "fuelpercent", ",", " ", "isp", ",", "  ", "1200"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9522863106375637`*^9, 3.952286315726931*^9}, {
   3.9522868199792147`*^9, 3.952286839260639*^9}, {3.9522871279822063`*^9, 
   3.952287133017277*^9}, {3.952288121790124*^9, 3.952288124026751*^9}, {
   3.9522936651765757`*^9, 3.952293665370391*^9}, {3.952294365394684*^9, 
   3.9522943664061813`*^9}, {3.952294869023204*^9, 3.9522948785442038`*^9}, {
   3.9522954893023367`*^9, 3.952295489650769*^9}, {3.952295865580637*^9, 
   3.952295874281865*^9}, {3.9522982496156893`*^9, 3.95229825316582*^9}, {
   3.952298665978862*^9, 3.952298680683875*^9}, {3.952342446532503*^9, 
   3.952342450852455*^9}, {3.9523437305905247`*^9, 3.952343731084467*^9}, {
   3.9523452365443497`*^9, 3.9523452386997147`*^9}, {3.952345856960656*^9, 
   3.952345858185041*^9}, {3.952366239074697*^9, 3.952366268878932*^9}, {
   3.952366731926137*^9, 3.95236673657167*^9}, {3.952367147837678*^9, 
   3.952367149634849*^9}, {3.9523673760081367`*^9, 3.952367376672515*^9}, {
   3.9523674771280622`*^9, 3.952367483180448*^9}, {3.952367795114583*^9, 
   3.952367798303095*^9}, {3.952371225517095*^9, 3.95237122793813*^9}, {
   3.952454894618822*^9, 3.952454895219118*^9}, {3.952509943697722*^9, 
   3.9525099448403187`*^9}, {3.95307201419971*^9, 3.9530720199240303`*^9}, {
   3.9530725765618553`*^9, 3.95307257661797*^9}, {3.9530737060567703`*^9, 
   3.95307370612186*^9}, {3.953074168083234*^9, 3.953074168164517*^9}, {
   3.953074856520308*^9, 3.953074859869616*^9}, 3.9530769837359247`*^9, {
   3.9531633893167057`*^9, 3.953163392572872*^9}, {3.953238771925555*^9, 
   3.953238792085156*^9}, {3.953239036203208*^9, 3.953239056808813*^9}, {
   3.953240067126309*^9, 3.953240067138914*^9}, {3.9532421267900867`*^9, 
   3.953242127023925*^9}, {3.9532460623413773`*^9, 3.953246064233811*^9}, {
   3.9532478876262083`*^9, 3.9532478876481857`*^9}, {3.9532480969363737`*^9, 
   3.953248097454381*^9}, {3.95324941047683*^9, 3.953249410494198*^9}, {
   3.953420232778688*^9, 3.9534202328818407`*^9}},
 CellLabel->
  "In[897]:=",ExpressionUUID->"caf13509-62fb-46ba-b6c2-7494c4a365ad"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "precondition", " ", "is", " ", "that", " ", "directions", " ", 
    "are", " ", "lined", " ", "up", " ", "with", " ", "the", " ", "costate", " ",
     "directions"}], "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"computeReachableSet", "[", "paramList_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thrustmax", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
       RowBox[{"endTime", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", 
       RowBox[{"m0", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", " ", 
       RowBox[{"fuelpercent", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", " ", 
       RowBox[{"isp", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "6", "]"}], "]"}]}], ";", " ", 
       RowBox[{"initialAngle", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "7", "]"}], "]"}]}], ";", 
       RowBox[{"curFuelLimCostates", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "8", "]"}], "]"}]}], ";", " ", 
       RowBox[{"prevThrustLimCostates", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "9", "]"}], "]"}]}], ";", " ", 
       RowBox[{"directions", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "10", "]"}], "]"}]}], ";", " ", 
       RowBox[{"jump", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "11", "]"}], "]"}]}], ";", " ", 
       RowBox[{"costateminus1", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "12", "]"}], "]"}]}], ";", " ", 
       RowBox[{"costateminus2", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "13", "]"}], "]"}]}], ";", " ", 
       RowBox[{"costateminus3", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "14", "]"}], "]"}]}], ";", " ", 
       RowBox[{"counter", " ", "=", " ", 
        RowBox[{"paramList", "[", 
         RowBox[{"[", "15", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computing Reachable Set: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "endTime", "]"}]}], " ", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"num", " ", "=", " ", 
        RowBox[{"curFuelLimCostates", " ", "//", " ", "Length"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",",
             " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",",
             "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0", ",", " ", 
            RowBox[{"2", "n"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
            RowBox[{
             RowBox[{"-", "2"}], "n"}], ",", " ", "0", ",", "0"}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", 
            RowBox[{"-", 
             RowBox[{"n", "^", "2"}]}], ",", " ", "0", ",", " ", "0", ",", 
            " ", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maximumMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"thrustmax", " ", "fuelpercent", " ", 
           RowBox[{"endTime", " ", "/", " ", "isp"}]}], ",", " ", "num"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"unitVectors", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", "#", "]"}], " ", "//", " ", "N"}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "#", "]"}], " ", "//", " ", "N"}]}], "}"}], 
          "&"}], "/@", "directions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"As", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"A", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"initialMasses", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"m0", ",", " ", "num"}], "]"}]}], ";", 
       RowBox[{"isps", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"isp", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"endTimes", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"endTime", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maximumThrusts", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"thrustmax", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fuelPercents", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"fuelpercent", ",", " ", "num"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"curFuelLimCostates", " ", "//", " ", "Dimensions"}], " ", "//",
         " ", "Print"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"costateminus1", " ", "//", " ", "Dimensions"}], " ", "//", 
        " ", "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "estimationCombination"}], " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"5", "/", "2"}], ")"}], " ", "curFuelLimCostates"}], 
           "  ", "-", " ", 
           RowBox[{"2", " ", "costateminus1"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], " ", "costateminus2"}], " ", "+",
            " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "6"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"11", " ", "curFuelLimCostates"}], " ", "-", " ", 
              RowBox[{"18", " ", "costateminus1"}], " ", "+", " ", 
              RowBox[{"9", " ", "costateminus2"}], " ", "-", " ", 
              RowBox[{"2", "costateminus3"}]}], ")"}]}]}]}], ";"}], "**)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "estimationCombination"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"2", "curFuelLimCostates"}], " ", "-", " ", 
           "costateminus1"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "estimationCombination"}], " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"5", "/", "4"}], ")"}], "curFuelLimCostates"}], "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "/", "2"}], ")"}], "costateminus1"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], "costateminus2"}]}]}], ";"}], 
        "**)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"estimationCombination", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"counter", " ", "==", " ", "0"}], " ", "||", " ", 
           RowBox[{"counter", " ", "==", " ", "1"}], " ", "||", " ", 
           RowBox[{"counter", " ", "==", " ", "2"}]}], ",", " ", 
          "curFuelLimCostates", ",", " ", 
          RowBox[{
           RowBox[{"2", "curFuelLimCostates"}], " ", "-", " ", 
           "costateminus1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"*", "estimationCombination"}], " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"5", "/", "4"}], ")"}], "curFuelLimCostates"}], " ", "-",
            " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"37", "/", "24"}], ")"}], " ", "costateminus1"}], " ", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "3"}], ")"}], "costateminus2"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "24"}], ")"}], "costateminus3"}]}]}], ";"}], 
        "**)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fuelLimitedSolutions", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"rootfind", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "estimationCombination", ",", " ", "maximumMasses", ",", " ", 
            "unitVectors", ",", " ", "As", ",", " ", "initialMasses", ",", 
            " ", "isps", ",", " ", "endTimes", ",", " ", "maximumThrusts", ",",
             " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
             "estimationCombination"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"A", " ", "//", "Transpose"}], ")"}]}], " ", "endTime"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "5"}], "]"}], "]"}], ".", 
             RowBox[{"{", 
              RowBox[{
              "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
               "v5", ",", " ", "v6"}], "}"}]}], " ", "==", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4", ",", " ", 
             "v5", ",", " ", "v6"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"propogate", "[", "posxposymCostate_", "]"}], " ", ":=", 
        RowBox[{"propStateCostatev2", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
              "m0"}], "}"}], ",", "   ", 
            RowBox[{"Join", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",",
                " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", 
                  "subs"}], " ", ")"}], " ", "/.", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"v2", " ", "->", 
                   RowBox[{"posxposymCostate", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"posxposymCostate", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}], ",", " ", "isp", ",", " ", "endTime", ",", " ", "thrustmax",
           ",", " ", "A"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"costateminus3prime", " ", "=", " ", "costateminus2"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costateminus2prime", " ", "=", " ", "costateminus1"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costateminus1prime", " ", "=", " ", "curFuelLimCostates"}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"terminalPositions", " ", "=", " ", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"propogate", ",", "fuelLimitedSolutions"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costatedirections", " ", "=", " ", 
        RowBox[{"curFuelLimCostates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", 
           RowBox[{"1", " ", ";;", " ", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"costatemasses", " ", "=", " ", 
        RowBox[{"curFuelLimCostates", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"costateratios", " ", "=", 
        RowBox[{"costatemasses", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"Norm", " ", "/@", " ", "costatedirections"}], ")"}]}]}], 
       " ", ";", "\[IndentingNewLine]", 
       RowBox[{"costateangles", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ArcTan", "@@", "#"}], "&"}], "/@", " ", 
         "costatedirections"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{"costateangles", "/.", " ", 
                RowBox[{
                 RowBox[{"x_Real", "/;", 
                  RowBox[{"x", "<", 
                   RowBox[{"-", "1"}]}]}], "->", 
                 RowBox[{"x", "+", 
                  RowBox[{"2", " ", "Pi"}]}]}]}]}], "}"}], " ", "//", " ", 
             "Transpose"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{"costateratios", " ", "/", " ", 
                RowBox[{"10", "^", "7"}]}]}], "}"}], " ", "//", " ", 
             "Transpose"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", " ", 
                 RowBox[{"costateratios", " ", "//", " ", "Length"}]}], 
                "]"}]}], "}"}], " ", "//", " ", "Transpose"}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"directions", ",", " ", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"Pi", ",", " ", 
                 RowBox[{"costateratios", " ", "//", " ", "Length"}]}], 
                "]"}]}], "}"}], " ", "//", " ", "Transpose"}]}], "}"}], ",", 
          " ", 
          RowBox[{"PlotRange", "->", "All"}], ",", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Thick", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2.61", ",", 
                  RowBox[{"-", "Pi"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2.61", ",", "Pi"}], "}"}]}], "}"}], "]"}], ",", 
             "Blue", ",", "Thick", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5.78", ",", 
                  RowBox[{"-", "Pi"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5.78", ",", "Pi"}], "}"}]}], "}"}], "]"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<costateratiograph``.png\>\"", ",", " ", "endTime"}], 
           "]"}], " ", "//", " ", "ToString"}], ",", " ", "l2"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"idxmaxfull", " ", "=", " ", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{
           RowBox[{"Norm", " ", "/@", " ", 
            RowBox[{"terminalPositions", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", " ", 
               RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxdirfull", " ", "=", " ", 
        RowBox[{"terminalPositions", "[", 
         RowBox[{"[", 
          RowBox[{"idxmaxfull", ",", " ", 
           RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"maxdirfull", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"maxdirfull", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", " ", "Print"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"flipTransformation", "=", 
        RowBox[{"ReflectionTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plot", " ", "=", "  ", 
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"Point", "[", "terminalPositions", "]"}], ",", 
               RowBox[{"ScalingTransform", "[", 
                RowBox[{"{", 
                 RowBox[{"0.001", ",", " ", "0.001"}], "}"}], "]"}]}], "]"}], 
             "]"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"*", 
               RowBox[{"Graphics", "[", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", " ", 
                  RowBox[{"GeometricTransformation", "[", 
                   RowBox[{
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "maxpos"}]}], "}"}], " ", "]"}], ",", 
                    " ", "flipTransformation"}], "]"}]}], "}"}], "]"}]}], ",",
               " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Red", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "maxpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ",", " ", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"0.001", "minpos"}]}], "}"}], " ", "]"}], ",", 
                   " ", "flipTransformation"}], "]"}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", 
                RowBox[{"Blue", ",", " ", 
                 RowBox[{"GeometricTransformation", "[", 
                  RowBox[{
                   RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.001"}], " ", "minpos"}]}], "}"}], " ", 
                    "]"}], ",", " ", "flipTransformation"}], "]"}]}], "}"}], 
               "]"}], ","}], " ", "**)"}], "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], " ", "0.001", " ", "maxdirfull"}]}], 
                 "}"}], " ", "]"}]}], "}"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Arrow", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"1.1", " ", "0.001", " ", "maxdirfull"}]}], "}"}], 
                " ", "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Axes", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"ImagePadding", " ", "->", "30"}], ",", "   ", 
            RowBox[{
            "PlotLabel", " ", "->", 
             " ", "\"\<Thrust and Fuel Limited RRS\>\""}], ",", " ", 
            RowBox[{"AxesLabel", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<y (km)\>\"", ",", " ", "\"\<x (km)\>\""}], 
              "}"}]}]}], "]"}], ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blue", ",", "Red", ",", " ", "Green"}], "}"}], ",", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Minimum Ratio\>\"", ",", "\"\<Maximum Ratio\>\"", 
                ",", " ", "\"\<Maximum Extent\>\""}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.1", ",", "0.001"}], "}"}]}], "]"}]}], "]"}]}], " ", ";",
        "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringForm", "[", 
           
           RowBox[{"\"\<RRStimeContinuation2k``.png\>\"", ",", " ", 
            "endTime"}], "]"}], " ", "//", " ", "ToString"}], ",", " ", 
         "plot"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "thrustmax", ",", " ", "n", ",", " ", "endTime", ",", " ", "m0", ",",
           " ", "fuelpercent", ",", " ", "isp", ",", " ", "initialAngle", ",",
           " ", "fuelLimitedSolutions", ",", " ", "prevThrustLimCostates", ",",
           " ", "directions", ",", " ", "jump"}], "}"}], " ", ">>", " ", 
        RowBox[{
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<costatesols``\>\"", ",", " ", "endTime"}], "]"}], " ", 
         "//", " ", "ToString"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"thrustmax", ",", " ", "n", ",", " ", 
         RowBox[{"endTime", " ", "+", " ", "jump"}], ",", " ", "m0", ",", " ",
          "fuelpercent", ",", " ", "isp", ",", " ", "initialAngle", ",", " ", 
         "fuelLimitedSolutions", ",", " ", "prevThrustLimCostates", ",", " ", 
         "directions", ",", " ", "jump", ",", " ", "costateminus1prime", ",", 
         " ", "costateminus2prime", ",", " ", "costateminus3prime", ",", " ", 
         
         RowBox[{"counter", " ", "+", " ", "1"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fuelcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefuellim2000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thrustcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefullthrust2000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9522880209577103`*^9, 3.952288037014545*^9}, {
   3.952288068311412*^9, 3.9522881144367657`*^9}, {3.9522881540505123`*^9, 
   3.952288191682602*^9}, {3.952288323779263*^9, 3.952288381503435*^9}, {
   3.952288784393659*^9, 3.95228880228753*^9}, {3.952288855022126*^9, 
   3.9522888561872873`*^9}, {3.952288930505958*^9, 3.952288932543935*^9}, {
   3.952289008138301*^9, 3.9522891497518187`*^9}, {3.952289381163537*^9, 
   3.95228943803729*^9}, {3.952289477224269*^9, 3.952289529499365*^9}, {
   3.952289864752473*^9, 3.9522898853449097`*^9}, {3.9522901159894457`*^9, 
   3.952290218397468*^9}, {3.9522904067142487`*^9, 3.952290427507471*^9}, {
   3.9522905919934*^9, 3.952290596088129*^9}, {3.952290630852507*^9, 
   3.952290735815261*^9}, {3.952290784426085*^9, 3.952290793026219*^9}, {
   3.952290888110683*^9, 3.95229089527392*^9}, {3.952291406548799*^9, 
   3.952291555198368*^9}, {3.952291652880184*^9, 3.952291655311919*^9}, {
   3.952292292192259*^9, 3.952292322937224*^9}, {3.952292374316038*^9, 
   3.952292421307612*^9}, {3.952292473099818*^9, 3.952292473843815*^9}, {
   3.952292513108602*^9, 3.952292513419232*^9}, {3.952292567955101*^9, 
   3.952292568951789*^9}, {3.952292668528916*^9, 3.952292721217382*^9}, {
   3.952293097118329*^9, 3.952293097255875*^9}, {3.9522936074312143`*^9, 
   3.95229362568161*^9}, {3.952294213561569*^9, 3.9522942243044577`*^9}, {
   3.9522942920649757`*^9, 3.95229429290027*^9}, {3.9522943836461887`*^9, 
   3.952294384608068*^9}, {3.9522944436240396`*^9, 3.952294443979075*^9}, {
   3.952294565081211*^9, 3.952294565250753*^9}, {3.9522946503826714`*^9, 
   3.952294651328926*^9}, {3.9522946883620253`*^9, 3.952294692068173*^9}, {
   3.952294827055934*^9, 3.9522948274501953`*^9}, {3.952294881705195*^9, 
   3.952294883160758*^9}, {3.952295494066304*^9, 3.952295494532824*^9}, {
   3.952295858683568*^9, 3.952295870304421*^9}, {3.952296625890299*^9, 
   3.952296628097329*^9}, {3.952296782847414*^9, 3.952296783245479*^9}, {
   3.9522969619430017`*^9, 3.952296963749568*^9}, {3.952297197269865*^9, 
   3.952297201499192*^9}, {3.952298261462221*^9, 3.952298261544767*^9}, {
   3.9522983507932568`*^9, 3.952298375994681*^9}, {3.952336559607387*^9, 
   3.9523365913458652`*^9}, {3.9523423971527243`*^9, 3.95234242779254*^9}, {
   3.952344636608482*^9, 3.952344660144281*^9}, {3.9523447252215548`*^9, 
   3.952344766728669*^9}, {3.9523448414963617`*^9, 3.952344923707151*^9}, {
   3.952344983085744*^9, 3.952344987496492*^9}, {3.952345021645402*^9, 
   3.9523450296760893`*^9}, {3.952345175110808*^9, 3.952345180375543*^9}, {
   3.952345287118848*^9, 3.952345309007676*^9}, {3.9523453591419697`*^9, 
   3.95234542012918*^9}, {3.952345468385557*^9, 3.952345472711546*^9}, 
   3.952345554011647*^9, {3.9523458868403473`*^9, 3.9523459913619013`*^9}, 
   3.9523465150851*^9, {3.952346875079236*^9, 3.952346875562199*^9}, {
   3.952347119232313*^9, 3.952347142244199*^9}, {3.952347203711673*^9, 
   3.9523472377744226`*^9}, {3.95234732715553*^9, 3.952347330236382*^9}, {
   3.952347423971483*^9, 3.9523474524489326`*^9}, {3.952348460341515*^9, 
   3.9523484678544893`*^9}, {3.952348635366069*^9, 3.952348635627324*^9}, {
   3.952349098061326*^9, 3.9523491094621363`*^9}, 3.952349149143415*^9, {
   3.952349257385799*^9, 3.9523492771387043`*^9}, {3.952349330722267*^9, 
   3.9523493332121563`*^9}, 3.952349795815201*^9, {3.952349965127413*^9, 
   3.952349981294567*^9}, {3.952350014954084*^9, 3.9523500668131237`*^9}, {
   3.952350101627121*^9, 3.952350109429283*^9}, {3.952350596129904*^9, 
   3.9523506309329576`*^9}, {3.9523512845531054`*^9, 
   3.9523512861676893`*^9}, {3.952351465026561*^9, 3.952351475323057*^9}, {
   3.952351968530027*^9, 3.952352027218676*^9}, {3.952352490938115*^9, 
   3.952352616273748*^9}, {3.952352659684924*^9, 3.95235265992698*^9}, {
   3.9523527346968193`*^9, 3.952352736281659*^9}, {3.9523527997786913`*^9, 
   3.952352803278008*^9}, {3.952352837396648*^9, 3.95235286333412*^9}, {
   3.952352976047659*^9, 3.952352978480464*^9}, {3.952354024719987*^9, 
   3.952354065419969*^9}, {3.9523541122552834`*^9, 3.9523541145219183`*^9}, {
   3.9523541508930264`*^9, 3.952354160566077*^9}, {3.952354343041465*^9, 
   3.9523543433589897`*^9}, {3.952355761689695*^9, 3.952355768046053*^9}, {
   3.952355820893283*^9, 3.952355910241551*^9}, {3.9523570472218447`*^9, 
   3.952357156138633*^9}, 3.9523572089449883`*^9, {3.952357303543614*^9, 
   3.952357304954321*^9}, {3.952370481961178*^9, 3.952370503608152*^9}, {
   3.952370753138792*^9, 3.952370826154209*^9}, {3.952370984664372*^9, 
   3.9523709967604847`*^9}, {3.952371165634099*^9, 3.952371171340126*^9}, {
   3.952371569718141*^9, 3.9523715844527693`*^9}, {3.952371792895729*^9, 
   3.952371803233783*^9}, {3.952371874761614*^9, 3.9523718749830227`*^9}, {
   3.9523722857302513`*^9, 3.952372288118513*^9}, {3.952372384575038*^9, 
   3.9523723893196163`*^9}, 3.952372467481367*^9, 3.952373068791698*^9, {
   3.952455191162985*^9, 3.95245521348463*^9}, 3.9524552477459106`*^9, {
   3.95245527877242*^9, 3.952455282545648*^9}, {3.952455346380579*^9, 
   3.95245536568405*^9}, 3.952455395977462*^9, {3.9524554299246197`*^9, 
   3.952455458368232*^9}, 3.952455721068819*^9, 3.9524574711272707`*^9, 
   3.952457556990623*^9, 3.9525105300517073`*^9, 3.95251063884134*^9, {
   3.952510741794168*^9, 3.952510747180943*^9}, 3.952510815701727*^9, {
   3.952515182201037*^9, 3.952515182569223*^9}, {3.952515298205597*^9, 
   3.952515327065387*^9}, 3.952515451651182*^9, {3.952519780296151*^9, 
   3.952519780605394*^9}, 3.95251984983825*^9, 3.952519909378481*^9, {
   3.9525206269790907`*^9, 3.952520648637196*^9}, {3.952520685054216*^9, 
   3.952520750155994*^9}, {3.952521639304449*^9, 3.9525217211311007`*^9}, {
   3.9525221048838167`*^9, 3.952522134021068*^9}, {3.952522176850424*^9, 
   3.952522185819949*^9}, {3.952522265735285*^9, 3.952522267537054*^9}, {
   3.952522357892579*^9, 3.9525223790521812`*^9}, {3.952522410937812*^9, 
   3.952522472180111*^9}, {3.952523059223596*^9, 3.952523062320112*^9}, {
   3.95252343207554*^9, 3.952523518520075*^9}, {3.952524544679739*^9, 
   3.952524565526463*^9}, {3.952524642288694*^9, 3.9525246452476683`*^9}, {
   3.952524902307035*^9, 3.952524922136505*^9}, {3.9525437587593307`*^9, 
   3.95254378475718*^9}, {3.95254564394984*^9, 3.952545671545637*^9}, {
   3.952554709422406*^9, 3.952554740513118*^9}, 3.952901356278839*^9, {
   3.952901573329064*^9, 3.952901612333593*^9}, {3.952901714265616*^9, 
   3.952901724544039*^9}, {3.952901818174807*^9, 3.952901825089567*^9}, {
   3.95306536226797*^9, 3.9530653624969883`*^9}, {3.953065490602303*^9, 
   3.9530654914005404`*^9}, {3.953126911805336*^9, 3.9531270600593348`*^9}, {
   3.9531272542174177`*^9, 3.953127259037999*^9}, {3.953129850880815*^9, 
   3.953129856624421*^9}, {3.953130523516911*^9, 3.953130524863777*^9}, {
   3.9531306161745253`*^9, 3.953130628998954*^9}, {3.9531320970895348`*^9, 
   3.95313213526725*^9}, {3.953132268363717*^9, 3.953132322879796*^9}, {
   3.9531323749638*^9, 3.95313238239994*^9}, {3.953132443773773*^9, 
   3.953132446360722*^9}, {3.953132477102126*^9, 3.9531325199953423`*^9}, {
   3.953133044979898*^9, 3.953133053235147*^9}, {3.953133154431616*^9, 
   3.9531331727494926`*^9}, {3.9531332106375847`*^9, 3.953133210642144*^9}, {
   3.953133398913739*^9, 3.953133448595171*^9}, {3.953134279335292*^9, 
   3.953134291158617*^9}, {3.953135156907153*^9, 3.953135162150352*^9}, {
   3.953141598269547*^9, 3.95314160600941*^9}, {3.953141777208036*^9, 
   3.953141785529261*^9}, {3.953150207049258*^9, 3.9531502378764763`*^9}, {
   3.9531527728075037`*^9, 3.95315277620021*^9}, {3.95315285901108*^9, 
   3.9531529091552887`*^9}, {3.953152969657854*^9, 3.953152975997222*^9}, {
   3.953153053451353*^9, 3.9531530646427307`*^9}, {3.953225957381431*^9, 
   3.953225960248789*^9}, {3.953245263686201*^9, 3.953245265875393*^9}, {
   3.9532455509922037`*^9, 3.953245551324082*^9}, {3.9532456809866*^9, 
   3.953245690509478*^9}, {3.9532460434909573`*^9, 3.9532460479289017`*^9}, {
   3.9532858649973507`*^9, 3.953285873343933*^9}, {3.953290566710836*^9, 
   3.953290615107932*^9}, {3.9542697544523582`*^9, 3.954269754598761*^9}, {
   3.956060789101915*^9, 3.9560608019128313`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"df394b3c-5444-4bb6-abb3-568e72e18226"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"computeReachableSet", "[", 
     RowBox[{
     "tmaxval", ",", " ", "n", ",", " ", "2000", ",", " ", "m0", ",", " ", 
      "fuelpercent", ",", " ", "isp", ",", " ", 
      RowBox[{"Pi", "/", "4"}], ",", " ", 
      RowBox[{"fuelcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"thrustcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"fuelcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}]}], "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", 
    RowBox[{"computeReachableSet", "[", 
     RowBox[{
     "tmaxval", ",", " ", "n", ",", " ", "2006.25", ",", " ", "m0", ",", 
      "fuelpercent", ",", " ", "isp", ",", " ", 
      RowBox[{"Pi", "/", "4"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
      RowBox[{"directioncostatemap", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "**)"}]}]], "Input",
 CellChangeTimes->{{3.9522880209577103`*^9, 3.952288037014545*^9}, {
   3.952288068311412*^9, 3.9522881144367657`*^9}, {3.9522881540505123`*^9, 
   3.952288191682602*^9}, {3.952288323779263*^9, 3.952288381503435*^9}, {
   3.952288784393659*^9, 3.95228880228753*^9}, {3.952288855022126*^9, 
   3.9522888561872873`*^9}, {3.952288930505958*^9, 3.952288932543935*^9}, {
   3.952289008138301*^9, 3.9522891497518187`*^9}, {3.952289381163537*^9, 
   3.95228943803729*^9}, {3.952289477224269*^9, 3.952289529499365*^9}, {
   3.952289864752473*^9, 3.9522898853449097`*^9}, {3.9522901159894457`*^9, 
   3.952290218397468*^9}, {3.9522904067142487`*^9, 3.952290427507471*^9}, {
   3.9522905919934*^9, 3.952290596088129*^9}, {3.952290630852507*^9, 
   3.952290735815261*^9}, {3.952290784426085*^9, 3.952290793026219*^9}, {
   3.952290888110683*^9, 3.95229089527392*^9}, {3.952291406548799*^9, 
   3.952291555198368*^9}, {3.952291652880184*^9, 3.952291655311919*^9}, {
   3.952292292192259*^9, 3.952292322937224*^9}, {3.952292374316038*^9, 
   3.952292421307612*^9}, {3.952292473099818*^9, 3.952292473843815*^9}, {
   3.952292513108602*^9, 3.952292513419232*^9}, {3.952292567955101*^9, 
   3.952292568951789*^9}, {3.952292668528916*^9, 3.952292721217382*^9}, {
   3.952293097118329*^9, 3.952293097255875*^9}, {3.9522936074312143`*^9, 
   3.95229362568161*^9}, {3.952294213561569*^9, 3.9522942243044577`*^9}, {
   3.9522942920649757`*^9, 3.95229429290027*^9}, {3.9522943836461887`*^9, 
   3.952294384608068*^9}, {3.9522944436240396`*^9, 3.952294443979075*^9}, {
   3.952294565081211*^9, 3.952294565250753*^9}, {3.9522946503826714`*^9, 
   3.952294651328926*^9}, {3.9522946883620253`*^9, 3.952294692068173*^9}, {
   3.952294827055934*^9, 3.9522948274501953`*^9}, {3.952294881705195*^9, 
   3.952294883160758*^9}, {3.952295494066304*^9, 3.952295494532824*^9}, {
   3.952295858683568*^9, 3.952295870304421*^9}, {3.952296625890299*^9, 
   3.952296628097329*^9}, {3.952296782847414*^9, 3.952296783245479*^9}, {
   3.9522969619430017`*^9, 3.952296963749568*^9}, {3.952297197269865*^9, 
   3.952297201499192*^9}, {3.952298261462221*^9, 3.952298261544767*^9}, {
   3.9522983507932568`*^9, 3.952298375994681*^9}, {3.952336559607387*^9, 
   3.9523365913458652`*^9}, {3.9523423971527243`*^9, 3.95234242779254*^9}, {
   3.952344636608482*^9, 3.952344660144281*^9}, {3.9523447252215548`*^9, 
   3.952344766728669*^9}, {3.9523448414963617`*^9, 3.952344923707151*^9}, {
   3.952344983085744*^9, 3.952344987496492*^9}, {3.952345021645402*^9, 
   3.9523450296760893`*^9}, {3.952345175110808*^9, 3.952345180375543*^9}, {
   3.952345287118848*^9, 3.952345309007676*^9}, {3.9523453591419697`*^9, 
   3.95234542012918*^9}, {3.952345468385557*^9, 3.952345472711546*^9}, 
   3.952345554011647*^9, {3.9523458868403473`*^9, 3.9523459913619013`*^9}, 
   3.9523465150851*^9, {3.952346875079236*^9, 3.952346875562199*^9}, 
   3.952347119232313*^9, {3.952348200602413*^9, 3.952348253330611*^9}, {
   3.952348490666931*^9, 3.952348491593961*^9}, {3.952349200994623*^9, 
   3.952349206800358*^9}, {3.9523500768727303`*^9, 3.952350077458045*^9}, {
   3.9523514264313173`*^9, 3.9523514273688602`*^9}, {3.9523520338920507`*^9, 
   3.9523520357535753`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"0529e64a-d73d-4835-aaf7-70d33b7afeb2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"indices", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", " ", "1200", ",", " ", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"fuelcostates", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "//", " ", "Dimensions"}],
      " ", "//", " ", "Print"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"terdirections", " ", "=", " ", 
     RowBox[{"fuelcostates", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"terdirections", " ", "//", " ", "Dimensions"}], " ", "//", " ", 
     "Print"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.952351380738874*^9, 3.952351453782484*^9}, {
   3.9523514846903067`*^9, 3.952351486209444*^9}, {3.9523518467363157`*^9, 
   3.95235188181328*^9}, {3.9523519124604053`*^9, 3.952351951147526*^9}, {
   3.9523520404380627`*^9, 3.952352041044033*^9}, 3.952352075940588*^9, {
   3.952352271307838*^9, 3.952352271605424*^9}, {3.9523523162527657`*^9, 
   3.952352317397677*^9}, 3.952352349154324*^9, {3.952352412439107*^9, 
   3.952352422048411*^9}, {3.952353961886963*^9, 3.952354017325903*^9}, {
   3.952354380993462*^9, 3.952354405973917*^9}, {3.952354783058887*^9, 
   3.9523547884405603`*^9}, 3.9523551434590282`*^9, {3.952355773082119*^9, 
   3.95235580297904*^9}, 3.952370544735465*^9, {3.9525228780348*^9, 
   3.952522972705793*^9}, {3.9525231589214153`*^9, 3.952523160133436*^9}, 
   3.9525235354666986`*^9, {3.952523787656618*^9, 3.9525237877338448`*^9}, {
   3.9530652702958384`*^9, 3.953065299974627*^9}, {3.95306546710183*^9, 
   3.9530654676676197`*^9}, {3.953133459351214*^9, 3.9531334595757637`*^9}, {
   3.953133836638732*^9, 3.9531338375780582`*^9}, {3.953134116305373*^9, 
   3.953134116391017*^9}, {3.953134325426619*^9, 3.95313432615205*^9}, {
   3.9531414493621597`*^9, 3.953141453288001*^9}, {3.9531484697966957`*^9, 
   3.953148470080381*^9}, {3.953151806320757*^9, 3.953151897171125*^9}, {
   3.953151953724291*^9, 3.9531519840543118`*^9}, {3.95315205146763*^9, 
   3.9531520933358603`*^9}, {3.953152165323658*^9, 3.953152179405612*^9}, {
   3.953152310538311*^9, 3.953152322529624*^9}, {3.9531523670739803`*^9, 
   3.953152382487705*^9}, {3.953152420391271*^9, 3.953152451293283*^9}, {
   3.95315251838523*^9, 3.953152518443185*^9}, {3.953152557372138*^9, 
   3.953152578988983*^9}, {3.953152655971672*^9, 3.9531526594792633`*^9}, {
   3.953152696783873*^9, 3.9531527085398912`*^9}, {3.953152781737812*^9, 
   3.953152784422093*^9}, {3.9531609109253263`*^9, 3.953160917994282*^9}, {
   3.953245323007107*^9, 3.953245324052162*^9}, {3.9532453552793207`*^9, 
   3.953245368972602*^9}, {3.953245404349329*^9, 3.9532454083912582`*^9}, {
   3.953245560108871*^9, 3.953245560284212*^9}, {3.953558297814568*^9, 
   3.953558301405342*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"3ee8edee-c6e0-49c7-9a82-edd76ec0f113"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NestList", "[", 
    RowBox[{"computeReachableSet", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "tmaxval", ",", " ", "n", ",", " ", "2000", ",", " ", "m0", ",", " ", 
       "0.675", ",", " ", "isp", ",", " ", 
       RowBox[{"Pi", "/", "4"}], ",", " ", 
       RowBox[{
        RowBox[{"fuelcostates", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"thrustcostates", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}], "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", 
       RowBox[{"terdirections", "[", 
        RowBox[{"[", "indices", "]"}], "]"}], ",", " ", "50", ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"indices", " ", "//", " ", "Length"}]}], "]"}], ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"indices", "//", " ", "Length"}]}], "]"}], ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"indices", "//", " ", "Length"}]}], "]"}], ",", " ", "0"}], 
      "}"}], ",", " ", "1000"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.952351380738874*^9, 3.952351453782484*^9}, {
   3.9523514846903067`*^9, 3.952351486209444*^9}, {3.9523518467363157`*^9, 
   3.95235188181328*^9}, {3.9523519124604053`*^9, 3.952351951147526*^9}, {
   3.9523520404380627`*^9, 3.952352041044033*^9}, 3.952352075940588*^9, {
   3.952352271307838*^9, 3.952352271605424*^9}, {3.9523523162527657`*^9, 
   3.952352317397677*^9}, 3.952352349154324*^9, {3.952352412439107*^9, 
   3.952352422048411*^9}, {3.952353961886963*^9, 3.952354017325903*^9}, {
   3.952354380993462*^9, 3.952354405973917*^9}, {3.952354783058887*^9, 
   3.9523547884405603`*^9}, 3.9523551434590282`*^9, {3.952355773082119*^9, 
   3.95235580297904*^9}, 3.952370544735465*^9, {3.9525228780348*^9, 
   3.952522972705793*^9}, {3.9525231589214153`*^9, 3.952523160133436*^9}, 
   3.9525235354666986`*^9, {3.952523787656618*^9, 3.9525237877338448`*^9}, {
   3.9530652702958384`*^9, 3.953065299974627*^9}, {3.95306546710183*^9, 
   3.9530654676676197`*^9}, {3.953133459351214*^9, 3.9531334595757637`*^9}, {
   3.953133836638732*^9, 3.9531338375780582`*^9}, {3.953134116305373*^9, 
   3.953134116391017*^9}, {3.953134325426619*^9, 3.95313432615205*^9}, {
   3.9531414493621597`*^9, 3.953141453288001*^9}, {3.9531484697966957`*^9, 
   3.953148470080381*^9}, {3.953151806320757*^9, 3.953151897171125*^9}, {
   3.953151953724291*^9, 3.9531519840543118`*^9}, {3.95315205146763*^9, 
   3.9531520933358603`*^9}, {3.953152165323658*^9, 3.953152179405612*^9}, {
   3.953152310538311*^9, 3.953152322529624*^9}, {3.9531523670739803`*^9, 
   3.953152382487705*^9}, {3.953152420391271*^9, 3.953152451293283*^9}, {
   3.95315251838523*^9, 3.953152518443185*^9}, 3.953152557372138*^9, {
   3.953152725346686*^9, 3.953152728180518*^9}, {3.953152820621584*^9, 
   3.953152826013217*^9}, {3.953160901905595*^9, 3.953160926103321*^9}, {
   3.95324526951061*^9, 3.953245270518098*^9}, {3.953245510012781*^9, 
   3.953245530453559*^9}, {3.953245633324584*^9, 3.953245637533791*^9}, {
   3.953245838683229*^9, 3.95324583939919*^9}, {3.953245911034289*^9, 
   3.953245946162199*^9}, {3.953285888853056*^9, 3.9532858889119463`*^9}, {
   3.953290841764365*^9, 3.953290842021534*^9}, {3.953291097380419*^9, 
   3.9532910981087*^9}, {3.9532915836344624`*^9, 3.9532915998934402`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"fdc81f97-91d3-47df-9f21-1f0cc3e9ece4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.953292388964448*^9, 
  3.953292390986101*^9}},ExpressionUUID->"53610d96-3c55-428d-9240-\
507eee6c5f53"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fuelcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefuellim4000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thrustcostates", " ", "=", " ", 
     RowBox[{"ReadList", "[", "\"\<costatefullthrust4000file\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeReachableSet", "[", 
     RowBox[{"{", 
      RowBox[{
      "tmaxval", ",", " ", "n", ",", " ", "4000", ",", " ", "m0", ",", " ", 
       "fuelpercent", ",", " ", "isp", ",", " ", 
       RowBox[{"Pi", "/", "4"}], ",", " ", 
       RowBox[{"fuelcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"thrustcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
       RowBox[{"fuelcostates", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", "4", ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{
          RowBox[{"fuelcostates", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "//", " ", 
          "Length"}]}], "]"}]}], "}"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.952370307556809*^9, 3.952370311350934*^9}, {
   3.952370396633971*^9, 3.952370467338663*^9}, {3.952370535462865*^9, 
   3.952370555559471*^9}, {3.952370638182638*^9, 3.9523706397519836`*^9}, 
   3.952371596057846*^9, {3.952372344035471*^9, 3.952372347642177*^9}, {
   3.952373032830655*^9, 3.952373052443489*^9}, {3.952373134080411*^9, 
   3.952373137906555*^9}, {3.952455153138291*^9, 3.9524551649595537`*^9}, {
   3.9525102746053667`*^9, 3.952510287952478*^9}, {3.95251527846646*^9, 
   3.952515290009349*^9}, {3.952519790777348*^9, 3.952519810212018*^9}, {
   3.953629071599859*^9, 3.953629071643258*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"dd5dc2eb-2e79-425c-a240-6f54db5c0098"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9524579077577*^9, 
  3.9524579103595257`*^9}},ExpressionUUID->"30709cf9-60db-426a-9760-\
80c143dc167e"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.953557206453018*^9, 3.953557216768937*^9}, {
   3.953557331047497*^9, 3.953557368173147*^9}, {3.953557440963449*^9, 
   3.95355748186133*^9}, {3.95355754066085*^9, 3.95355754394381*^9}, 
   3.9535576035741053`*^9, {3.953557644867158*^9, 3.9535576698773823`*^9}, {
   3.9535577269168053`*^9, 3.953557767934926*^9}, {3.953557806596945*^9, 
   3.9535578921338673`*^9}, {3.95355795018598*^9, 3.9535579931336946`*^9}, {
   3.953558357067498*^9, 3.9535584521370697`*^9}, {3.953558543053886*^9, 
   3.953558565542849*^9}, {3.953558609287396*^9, 3.953558650582149*^9}, {
   3.953628828844584*^9, 3.9536288770233603`*^9}, {3.953629040374393*^9, 
   3.953629043622118*^9}, 3.953629113934411*^9, {3.953629315230982*^9, 
   3.953629371466875*^9}, {3.953629491443326*^9, 3.953629531640725*^9}, {
   3.953629833334771*^9, 3.9536298379689627`*^9}, {3.953629961837729*^9, 
   3.953629976106099*^9}, {3.953630023736107*^9, 3.95363005884589*^9}, {
   3.953630096939743*^9, 3.953630155296157*^9}, {3.953633649108575*^9, 
   3.95363365065528*^9}, {3.9536337213036346`*^9, 3.953633723415587*^9}, {
   3.9536339092455397`*^9, 3.9536339139027567`*^9}, {3.953634153011675*^9, 
   3.953634189363611*^9}, {3.953634237360146*^9, 3.953634271625401*^9}, {
   3.953639858466605*^9, 3.9536398925414047`*^9}, {3.953639925091516*^9, 
   3.953639937725383*^9}, {3.953640093116403*^9, 3.953640093439434*^9}, {
   3.953640300922474*^9, 3.95364033280414*^9}, {3.953640448537012*^9, 
   3.953640576843803*^9}, {3.953640927172286*^9, 3.9536409458136044`*^9}, {
   3.953640976619091*^9, 3.953641003085868*^9}, {3.953641079704398*^9, 
   3.953641137662114*^9}, {3.953641181501457*^9, 3.9536412049498863`*^9}, {
   3.953641608767865*^9, 3.9536416353419533`*^9}, {3.9536417047077847`*^9, 
   3.953641732713016*^9}, {3.953641899289693*^9, 3.953641914305291*^9}, {
   3.953641985023592*^9, 3.953641988200333*^9}, {3.953642030817163*^9, 
   3.953642077850958*^9}, {3.953642123033762*^9, 3.953642153298634*^9}, {
   3.953642200957109*^9, 3.953642258634083*^9}, {3.953642347296749*^9, 
   3.9536423569529467`*^9}, {3.9537250493110247`*^9, 
   3.9537250789095097`*^9}, {3.953725354122036*^9, 3.9537253543482237`*^9}, {
   3.95372554102029*^9, 3.953725544930099*^9}, {3.953725583157831*^9, 
   3.953725585004781*^9}, {3.953725820290003*^9, 3.953725821891447*^9}, {
   3.95372609214699*^9, 3.9537261592306013`*^9}, {3.953726216155294*^9, 
   3.9537262851610727`*^9}, {3.9537263754493427`*^9, 3.95372647015724*^9}, {
   3.953726514423089*^9, 3.953726527346201*^9}, {3.953726744604377*^9, 
   3.953726876796173*^9}, {3.953727021047305*^9, 3.953727023040324*^9}, {
   3.9537270960081778`*^9, 3.953727126896226*^9}, {3.953727190931315*^9, 
   3.953727212173443*^9}, {3.953727258210726*^9, 3.95372725970163*^9}, {
   3.953727790272901*^9, 3.953727799741736*^9}, {3.9537278889762*^9, 
   3.953727950973548*^9}, {3.953728013121003*^9, 3.9537280588412533`*^9}, {
   3.953728363088141*^9, 3.9537283903842688`*^9}, {3.953728455433509*^9, 
   3.953728456881728*^9}, {3.95372868106131*^9, 3.9537286971437283`*^9}, {
   3.953728752446023*^9, 3.953728799718903*^9}, {3.9537288330430517`*^9, 
   3.9537288468090563`*^9}, {3.953728883038216*^9, 3.953728892440817*^9}, {
   3.953728924848081*^9, 3.9537289375594482`*^9}, {3.953729200204845*^9, 
   3.9537292031879463`*^9}, {3.953729241320778*^9, 3.953729267382676*^9}, {
   3.953729331555101*^9, 3.953729352380105*^9}, {3.953729383916966*^9, 
   3.953729421498192*^9}, {3.953729461480451*^9, 3.9537294617884912`*^9}, {
   3.953729536565637*^9, 3.953729615574933*^9}, {3.9537296523201313`*^9, 
   3.953729696141137*^9}, {3.9537297383542147`*^9, 3.953729793157786*^9}, {
   3.953729842499069*^9, 3.953729860661241*^9}, {3.9537299504228287`*^9, 
   3.953729950479879*^9}, {3.953730011477912*^9, 3.9537300774535713`*^9}, {
   3.9537304143904123`*^9, 3.9537304463398533`*^9}, {3.9537304906318827`*^9, 
   3.95373049073107*^9}, {3.953755184910569*^9, 3.953755231995055*^9}, {
   3.953755284189445*^9, 3.953755295853548*^9}, 3.95375534203468*^9, {
   3.9537553969482517`*^9, 3.953755398674371*^9}, {3.953755518510784*^9, 
   3.953755550771966*^9}, {3.953755617238544*^9, 3.953755692048346*^9}, 
   3.953755985192562*^9, {3.954862335555903*^9, 3.954862348879114*^9}, {
   3.954862387731264*^9, 
   3.954862412334326*^9}},ExpressionUUID->"bce85970-f156-4701-bc21-\
b624f82c2346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotthrustfuel", "[", 
   RowBox[{
   "tmaxval", ",", "n", ",", " ", "5497", ",", " ", "m0", ",", " ", "0.675", ",",
     " ", "isp", ",", "  ", "2400"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.953557206453018*^9, 3.953557216768937*^9}, {
   3.953557331047497*^9, 3.953557368173147*^9}, {3.953557440963449*^9, 
   3.95355748186133*^9}, {3.95355754066085*^9, 3.95355754394381*^9}, 
   3.9535576035741053`*^9, {3.953557644867158*^9, 3.9535576698773823`*^9}, {
   3.9535577269168053`*^9, 3.953557767934926*^9}, {3.953557806596945*^9, 
   3.9535578921338673`*^9}, {3.95355795018598*^9, 3.9535579931336946`*^9}, {
   3.953558357067498*^9, 3.9535584521370697`*^9}, {3.953558543053886*^9, 
   3.953558565542849*^9}, {3.953558609287396*^9, 3.953558650582149*^9}, {
   3.953628828844584*^9, 3.9536288770233603`*^9}, {3.953629040374393*^9, 
   3.953629043622118*^9}, 3.953629113934411*^9, {3.953629315230982*^9, 
   3.953629371466875*^9}, {3.953629491443326*^9, 3.953629531640725*^9}, {
   3.953629833334771*^9, 3.9536298379689627`*^9}, {3.953629961837729*^9, 
   3.953629976106099*^9}, {3.953630023736107*^9, 3.95363005884589*^9}, {
   3.953630096939743*^9, 3.953630155296157*^9}, {3.953633649108575*^9, 
   3.95363365065528*^9}, {3.9536337213036346`*^9, 3.953633723415587*^9}, {
   3.9536339092455397`*^9, 3.9536339139027567`*^9}, {3.953634153011675*^9, 
   3.953634189363611*^9}, {3.953634237360146*^9, 3.953634271625401*^9}, {
   3.953639858466605*^9, 3.9536398925414047`*^9}, {3.953639925091516*^9, 
   3.953639937725383*^9}, {3.953640093116403*^9, 3.953640093439434*^9}, {
   3.953640300922474*^9, 3.95364033280414*^9}, {3.953640448537012*^9, 
   3.953640576843803*^9}, {3.953640927172286*^9, 3.9536409458136044`*^9}, {
   3.953640976619091*^9, 3.953641003085868*^9}, {3.953641079704398*^9, 
   3.953641137662114*^9}, {3.953641181501457*^9, 3.9536412049498863`*^9}, {
   3.953641608767865*^9, 3.9536416353419533`*^9}, {3.9536417047077847`*^9, 
   3.953641732713016*^9}, {3.953641899289693*^9, 3.953641914305291*^9}, {
   3.953641985023592*^9, 3.953641988200333*^9}, {3.953642030817163*^9, 
   3.953642077850958*^9}, {3.953642123033762*^9, 3.953642153298634*^9}, {
   3.953642200957109*^9, 3.953642258634083*^9}, {3.953642347296749*^9, 
   3.9536423569529467`*^9}, {3.9537250493110247`*^9, 
   3.9537250789095097`*^9}, {3.953725354122036*^9, 3.9537253543482237`*^9}, {
   3.95372554102029*^9, 3.953725544930099*^9}, {3.953725583157831*^9, 
   3.953725585004781*^9}, {3.953725820290003*^9, 3.953725821891447*^9}, {
   3.95372609214699*^9, 3.9537261592306013`*^9}, {3.953726216155294*^9, 
   3.9537262851610727`*^9}, {3.9537263754493427`*^9, 3.95372647015724*^9}, {
   3.953726514423089*^9, 3.953726527346201*^9}, {3.953726744604377*^9, 
   3.953726876796173*^9}, {3.953727021047305*^9, 3.953727023040324*^9}, {
   3.9537270960081778`*^9, 3.953727126896226*^9}, {3.953727190931315*^9, 
   3.953727212173443*^9}, {3.953727258210726*^9, 3.95372725970163*^9}, {
   3.953727790272901*^9, 3.953727799741736*^9}, {3.9537278889762*^9, 
   3.953727950973548*^9}, {3.953728013121003*^9, 3.9537280588412533`*^9}, {
   3.953728363088141*^9, 3.9537283903842688`*^9}, {3.953728455433509*^9, 
   3.953728456881728*^9}, {3.95372868106131*^9, 3.9537286971437283`*^9}, {
   3.953728752446023*^9, 3.953728799718903*^9}, {3.9537288330430517`*^9, 
   3.9537288468090563`*^9}, {3.953728883038216*^9, 3.953728892440817*^9}, {
   3.953728924848081*^9, 3.9537289375594482`*^9}, {3.953729200204845*^9, 
   3.9537292031879463`*^9}, {3.953729241320778*^9, 3.953729267382676*^9}, {
   3.953729331555101*^9, 3.953729352380105*^9}, {3.953729383916966*^9, 
   3.953729421498192*^9}, {3.953729461480451*^9, 3.9537294617884912`*^9}, {
   3.953729536565637*^9, 3.953729615574933*^9}, {3.9537296523201313`*^9, 
   3.953729696141137*^9}, {3.9537297383542147`*^9, 3.953729793157786*^9}, {
   3.953729842499069*^9, 3.953729860661241*^9}, {3.9537299504228287`*^9, 
   3.953729950479879*^9}, {3.953730011477912*^9, 3.9537300774535713`*^9}, {
   3.9537304143904123`*^9, 3.9537304463398533`*^9}, {3.9537304906318827`*^9, 
   3.95373049073107*^9}, {3.953755184910569*^9, 3.953755231995055*^9}, {
   3.953755284189445*^9, 3.953755295853548*^9}, 3.95375534203468*^9, {
   3.9537553969482517`*^9, 3.953755398674371*^9}, {3.953755518510784*^9, 
   3.953755550771966*^9}, {3.953755617238544*^9, 3.953755692048346*^9}, 
   3.953755985192562*^9, {3.95375614492073*^9, 3.953756183656201*^9}, {
   3.9537574236747217`*^9, 3.95375742374113*^9}, {3.9537578408665857`*^9, 
   3.953757840946198*^9}, {3.9537585811043053`*^9, 3.953758582720231*^9}, {
   3.9537586388612757`*^9, 3.953758641962681*^9}, {3.953763782502399*^9, 
   3.9537637851259403`*^9}, {3.953765578343163*^9, 3.953765584753272*^9}, {
   3.953811371742199*^9, 3.9538113761713343`*^9}, 3.953811875974699*^9, {
   3.9538125703493633`*^9, 3.953812572331971*^9}, 3.954105622311215*^9, {
   3.9541061135728827`*^9, 3.9541061137275677`*^9}, {3.954106203474227*^9, 
   3.954106204454071*^9}, {3.954263887523077*^9, 3.954263892393639*^9}, {
   3.954264711632126*^9, 3.9542647163592873`*^9}, {3.954268003451499*^9, 
   3.9542680034702883`*^9}, {3.954268109317219*^9, 3.954268110735993*^9}, {
   3.954268470093041*^9, 3.954268490384304*^9}, {3.954269418477498*^9, 
   3.9542694192037163`*^9}, {3.9542873293373127`*^9, 3.954287331834282*^9}, {
   3.954287980443778*^9, 3.954287982390543*^9}, {3.954288080529174*^9, 
   3.954288080580502*^9}, {3.9548574459538717`*^9, 3.95485744804627*^9}, {
   3.9550649952224693`*^9, 3.955064996284009*^9}, {3.9551005593800077`*^9, 
   3.9551005651052237`*^9}, {3.955106049171034*^9, 3.955106049376762*^9}, {
   3.955106099800395*^9, 3.955106100915481*^9}, {3.955228966390834*^9, 
   3.955228977415627*^9}, {3.955229093536215*^9, 3.955229102945425*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"e27e8c31-2334-4273-97ab-ceeed7027b5a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ig", " ", "=", " ", 
   RowBox[{
    RowBox[{"findInitialCostates", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", " ", 
      RowBox[{"getFinalEnergyPos", "[", 
       RowBox[{"6000", ",", " ", "0.002", ",", " ", "n", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"3.3", 
            RowBox[{"Pi", "/", "4"}]}], "]"}], ",", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"3.3", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], "}"}], ",", " ", "0.675"}], 
       "]"}], ",", " ", "n", ",", " ", "A", ",", " ", "6000", ",", " ", 
      RowBox[{"0.002", " ", "0.675", " ", 
       RowBox[{"6000", "/", " ", "isp"}]}], ",", " ", "m0", ",", " ", 
      "0.002"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "2", ",", " ", "7"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"fixedPointIterator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.2495288171265707*^-6"}], ",", "1.2020897308543298*^-7",
        ",", "19.128980288124662"}], "}"}], " ", ",", " ", "6800", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"3.15", 
         RowBox[{"Pi", "/", "4"}]}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"3.15", 
         RowBox[{"Pi", "/", "4"}]}], "]"}]}], "}"}], ",", "0.675", ",", " ", 
     "0.002", ",", "isp", ",", " ", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", " ", "//", " ", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"propStateCostatev2", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "m0"}], 
        "}"}], ",", "   ", 
       RowBox[{"Join", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v4", ",", " ", "v5"}], "}"}], " ", "/.", " ", "subs"}],
             " ", ")"}], " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "->", 
              RowBox[{"res", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
             RowBox[{"v2", " ", "->", 
              RowBox[{"res", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{"res", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
      ",", " ", "isp", ",", " ", "6800", ",", " ", "0.002", ",", " ", "A"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}], " ", "//", " ", "Normalize"}], 
   " ", "//", " ", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"3.15", 
         RowBox[{"Pi", "/", "4"}]}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"3.15", 
         RowBox[{"Pi", "/", "4"}]}], "]"}]}], "}"}], " ", "//", " ", "N"}], 
    " ", "//", " ", "Print"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.953557206453018*^9, 3.953557216768937*^9}, {
   3.953557331047497*^9, 3.953557368173147*^9}, {3.953557440963449*^9, 
   3.95355748186133*^9}, {3.95355754066085*^9, 3.95355754394381*^9}, 
   3.9535576035741053`*^9, {3.953557644867158*^9, 3.9535576698773823`*^9}, {
   3.9535577269168053`*^9, 3.953557767934926*^9}, {3.953557806596945*^9, 
   3.9535578921338673`*^9}, {3.95355795018598*^9, 3.9535579931336946`*^9}, {
   3.953558357067498*^9, 3.9535584521370697`*^9}, {3.953558543053886*^9, 
   3.953558565542849*^9}, {3.953558609287396*^9, 3.953558650582149*^9}, {
   3.953628828844584*^9, 3.9536288770233603`*^9}, {3.953629040374393*^9, 
   3.953629043622118*^9}, 3.953629113934411*^9, {3.953629315230982*^9, 
   3.953629371466875*^9}, {3.953629491443326*^9, 3.953629531640725*^9}, {
   3.953629833334771*^9, 3.9536298379689627`*^9}, {3.953629961837729*^9, 
   3.953629976106099*^9}, {3.953630023736107*^9, 3.95363005884589*^9}, {
   3.953630096939743*^9, 3.953630155296157*^9}, {3.953633649108575*^9, 
   3.95363365065528*^9}, {3.9536337213036346`*^9, 3.953633723415587*^9}, {
   3.9536339092455397`*^9, 3.9536339139027567`*^9}, {3.953634153011675*^9, 
   3.953634189363611*^9}, {3.953634237360146*^9, 3.953634271625401*^9}, {
   3.953639858466605*^9, 3.9536398925414047`*^9}, {3.953639925091516*^9, 
   3.953639937725383*^9}, {3.953640093116403*^9, 3.953640093439434*^9}, {
   3.953640300922474*^9, 3.95364033280414*^9}, {3.953640448537012*^9, 
   3.953640576843803*^9}, {3.953640927172286*^9, 3.9536409458136044`*^9}, {
   3.953640976619091*^9, 3.953641003085868*^9}, {3.953641079704398*^9, 
   3.953641137662114*^9}, {3.953641181501457*^9, 3.9536412049498863`*^9}, {
   3.953641608767865*^9, 3.9536416353419533`*^9}, {3.9536417047077847`*^9, 
   3.953641732713016*^9}, {3.953641899289693*^9, 3.953641914305291*^9}, {
   3.953641985023592*^9, 3.953641988200333*^9}, {3.953642030817163*^9, 
   3.953642077850958*^9}, {3.953642123033762*^9, 3.953642153298634*^9}, {
   3.953642200957109*^9, 3.953642258634083*^9}, {3.953642347296749*^9, 
   3.9536423569529467`*^9}, {3.9537250493110247`*^9, 
   3.9537250789095097`*^9}, {3.953725354122036*^9, 3.9537253543482237`*^9}, {
   3.95372554102029*^9, 3.953725544930099*^9}, {3.953725583157831*^9, 
   3.953725585004781*^9}, {3.953725820290003*^9, 3.953725821891447*^9}, {
   3.95372609214699*^9, 3.9537261592306013`*^9}, {3.953726216155294*^9, 
   3.9537262851610727`*^9}, {3.9537263754493427`*^9, 3.95372647015724*^9}, {
   3.953726514423089*^9, 3.953726527346201*^9}, {3.953726744604377*^9, 
   3.953726876796173*^9}, {3.953727021047305*^9, 3.953727023040324*^9}, {
   3.9537270960081778`*^9, 3.953727126896226*^9}, {3.953727190931315*^9, 
   3.953727212173443*^9}, {3.953727258210726*^9, 3.95372725970163*^9}, {
   3.953727790272901*^9, 3.953727799741736*^9}, {3.9537278889762*^9, 
   3.953727950973548*^9}, {3.953728013121003*^9, 3.9537280588412533`*^9}, {
   3.953728363088141*^9, 3.9537283903842688`*^9}, {3.953728455433509*^9, 
   3.953728456881728*^9}, {3.95372868106131*^9, 3.9537286971437283`*^9}, {
   3.953728752446023*^9, 3.953728799718903*^9}, {3.9537288330430517`*^9, 
   3.9537288468090563`*^9}, {3.953728883038216*^9, 3.953728892440817*^9}, {
   3.953728924848081*^9, 3.9537289375594482`*^9}, {3.953729200204845*^9, 
   3.9537292031879463`*^9}, {3.953729241320778*^9, 3.953729267382676*^9}, {
   3.953729331555101*^9, 3.953729352380105*^9}, {3.953729383916966*^9, 
   3.953729421498192*^9}, {3.953729461480451*^9, 3.9537294617884912`*^9}, {
   3.953729536565637*^9, 3.953729615574933*^9}, {3.9537296523201313`*^9, 
   3.953729696141137*^9}, {3.9537297383542147`*^9, 3.953729793157786*^9}, {
   3.953729842499069*^9, 3.953729860661241*^9}, {3.9537299504228287`*^9, 
   3.953729950479879*^9}, {3.953730011477912*^9, 3.9537300774535713`*^9}, {
   3.9537304143904123`*^9, 3.9537304463398533`*^9}, {3.9537304906318827`*^9, 
   3.95373049073107*^9}, {3.953755184910569*^9, 3.953755231995055*^9}, {
   3.953755284189445*^9, 3.953755295853548*^9}, 3.95375534203468*^9, {
   3.9537553969482517`*^9, 3.953755398674371*^9}, {3.953755518510784*^9, 
   3.953755550771966*^9}, {3.953755617238544*^9, 3.953755692048346*^9}, 
   3.953755985192562*^9, {3.95375614492073*^9, 3.953756183656201*^9}, {
   3.9537574236747217`*^9, 3.95375742374113*^9}, {3.9537578408665857`*^9, 
   3.953757840946198*^9}, {3.9537585811043053`*^9, 3.953758582720231*^9}, {
   3.9537586388612757`*^9, 3.953758641962681*^9}, {3.953763782502399*^9, 
   3.9537637851259403`*^9}, {3.953765578343163*^9, 3.953765584753272*^9}, {
   3.953811371742199*^9, 3.9538113761713343`*^9}, 3.953811875974699*^9, {
   3.9538125703493633`*^9, 3.953812572331971*^9}, {3.954105622311215*^9, 
   3.954105693262205*^9}, {3.954105749293969*^9, 3.954105806424806*^9}, {
   3.954106013932835*^9, 3.954106015342359*^9}, {3.95410607413092*^9, 
   3.954106093563842*^9}, {3.954106268760476*^9, 3.954106275979232*^9}, {
   3.954106322381007*^9, 3.954106556360696*^9}, {3.9541065977094297`*^9, 
   3.954106602684457*^9}, {3.95410701689329*^9, 3.954107155169856*^9}, {
   3.954107241881077*^9, 3.95410724942515*^9}, {3.954107289842085*^9, 
   3.954107380105342*^9}, {3.954107421280147*^9, 3.954107444388255*^9}, {
   3.954107509681409*^9, 3.954107516870234*^9}, {3.9541076170021267`*^9, 
   3.9541076233939657`*^9}, {3.9541077233133097`*^9, 
   3.9541077329812727`*^9}, {3.9541078254384527`*^9, 
   3.9541078358615017`*^9}, {3.954169035267415*^9, 3.954169047283545*^9}, {
   3.9541696398349953`*^9, 3.95416964611934*^9}, 3.9542698073165627`*^9, {
   3.954269973231824*^9, 3.954269985362043*^9}, {3.954270104021072*^9, 
   3.9542701067075977`*^9}, {3.954270845642605*^9, 3.954271015067774*^9}, {
   3.9542710533888903`*^9, 3.9542710563448067`*^9}, {3.954271087213221*^9, 
   3.954271146211185*^9}, {3.954271273760289*^9, 3.954271316042131*^9}, {
   3.954271353097684*^9, 3.9542714016194*^9}, {3.9542716561729937`*^9, 
   3.954271694737969*^9}, {3.954271914104312*^9, 3.954271937146984*^9}, {
   3.954282129241726*^9, 3.954282137556568*^9}, {3.954284741522686*^9, 
   3.9542847454802427`*^9}, {3.954285482343458*^9, 3.954285482491537*^9}, {
   3.954285939354323*^9, 3.9542859689656467`*^9}, {3.9542870948062572`*^9, 
   3.9542871272790623`*^9}, {3.954287239846087*^9, 3.9542872474133997`*^9}, {
   3.954287458138137*^9, 3.9542874977044*^9}, {3.954287555433074*^9, 
   3.9542876140147057`*^9}, {3.954287647896667*^9, 3.954287664075634*^9}, {
   3.954287740521524*^9, 3.9542877726865997`*^9}, {3.95428791013342*^9, 
   3.954287918887713*^9}, {3.954360855351013*^9, 3.95436087946664*^9}, {
   3.954360997866839*^9, 3.954361022436062*^9}, {3.9543617878160963`*^9, 
   3.95436181104678*^9}, {3.954362090837261*^9, 3.954362115861085*^9}, {
   3.954362183693491*^9, 3.9543621915226316`*^9}, {3.9543622971934023`*^9, 
   3.954362398409029*^9}, {3.9543625622754297`*^9, 3.9543626803273087`*^9}, {
   3.954362774047872*^9, 3.9543627854432*^9}, {3.954362832925025*^9, 
   3.9543628392222548`*^9}, {3.954362900317504*^9, 3.954362927862178*^9}, {
   3.954362968877942*^9, 3.954363002257399*^9}, {3.954363365791663*^9, 
   3.9543633755382023`*^9}, {3.954363453070796*^9, 3.954363466057602*^9}, {
   3.954363761674396*^9, 3.9543637772296743`*^9}, {3.954368089159329*^9, 
   3.95436810011557*^9}, {3.954368196359611*^9, 3.954368303227632*^9}, {
   3.9543684950566893`*^9, 3.954368537393955*^9}, {3.954513480555916*^9, 
   3.954513494781673*^9}, {3.954513529795498*^9, 3.9545135452725563`*^9}, {
   3.954513600252634*^9, 3.954513606527368*^9}, {3.95451490335833*^9, 
   3.954514984560438*^9}, {3.954515029150902*^9, 3.954515035646119*^9}, {
   3.95451515696329*^9, 3.954515201428254*^9}, {3.9548624252793007`*^9, 
   3.9548624443227386`*^9}, {3.954862604109289*^9, 3.954862612748625*^9}, {
   3.955463208013404*^9, 3.955463220117774*^9}, {3.955465983387804*^9, 
   3.95546599481439*^9}, {3.955466069349081*^9, 3.95546611061615*^9}, {
   3.955466162127165*^9, 3.955466204767434*^9}, {3.955663420333362*^9, 
   3.955663453281022*^9}, {3.955663502140527*^9, 3.9556635049262238`*^9}, {
   3.9556635740881557`*^9, 3.955663587519779*^9}, {3.955663689358334*^9, 
   3.955663739870797*^9}, {3.9556637990399323`*^9, 3.95566389469585*^9}, {
   3.955663954241091*^9, 3.955663985190941*^9}, {3.955664099141116*^9, 
   3.9556640994541063`*^9}, {3.955664148055582*^9, 3.9556641766231947`*^9}, 
   3.955664257027252*^9, {3.955665065728232*^9, 3.955665156338554*^9}, {
   3.955665250544869*^9, 3.9556653480375233`*^9}, {3.9556653813018293`*^9, 
   3.9556654240177393`*^9}, {3.9556654555463877`*^9, 
   3.9556655800563593`*^9}, {3.955665733938945*^9, 3.955665744012938*^9}, {
   3.9557122613148823`*^9, 3.955712279014392*^9}, {3.9557184300970287`*^9, 
   3.955718441387219*^9}, {3.955810284690988*^9, 3.955810299024673*^9}, 
   3.955810356999465*^9, {3.955811129437233*^9, 3.955811138152719*^9}, {
   3.9558221998612556`*^9, 3.955822213781149*^9}, {3.955822445654614*^9, 
   3.955822450068598*^9}, {3.955822527286336*^9, 3.955822571217285*^9}, {
   3.9558226362568073`*^9, 3.9558226441763163`*^9}, {3.95582269220809*^9, 
   3.955822700770072*^9}, {3.95582276286814*^9, 3.955822810820528*^9}, {
   3.955822849609281*^9, 3.955822929288773*^9}, {3.955906666462784*^9, 
   3.955906702166792*^9}, {3.955906747261416*^9, 3.9559067526550817`*^9}, {
   3.9559067888056803`*^9, 3.955906790369383*^9}, {3.955906872044847*^9, 
   3.955906963177372*^9}, {3.9559069954172897`*^9, 3.955907089770699*^9}, {
   3.955907159383296*^9, 3.955907237534502*^9}, {3.9559073043069897`*^9, 
   3.955907359186966*^9}, {3.955907514294043*^9, 3.955907582729411*^9}, {
   3.955907760695158*^9, 3.955908070084482*^9}, {3.955908112695492*^9, 
   3.9559083736759768`*^9}, {3.95591041385779*^9, 3.955910622747671*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"900518c4-b504-483c-8e78-ab7b677b257c"],

Cell[CellGroupData[{

Cell[BoxData["\<\"energy computation executed\"\>"], "Print",
 CellChangeTimes->{3.956065237860836*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"a514dbb1-7173-485a-9149-372106295f4f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7.531725585237673`*^-10"}], ",", 
   RowBox[{"-", "2.886836819940286`*^-13"}]}], "}"}]], "Print",
 CellChangeTimes->{3.95606523823116*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"b64baf21-ba06-419d-8b58-5f601547113c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.0993463404623835`*^-6"}], ",", "1.158297196397478`*^-7", ",",
    "19.128980287964414`"}], "}"}]], "Print",
 CellChangeTimes->{3.956065238232292*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"7dff84f4-f0ce-4aa9-91e5-7a214f2a8365"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7853169301275721`", ",", 
   RowBox[{"-", "0.619093950265229`"}]}], "}"}]], "Print",
 CellChangeTimes->{3.9560652382647943`*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"eb92e178-56bb-43ed-9aac-794a2c0c5acc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7853169308807447`"}], ",", "0.6190939493098342`"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.956065238265327*^9},
 CellLabel->
  "During evaluation of \
In[222]:=",ExpressionUUID->"a4940237-1b4c-422a-b82a-d42c76110a58"]
}, Open  ]]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9536288236323957`*^9, 3.9536288270841913`*^9}, {
   3.9558225139335957`*^9, 3.9558225172368402`*^9}, {3.955822556596067*^9, 
   3.955822595637642*^9}, {3.955822684791399*^9, 3.955822686969049*^9}, {
   3.955822719109354*^9, 3.95582271927221*^9}, 3.955822759159526*^9, {
   3.95582288290571*^9, 3.955822883645708*^9}, {3.955822914042832*^9, 
   3.955822914211281*^9}, {3.955822965194408*^9, 
   3.9558229665527277`*^9}},ExpressionUUID->"1bde3372-e7ba-4981-b443-\
f1480cbb25a1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.955822827696171*^9, 
  3.955822842738661*^9}},ExpressionUUID->"890056bf-d3a3-4916-958e-\
18e27ede2482"],

Cell[BoxData[
 RowBox[{"getReachablePoint", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", " ", 
      RowBox[{"Pi", "+", "1"}], "]"}], ",", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"Pi", "+", "1"}], "]"}]}], "}"}], ",", " ", "5000", ",", " ", 
   "0.002", ",", " ", "n", ",", " ", "1", ",", " ", "A", ",", " ", "0.675", ",",
    " ", "10000"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlx01Ik3EAx/HZUkdlKRjWAp1M1HJtIz1tEZNlE7cwnvkyGyG+rObMZkHL
HsjDUx4UtRBRWK1Dh1gHY+qmthQeKBPMiboNI/SidZBhY5tUqIz+v3+HLx++
+c12xnJEIBAUkCAz6/tZ9Wi3PDu6HYGDOv9vyGo+Uou/SpJQ7Tak6olvzA1H
DcTeJxYRlMQLOfh3cpiaNd30Do6YTo3BFA0/WU9M3BZ5Ydr1gfHXRA9XOgFV
GzHmTNdu+YVtlRHmNRStWYmzdS1Uub9d20Z0xD1UyfnqqnvEZ4edVKvihxFm
OE/Uwjsnv9vgQ9km9cWgi4XMVXsP/cAnJ3zAXnoJOUnaHFQHlTx0yd/r7ETf
/nAlFOvTq+Hdg1Zqgturoe+Yq4P9JU9vwq2eAjN8q5mP3id2h//LmLo/B4jX
wjx1OeYPQqE0JQT9ptg6NKbrvsE+8y/xMnEtmnsOFgoTJfBP1i0ZzFZGjq8S
j8lGM2FlbPQ0LLt4eBa6N8fUcHFJdBlq63NbYdeUlzqjl/ZC25UP1J0vigDk
H3dQ3cIKPki80chRPfqc+TDxFWtfgCuh5+uQTQ5R/wF0CS0J
  "],
 CellLabel->
  "In[1423]:=",ExpressionUUID->"789bd117-af42-474e-8576-65b2eccb0c2b"],

Cell[BoxData["|"], "Input",
 CellChangeTimes->{
  3.955454625286139*^9},ExpressionUUID->"df5a2c58-6cb2-4d82-b6f0-\
485d06a7bfe7"]
},
WindowSize->{Full, Full},
WindowMargins->{{19, Automatic}, {Automatic, 49}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"19df7ab9-360f-46c8-9359-c564d5428dca"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 116083, 2639, 5128, "Input",ExpressionUUID->"de278eee-eaf1-408d-9535-e92a4ec67043",
 InitializationCell->True],
Cell[116640, 2661, 28837, 572, 821, "Input",ExpressionUUID->"d80171dd-62e9-482e-bf57-84241c87d12f",
 InitializationCell->True],
Cell[145480, 3235, 60557, 1193, 2966, "Input",ExpressionUUID->"2dfd0ff6-9fae-412c-9bf8-d3ccb98da28e",
 InitializationCell->True],
Cell[206040, 4430, 2174, 58, 208, "Input",ExpressionUUID->"adc51be3-de05-47e4-b9a4-a50f94ddf43f",
 InitializationCell->True],
Cell[208217, 4490, 2343, 36, 29, "Input",ExpressionUUID->"caf13509-62fb-46ba-b6c2-7494c4a365ad"],
Cell[210563, 4528, 33727, 701, 1781, "Input",ExpressionUUID->"df394b3c-5444-4bb6-abb3-568e72e18226",
 InitializationCell->True],
Cell[244293, 5231, 4508, 77, 49, "Input",ExpressionUUID->"0529e64a-d73d-4835-aaf7-70d33b7afeb2"],
Cell[248804, 5310, 3079, 54, 131, "Input",ExpressionUUID->"3ee8edee-c6e0-49c7-9a82-edd76ec0f113"],
Cell[251886, 5366, 3699, 64, 70, "Input",ExpressionUUID->"fdc81f97-91d3-47df-9f21-1f0cc3e9ece4"],
Cell[255588, 5432, 152, 3, 29, "Input",ExpressionUUID->"53610d96-3c55-428d-9240-507eee6c5f53"],
Cell[255743, 5437, 2024, 44, 111, "Input",ExpressionUUID->"dd5dc2eb-2e79-425c-a240-6f54db5c0098"],
Cell[257770, 5483, 152, 3, 29, "Input",ExpressionUUID->"30709cf9-60db-426a-9760-80c143dc167e"],
Cell[257925, 5488, 4420, 61, 49, "Input",ExpressionUUID->"bce85970-f156-4701-bc21-b624f82c2346"],
Cell[262348, 5551, 5899, 82, 29, "Input",ExpressionUUID->"e27e8c31-2334-4273-97ab-ceeed7027b5a"],
Cell[CellGroupData[{
Cell[268272, 5637, 13632, 240, 172, "Input",ExpressionUUID->"900518c4-b504-483c-8e78-ab7b677b257c"],
Cell[CellGroupData[{
Cell[281929, 5881, 209, 4, 23, "Print",ExpressionUUID->"a514dbb1-7173-485a-9149-372106295f4f"],
Cell[282141, 5887, 301, 8, 24, "Print",ExpressionUUID->"b64baf21-ba06-419d-8b58-5f601547113c"],
Cell[282445, 5897, 314, 8, 24, "Print",ExpressionUUID->"7dff84f4-f0ce-4aa9-91e5-7a214f2a8365"],
Cell[282762, 5907, 276, 7, 23, "Print",ExpressionUUID->"eb92e178-56bb-43ed-9aac-794a2c0c5acc"],
Cell[283041, 5916, 278, 8, 23, "Print",ExpressionUUID->"a4940237-1b4c-422a-b82a-d42c76110a58"]
}, Open  ]]
}, Open  ]],
Cell[283346, 5928, 544, 8, 49, "Input",ExpressionUUID->"1bde3372-e7ba-4981-b443-f1480cbb25a1"],
Cell[283893, 5938, 152, 3, 29, "Input",ExpressionUUID->"890056bf-d3a3-4916-958e-18e27ede2482"],
Cell[284048, 5943, 1117, 24, 29, "Input",ExpressionUUID->"789bd117-af42-474e-8576-65b2eccb0c2b"],
Cell[285168, 5969, 129, 3, 29, "Input",ExpressionUUID->"df5a2c58-6cb2-4d82-b6f0-485d06a7bfe7"]
}
]
*)

